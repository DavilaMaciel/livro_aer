<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 9 Análises Multidimensionais | Análises Ecológicas no R</title>
<meta name="author" content="Fernando Rodrigues da Silva, Thiago Gonçalves-Souza, Gustavo Brant Paterno,   Diogo Borges Provete, Maurício Humberto Vancine">
<meta name="description" content="Pré-requisitos do capítulo Pacotes e dados que serão utilizados neste capítulo. ## Pacotes library(ade4) library(ecodados) library(tidyverse) library(vegan) library(pvclust) library(BiodiversityR)...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="Capítulo 9 Análises Multidimensionais | Análises Ecológicas no R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://analises-ecologicas.netlify.app/cap9.html">
<meta property="og:image" content="https://analises-ecologicas.netlify.app/img/capa.jpeg">
<meta property="og:description" content="Pré-requisitos do capítulo Pacotes e dados que serão utilizados neste capítulo. ## Pacotes library(ade4) library(ecodados) library(tidyverse) library(vegan) library(pvclust) library(BiodiversityR)...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 9 Análises Multidimensionais | Análises Ecológicas no R">
<meta name="twitter:description" content="Pré-requisitos do capítulo Pacotes e dados que serão utilizados neste capítulo. ## Pacotes library(ade4) library(ecodados) library(tidyverse) library(vegan) library(pvclust) library(BiodiversityR)...">
<meta name="twitter:image" content="https://analises-ecologicas.netlify.app/img/capa.jpeg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-23BB46Y290"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-23BB46Y290');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Análises Ecológicas no R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Procurar" aria-label="Procurar">
</form>

      <nav aria-label="Sumário"><h2><b>Sumário</b></h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bem-vindos</a></li>
<li><a class="" href="pref%C3%A1cio.html">Prefácio</a></li>
<li><a class="" href="dedicat%C3%B3ria.html">Dedicatória</a></li>
<li><a class="" href="sobre-os-autores.html">Sobre os autores</a></li>
<li><a class="" href="revisores-e-colaboradores.html">Revisores e colaboradores</a></li>
<li><a class="" href="cap1.html"><span class="header-section-number">1</span> Introdução</a></li>
<li><a class="" href="cap2.html"><span class="header-section-number">2</span> Voltando ao básico: como dominar a arte de fazer perguntas cientificamente relevantes</a></li>
<li><a class="" href="cap3.html"><span class="header-section-number">3</span> Pré-requisitos</a></li>
<li><a class="" href="cap4.html"><span class="header-section-number">4</span> Introdução ao R</a></li>
<li><a class="" href="cap5.html"><span class="header-section-number">5</span> Tidyverse</a></li>
<li><a class="" href="cap6.html"><span class="header-section-number">6</span> Visualização de dados</a></li>
<li><a class="" href="cap7.html"><span class="header-section-number">7</span> Modelos lineares</a></li>
<li><a class="" href="cap8.html"><span class="header-section-number">8</span> Modelos Lineares Generalizados</a></li>
<li><a class="active" href="cap9.html"><span class="header-section-number">9</span> Análises Multidimensionais</a></li>
<li><a class="" href="cap10.html"><span class="header-section-number">10</span> Rarefação</a></li>
<li><a class="" href="cap11.html"><span class="header-section-number">11</span> Estimadores de riqueza</a></li>
<li><a class="" href="cap12.html"><span class="header-section-number">12</span> Diversidade Taxonômica</a></li>
<li><a class="" href="cap13.html"><span class="header-section-number">13</span> Diversidade Filogenética</a></li>
<li><a class="" href="cap14.html"><span class="header-section-number">14</span> Diversidade Funcional</a></li>
<li><a class="" href="cap15.html"><span class="header-section-number">15</span> Dados geoespaciais</a></li>
<li><a class="" href="gloss%C3%A1rio.html">Glossário</a></li>
<li><a class="" href="refer%C3%AAncias.html">Referências</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/paternogbc/livro_aer">Ver código fonte <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cap9" class="section level1" number="9">
<h1>
<span class="header-section-number">Capítulo 9</span> Análises Multidimensionais<a class="anchor" aria-label="anchor" href="#cap9"><i class="fas fa-link"></i></a>
</h1>
<div id="pré-requisitos-do-capítulo-5" class="section level2 unnumbered">
<h2>Pré-requisitos do capítulo<a class="anchor" aria-label="anchor" href="#pr%C3%A9-requisitos-do-cap%C3%ADtulo-5"><i class="fas fa-link"></i></a>
</h2>
<p>Pacotes e dados que serão utilizados neste capítulo.</p>
<div class="sourceCode" id="cb350"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Pacotes </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/">ade4</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ecodados</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan">vegan</a></span><span class="op">)</span> 
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://stat.sys.i.kyoto-u.ac.jp/prog/pvclust/">pvclust</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.worldagroforestry.org/output/tree-diversity-analysis">BiodiversityR</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ecology.msu.montana.edu/labdsv/R">labdsv</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">FD</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/">palmerpenguins</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dnychka/fieldsRPackage">fields</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/">ade4</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ggord</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pacificclimate/Rudunits2">udunits2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sdray/adespatial">adespatial</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/">spdep</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mvabund</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/reshape">reshape</a></span><span class="op">)</span>

<span class="co">## Dados</span>
<span class="va">sp_compos</span>        <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">bocaina</span>
<span class="va">species</span>          <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">com_birds</span>
<span class="va">env</span>              <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">env_birds</span>
<span class="va">xy</span>               <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">birds.xy</span>
<span class="va">bocaina.env</span>      <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">bocaina.env</span>
<span class="va">bocaina.xy</span>       <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">bocaina.xy</span>
<span class="va">anuros_permanova</span> <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">anuros_permanova</span>
<span class="va">macroinv</span>         <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">macroinv</span>
<span class="va">fish_comm</span>        <span class="op">&lt;-</span> <span class="fu">ecodados</span><span class="fu">::</span><span class="va">fish_comm</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mite.env</span><span class="op">)</span>

<span class="co">## Traduzir nomes para português </span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"especies"</span>, <span class="st">"ilha"</span>, <span class="st">"comprimento_bico"</span>, <span class="st">"profundidade_bico"</span>, <span class="st">"comprimento_nadadeira"</span>, <span class="st">"massa_corporal"</span>, <span class="st">"sexo"</span>, <span class="st">"ano"</span><span class="op">)</span></code></pre></div>
</div>
<div id="aspectos-teóricos" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Aspectos teóricos<a class="anchor" aria-label="anchor" href="#aspectos-te%C3%B3ricos"><i class="fas fa-link"></i></a>
</h2>
<p>Análises multivariadas avaliam hipóteses cuja variável resposta é definida por múltiplas variáveis ao mesmo tempo, comumente expressa na forma de uma matriz quadrada ou de distância (dissimilaridade).</p>
<p>Em geral, análises multivariadas têm três principais utilidades: i) reduzir a dimensionalidade dos dados e encontrar a principal direção de variação dos mesmos, ii) testar relações entre matrizes, ou ainda, iii) encontrar diferenças entre grupos. Análises multivariadas podem ser utilizadas como análises exploratórias e/ou para descrever padrões em estudos ecológicos. No entanto, mesmo quando se deseja apenas explorar o conjunto de dados para encontrar possíveis padrões, a necessidade de se ter hipóteses, ou ao menos expectativas <em>a priori</em>, não pode ser ignorada. Antes de entrar de cabeça nas análises multivariadas, também sugerimos fortemente o estudo de métodos de amostragem e como fazer boas perguntas (Capítulo <a href="cap2.html#cap2">2</a>).</p>
<p>Análises multivariadas podem ser divididas, grosseiramente, em dois tipos: agrupamento e ordenação. <strong>Análises de agrupamento</strong>, em geral, tentam agrupar objetos (observações) ou descritores em grupos de maneira que objetos do mesmo grupo sejam mais semelhantes entre si do que objetos de outros grupos <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. Por exemplo, os objetos podem ser localidades como “parcelas”, “riachos” ou “florestas”, enquanto os descritores são as diferentes variáveis coletadas para esses objetos (e.g., espécies, variáveis ambientais). <strong>A análise de ordenação</strong>, por sua vez, é uma operação pela qual os objetos (ou descritores) são posicionados num espaço que contém menos dimensões que o conjunto de dados original; a posição dos objetos ou descritores em relação aos outros também pode ser usada para agrupá-los.</p>
<div id="coeficientes-de-associação" class="section level3" number="9.1.1">
<h3>
<span class="header-section-number">9.1.1</span> Coeficientes de associação<a class="anchor" aria-label="anchor" href="#coeficientes-de-associa%C3%A7%C3%A3o"><i class="fas fa-link"></i></a>
</h3>
<p>Assim chamados genericamente, os coeficientes de associação medem o quão parecidos objetos ou descritores são entre si. Objetos estão nas linhas da matriz, enquanto descritores estão nas colunas. Geralmente objetos são as nossas unidades amostrais, enquanto os descritores são as variáveis. Quando analisamos a relação entre objetos fazemos uma análise no <strong>modo Q</strong>, ao passo que o <strong>modo R</strong> é quando analisamos a relação entre descritores. Coeficientes de associação do modo Q são medidas de (dis)similaridade ou distância, enquanto para o modo R utilizamos covariância ou correlação. Como já tratamos neste livro sobre covariância e correlação (ver Capítulo <a href="cap7.html#cap7">7</a>), neste tópico vamos falar sobre índices de distância e similaridade. Mas qual a definição destas duas quantidades?</p>
<ul>
<li>Similaridade são máximas (<em>S=1</em>) quando dois objetos são idênticos</li>
<li>Distâncias são o contrário da similaridade (<em>D=1-S</em>) e não têm limites superiores (dependem da unidade de medida)</li>
</ul>
<p>Existem ao menos 26 índices de similaridade que podem ser agrupados de acordo com o tipo de dado (qualitativos ou quantitativos) ou a maneira com que lidam com duplos zeros (simétricos ou assimétricos) <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. Do seu lado, as distâncias só se aplicam a dados quantitativos e têm como características serem métricas, semi-métricas ou não-métricas. Vejamos agora os principais índices de similaridade e distância de cada tipo.</p>
</div>
<div id="métricas-de-distância" class="section level3" number="9.1.2">
<h3>
<span class="header-section-number">9.1.2</span> Métricas de distância<a class="anchor" aria-label="anchor" href="#m%C3%A9tricas-de-dist%C3%A2ncia"><i class="fas fa-link"></i></a>
</h3>
<p>O principal coeficiente de distância usado em ecologia é a distância euclidiana. Além disso, temos ainda <em>Canberra</em> (variação da Distância Euclidiana), <em>Mahalanobis</em> (calcula a distância entre dois pontos num espaço não ortogonal, levando em consideração a covariância entre descritores), <em>Manhattan</em> (variação da Distância Euclidiana), <em>Chord</em> (elimina diferenças entre abundância total de espécies), 𝜒2 (dá peso maior para espécies raras) e <em>Hellinger</em> (não dá peso para espécies raras). Essas distâncias são recomendadas nos casos em que as variáveis de estudo forem contínuas, como por exemplo, <strong>variáveis morfométricas ou descritores ambientais</strong>.</p>
<p>Uma característica comum de conjuntos de dados ecológicos são os vários zeros encontrados em matrizes de composição. Eles surgem porque não encontramos nenhum indivíduo de uma determinada espécie num local, seja porque aquele local não tem as condições ambientais adequadas a ela, falha na detectabilidade, ou dinâmicas demográficas estocásticas de colonização-extinção <span class="citation">(<a href="refer%C3%AAncias.html#ref-blascomoreno2019" role="doc-biblioref">Blasco‐Moreno et al. 2019</a>)</span>. Logo, quando dois locais compartilham ausência de espécies, não é possível atribuir uma única razão da dupla ausência. Como essas medidas de distância apresentadas acima assumem que os dados são quantitativos e não de contagem, elas não são adequadas para lidar com dados de abundância ou incidência de espécies, porque atribuem um grau de parecença a pares de locais que compartilham zeros <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. Por esse motivo, precisamos de coeficientes que desconsiderem os duplos zeros. Eles são chamados de <em>assimétricos</em>.</p>
<p><strong>Coeficientes assimétricos binários para objetos</strong></p>
<p>Esses coeficientes (ou índices) são apropriados para dados de incidência de espécies (presença-ausência) e desconsideram as duplas ausências. Os índices deste tipo mais comuns utilizados em ecologia são <em>Jaccard</em>, <em>Sørensen</em> e <em>Ochiai</em>.</p>
<p>O coeficiente de <em>Jaccard</em> é dado por:</p>
<p><span class="math display">\[\beta_j = a/(a+b+c)\]</span>
onde</p>
<ul>
<li>
<em>a</em> = número de espécies compartilhadas</li>
<li>
<em>b</em> = número de espécies exclusivas da comunidade 1</li>
<li>
<em>c</em> = número de espécies exclusivas da comunidade 2</li>
</ul>
<p>A diferença entre os índices de <em>Jaccard</em> e <em>Sørensen</em> é que o índice de <em>Sørensen</em> dá peso dobrado para duplas presenças. Por conta dessas características, estes índices são adequados para quantificar diversidade beta <span class="citation">(<a href="refer%C3%AAncias.html#ref-anderson2010" role="doc-biblioref">M. J. Anderson et al. 2011</a>; <a href="refer%C3%AAncias.html#ref-legendre2013" role="doc-biblioref">Legendre and De Cáceres 2013</a>)</span>. Esses índices variam entre 0 (nenhuma espécie é compartilhada entre o par de locais) a 1 (todas as espécies são compartilhadas entre o par de locais).</p>
<p>O coeficiente de <em>Sørensen</em> é dado por:</p>
<p><span class="math display">\[\beta_s = 2a/(2a+b+c)\]</span>
onde</p>
<ul>
<li>
<em>a</em> = número de espécies compartilhadas</li>
<li>
<em>b</em> = número de espécies exclusivas da comunidade 1</li>
<li>
<em>c</em> = número de espécies exclusivas da comunidade 2</li>
</ul>
<p><strong>Coeficientes binários para descritores (R mode)</strong></p>
<p>Se o objetivo for calcular a similaridade entre descritores binários (e.g., presença ou ausência de características ambientais) de pares de locais, geralmente o coeficiente recomendado é o de Sokal &amp; Michener. Este índice está implementado na função <code><a href="https://rdrr.io/pkg/ade4/man/dist.binary.html">dist.binary()</a></code> do pacote <code>ade4</code>.</p>
<p><strong>Coeficientes quantitativos para objetos</strong></p>
<p>Estes são os coeficientes utilizados para dados de contagem (e.g., abundância) e quantitativos (e.g., frequência, biomassa, porcentagem de cobertura). Diferentemente das distâncias, estes coeficientes são assimétricos, ou seja, não consideram duplas ausências e, portanto, são adequados para analisar dados de composição de espécies. Além disso, uma outra característica deles é serem semi-métricos. Os índices mais comuns deste tipo são <em>Bray-Curtis</em> (conhecido como <em>percentage difference</em>, em inglês), <em>Chord</em>, <em>log-Chord</em>, <em>Hellinger</em>, chi-quadrado e <em>Morisita-Horn</em>.</p>
<p>Todos os índices discutidos até aqui estão implementados nas funções <code><a href="https://rdrr.io/pkg/ade4/man/dist.ktab.html">ade4::dist.ktab()</a></code>, <code><a href="https://rdrr.io/pkg/adespatial/man/dist.ldc.html">adespatial::dist.ldc()</a></code> e <code><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegan::vegdist()</a></code>.</p>
<p><strong>Coeficientes para descritores (R mode) que incluem mistura de tipos de dados</strong></p>
<p>É comum em análises de diversidade funcional que tenhamos um conjunto de atributos (<em>traits</em>) de espécies que são formados por vários tipos de dados: quantitativos (e.g., tamanho de corpo), binários (presença/ausência de uma dada característica), <em>fuzzy</em> (um atributo multiestado codificado em várias colunas), ordinais e circulares (e.g., distribuição de uma fenofase ao longo de um ano). O índice que lida com todos esses dados é o Gower. A versão estendida do índice de Gower pode ser encontrada na função <code>ade4::dist.ktab().</code></p>
<p>O capítulo 7 de Legendre &amp; Legendre <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">2012</a>)</span> fornece uma chave dicotômica para escolha do índice mais adequado.</p>
<p><strong>Padronizações e transformações</strong></p>
<p>É comum coletarmos múltiplas variáveis ambientais cujas unidades sejam diferentes. Por exemplo, temperatura (ºC), distância da margem (m), área (m<sup>2</sup>), etc. Para diminuir a taxa de Erro do Tipo I das análises (rejeitar a hipótese nula quando ela é verdadeira), é recomendado que <strong><em>padronizemos</em></strong> os dados utilizando distribuição <em>Z</em>, assim todas as variáveis passam a ter média 0 e desvio padrão 1. Essa operação garante que todas as variáveis tenham o mesmo peso nas análises que avaliam o padrão dos objetos considerando os múltiplos descritores. Essa padronização pode ser implementada na função <code><a href="https://rdrr.io/pkg/vegan/man/decostand.html">vegan::decostand()</a></code>.</p>
<p>Outro problema comum de matrizes de dados de composição de espécies é o alto número de zeros, enquanto outras espécies podem ter altas abundâncias. Isso gera problemas em ordenações. Para diminuir essa discrepância, podemos <strong>transformar</strong> os dados, por exemplo, utilizando a distância de <em>Hellinger</em> ou <em>Chord</em>. Para dados contínuos pode ser que transformação log ou raiz quadrada ajude quando há valores muito discrepantes (<em>leverages</em>) que podem influenciar em demasiado a relação entre objetos ou descritores. Isso pode ser feito na função <code><a href="https://rdrr.io/pkg/vegan/man/decostand.html">vegan::decostand()</a></code>.</p>
</div>
</div>
<div id="análises-de-agrupamento" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Análises de agrupamento<a class="anchor" aria-label="anchor" href="#an%C3%A1lises-de-agrupamento"><i class="fas fa-link"></i></a>
</h2>
<p>O objetivo da análise de agrupamento é agrupar objetos admitindo que haja um grau de similaridade entre eles. Esta análise pode ser utilizada ainda para classificar uma população em grupos homogêneos de acordo com uma característica de interesse. A grosso modo, uma análise de agrupamento tenta resumir uma grande quantidade de dados e apresentá-la de maneira fácil de visualizar e entender (em geral, na forma de um dendrograma). No entanto, os resultados da análise podem não refletir necessariamente toda a informação originalmente contida na matriz de dados. Para avaliar o quão bem uma análise de agrupamento representa os dados originais existe uma métrica — o coeficiente de correlação cofenético — o qual discutiremos em detalhes mais adiante.</p>
<p>Antes de considerar algum método de agrupamento, pense porque você esperaria que houvesse uma descontinuidade nos dados; ou ainda, considere se existe algum ganho prático em dividir uma nuvem de objetos contínuos em grupos. O padrão apresentado pelo dendrograma depende do protocolo utilizado (método de agrupamento e índice de dissimilaridade); os grupos formados dependem do nível de corte escolhido.</p>
<p>A matriz deve conter os objetos a serem agrupados (e.g., espécies) nas linhas e as variáveis (e.g., locais de coleta ou medidas morfológicas) nas colunas. A escolha do método de agrupamento é crítica para a escolha de um coeficiente de associação. É importante compreender as propriedades dos métodos de agrupamento para interpretar corretamente a estrutura ecológica que eles evidenciam <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. De acordo com a classificação de Sneath &amp; Sokal <span class="citation">(<a href="refer%C3%AAncias.html#ref-sneath_numerical_1973" role="doc-biblioref">1973</a>)</span>, existem cinco tipos de métodos: i) sequenciais ou simultâneos, ii) aglomerativo ou divisivo, iii) monotéticos ou politéticos, iv) hierárquico ou não hierárquicos e v) probabilístico. Sugerimos a leitura do livro citado anteriormente para aprofundar seus conhecimentos sobre os diferentes métodos.</p>
<div id="agrupamento-hierárquico" class="section level3" number="9.2.1">
<h3>
<span class="header-section-number">9.2.1</span> Agrupamento hierárquico<a class="anchor" aria-label="anchor" href="#agrupamento-hier%C3%A1rquico"><i class="fas fa-link"></i></a>
</h3>
<p>Métodos hierárquicos podem ser divididos naqueles que consideram o centroide ou a média aritmética entre os grupos. O principal método hierárquico que utiliza a média aritmética é o UPGMA (Agrupamento pelas médias aritméticas não ponderadas), e o principal método que utiliza centroides é a Distância mínima de Ward.</p>
<p>O UPGMA funciona da seguinte forma: a maior similaridade (ou menor distância) identifica os próximos agrupamentos a serem formados. Após esse evento, o método calcula a média aritmética das similaridades ou distâncias entre um objeto e cada um dos membros do grupo ou, no caso de um grupo previamente formado, entre todos os membros dos dois grupos. Todos os objetos recebem pesos iguais no cálculo.</p>
<p>O método de Ward é baseado no critério de quadrados mínimos (OLS), o mesmo utilizado para ajustar um modelo linear (Capítulo <a href="cap7.html#cap7">7</a>). O objetivo é definir os grupos de maneira que a soma de quadrados (i.e. similar ao erro quadrado da ANOVA) dentro dos grupos seja minimizada <span class="citation">(<a href="refer%C3%AAncias.html#ref-borcard2018" role="doc-biblioref">Borcard, Gillet, and Legendre 2018</a>)</span>.</p>
<p>No entanto, para interpretar os resultados precisamos antes definir um nível de corte, que vai nos dizer quantos grupos existem. Há vários métodos para definir grupos, desde os heurísticos aos que utilizam reamostragem (<em>bootstrap</em>). Se quisermos interpretar este dendrograma, podemos, por exemplo, estabelecer um nível de corte de 50% de distância (ou seja, grupos cujos objetos tenham ao menos 50% de similaridade entre si).</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Verifique se não há espaço nos nomes das colunas e linhas</p></li>
<li><p>Se os dados forem de abundância, recomenda-se realizar a transformação de <em>Hellinger</em> <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2001" role="doc-biblioref">Legendre and Gallagher 2001</a>)</span>. Esta transformação é necessária porque a matriz de comunidades (em especial, com a presença de muitas espécies raras) pode causar distorções nos métodos de ordenação baseados em distância Euclidiana <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2001" role="doc-biblioref">Legendre and Gallagher 2001</a>)</span></p></li>
<li><p>Se a matriz original contiver muitos valores discrepantes (e.g., uma espécie muito mais ou muito menos abundante que outras) é necessário transformar os dados usando <code><a href="https://rdrr.io/r/base/Log.html">log1p()</a></code>. No entanto, deve-se fazer ou a transformação de <em>Hellinger</em> ou logarítmica e nunca as duas ao mesmo tempo</p></li>
<li><p>Se as variáveis forem medidas tomadas em diferentes escalas (metros, graus celsius etc.), é necessário padronizar cada variável para ter a média 0 e desvio padrão 1. Isso pode ser feito utilizando a função <code><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand()</a></code> do pacote <code>vegan</code></p></li>
</ul>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo, vamos utilizar um conjunto de dados que contém girinos de espécies de anuros coletados em 14 poças com diferentes coberturas de dossel <span class="citation">(<a href="refer%C3%AAncias.html#ref-provete_broad-scale_2014" role="doc-biblioref">Provete et al. 2014</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Existem grupos de espécies de anfíbios anuros com padrões de ocorrência similar ao longo das poças?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Iremos encontrar ao menos dois grupos de espécies: aquelas que ocorrem em poças dentro de floresta (i.e., maior cobertura de dossel) <em>versus</em> aquelas que ocorrem em poças de áreas abertas (menor cobertura de dossel)</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variáveis preditoras: a matriz de dados contém a abundância das espécies nas linhas e locais (poças) nas colunas</li>
</ul>
<p><strong>Análises</strong></p>
<p>Para começar, vamos primeiro importar os dados e depois calcular a matriz de distância que seja adequada para o tipo de dado que temos (abundância de espécies - dados de contagem) (Figura <a href="cap9.html#fig:fig-dend">9.1</a>).</p>
<div class="sourceCode" id="cb351"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Composição de espécies (seis primeiras localidades)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sp_compos</span><span class="op">)</span>
<span class="co">#&gt;         BP4  PP4 PP3  AP1 AP2 PP1 PP2 BP9  PT1 PT2 PT3 BP2 PT5</span>
<span class="co">#&gt; Aper      0    3   0    0   2   0   0   0    0   0   0 181   0</span>
<span class="co">#&gt; Bahe    859   14  14    0  87 312 624 641    0   0   0  14   0</span>
<span class="co">#&gt; Rict   1772 1517 207  573 796   0   0   0    0   0   0   0   0</span>
<span class="co">#&gt; Cleuco    0    0   0    0   0   0   0   0    0  29 369   0  84</span>
<span class="co">#&gt; Dmic      0    0   6   60   4   0   0   0 2758 319  25   0 329</span>
<span class="co">#&gt; Dmin      0   84 344 1045  90   0   0   0    8   0   0   0   0</span>

<span class="co">## Matriz de similaridade com o coeficiente de Morisita-Horn</span>
<span class="va">distBocaina</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sp_compos</span>, method <span class="op">=</span> <span class="st">"horn"</span><span class="op">)</span>

<span class="co">## Agrupamento com a função hclust e o método UPGMA</span>
<span class="va">dendro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">distBocaina</span>, method <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span>

<span class="co">## Visualizar os resultados</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">dendro</span>, main <span class="op">=</span> <span class="st">"Dendrograma"</span>, 
     ylab <span class="op">=</span> <span class="st">"Similaridade (índice de Horn)"</span>,
     xlab<span class="op">=</span><span class="st">""</span>, sub<span class="op">=</span><span class="st">""</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-dend"></span>
<img src="livro_files/figure-html/fig-dend-1.png" alt="Dendrograma mostrando uma análise de agrupamento de anuros." width="100%" height="100%"><p class="caption">
Figura 9.1: Dendrograma mostrando uma análise de agrupamento de anuros.
</p>
</div>
<p><strong>Avaliando a qualidade do dendrograma</strong></p>
<p>Precisamos verificar se o agrupamento reduziu a dimensionalidade da matriz de forma eficiente, de maneira a não distorcer a informação. Fazemos isso calculando o <strong>Coeficiente de Correlação Cofenética</strong> que é uma medida que nos indica quão bem o resultado do agrupamento corresponde às (dis)similaridades originais.</p>
<div class="sourceCode" id="cb352"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Coeficiente de correlação cofenética</span>
<span class="va">cofresult</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cophenetic.html">cophenetic</a></span><span class="op">(</span><span class="va">dendro</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">cofresult</span>, <span class="va">distBocaina</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.9455221</span></code></pre></div>
<p>Um coeficiente de correlação cofenética &gt; .7 indica uma boa representação. Portanto, o nosso resultado de 0.9455221 é alto, garantindo que o dendrograma é adequado (Figura <a href="cap9.html#fig:fig-dend-group">9.2</a>). Note que testar a “significância” deste coeficiente não é adequado, já que seria algo tautológico (circular). Claro que definir o que seria um valor “alto” ou “baixo” da correlação é um pouco arbitrário, mas pode-se usar como “regra do polegar”.</p>
<div class="sourceCode" id="cb353"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gráfico</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">dendro</span>, main <span class="op">=</span> <span class="st">"Dendrograma"</span>, 
     ylab <span class="op">=</span> <span class="st">"Similaridade (índice de Horn)"</span>,
     xlab<span class="op">=</span><span class="st">""</span>, sub<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">4</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html">ncol</a></span><span class="op">(</span><span class="va">sp_compos</span><span class="op">)</span>
<span class="va">MidPoint</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">dendro</span><span class="op">$</span><span class="va">height</span><span class="op">[</span><span class="va">n</span><span class="op">-</span><span class="va">k</span><span class="op">]</span> <span class="op">+</span> <span class="va">dendro</span><span class="op">$</span><span class="va">height</span><span class="op">[</span><span class="va">n</span><span class="op">-</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">MidPoint</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-dend-group"></span>
<img src="livro_files/figure-html/fig-dend-group-1.png" alt="Dendrograma mostrando uma análise de agrupamento de anuros com uma linha de corte formando cinco grupos." width="100%" height="100%"><p class="caption">
Figura 9.2: Dendrograma mostrando uma análise de agrupamento de anuros com uma linha de corte formando cinco grupos.
</p>
</div>
<p>Nesse caso teremos a formação de cinco grupos, representados pelos nós que estão abaixo da linha de corte. Portanto, o resultado não suporta a nossa hipótese <em>a priori</em> que predizia a formação de apenas dois grupos de espécies.</p>
<p><strong>Exemplo 2</strong></p>
<p>No exemplo anterior, vimos que é difícil interpretar os grupos baseado num nível de corte. A seguir, vamos utilizar o pacote <code>pvclust</code> que calcula automaticamente o nível de corte de similaridade baseado no <em>Bootstrap</em> de cada nó. Uma desvantagem deste método é que ele somente aceita índices de similaridade da função <code><a href="https://rdrr.io/pkg/factoextra/man/dist.html">dist()</a></code>, que possui apenas a distância <em>Euclidiana</em>, <em>Manhattan</em> e <em>Canberra</em>. Uma maneira de contornarmos essa limitação é utilizar transformações dos dados disponíveis na função <code><a href="https://rdrr.io/pkg/BiodiversityR/man/disttransform.html">disttransform()</a></code> no pacote <code>BiodiversityR</code> ou a função <code><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand()</a></code> do pacote <code>vegan</code>. Também é possível utilizar a transformação de Box-Cox para dados multivariados, disponível no <a href="http://www.ecography.org/appendix/ecog-03498">material suplementar</a> de Legendre &amp; Borcard <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2018" role="doc-biblioref">2018</a>)</span>. Esta transformação é geralmente utilizada para tornar a distribuição dos dados mais simétrica (menos enviesada para valores extremos: reduzir o <em>skewness</em> dos dados).</p>
<p><strong>Análises</strong></p>
<p>Vamos utilizar o mesmo conjunto de dados do Exemplo 1 para responder à mesma pergunta. Aqui vamos utilizar a distância de <em>Chord</em> (que é indicada para dados de composição de espécies) para calcular a matriz de distância. Se transformarmos uma matriz usando a transformação <em>Chord</em> e depois calcularmos a distância Euclidiana, isso equivale à calcular diretamente a distância de <em>Chord</em> (Figura <a href="cap9.html#fig:fig-dend-boot-chor">9.3</a>).</p>
<div class="sourceCode" id="cb354"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="va">sp_compos</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;     Aper Bahe Rict Cleuco Dmic Dmin Hpoly Lfur Pbar Polf Pmelano Sduar Shay Sobt Ssqual Bokerm</span>
<span class="co">#&gt; BP4    0  859 1772      0    0    0    61    3  387    0       0     0    0    0      0      0</span>
<span class="co">#&gt; PP4    3   14 1517      0    0   84   275    0  187    0       0  1150    6    0      0      1</span>
<span class="co">#&gt; PP3    0   14  207      0    6  344   388    0    0    0       0   428    0    0      0      0</span>
<span class="co">#&gt; AP1    0    0  573      0   60 1045  1054    0    0    0       0   476   92   13      0      0</span>
<span class="co">#&gt; AP2    2   87  796      0    4   90  3002    0    0    2       0     7    0    5      0      0</span>
<span class="co">#&gt; PP1    0  312    0      0    0    0   329    0    0    0       0     0    0    0      0      0</span>

<span class="co">## Passo 1: transformar para distância de Chord</span>
<span class="va">bocaina_transf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiodiversityR/man/disttransform.html">disttransform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="va">sp_compos</span><span class="op">)</span>, <span class="st">"chord"</span><span class="op">)</span>

<span class="co">## Passo 2: realizar pvclust com método average e distância euclidiana</span>
<span class="va">analise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pvclust/man/pvclust.html">pvclust</a></span><span class="op">(</span><span class="va">bocaina_transf</span>, method.hclust <span class="op">=</span> <span class="st">"average"</span>, method.dist <span class="op">=</span> <span class="st">"euclidean"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 

<span class="co">## Passo 3: dendrograma</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">analise</span>, hang<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, main <span class="op">=</span> <span class="st">"Dendrograma com valores de P"</span>, 
     ylab <span class="op">=</span> <span class="st">"Distância Euclideana"</span>,
     xlab<span class="op">=</span><span class="st">""</span>, sub<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pvclust/man/pvpick.html">pvrect</a></span><span class="op">(</span><span class="va">analise</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-dend-boot-chor"></span>
<img src="livro_files/figure-html/fig-dend-boot-chor-1.png" alt="Dendrograma mostrando uma análise de agrupamento de anuros com uma linha de corte criada por bootstrap e usando distância de Chord." width="100%" height="100%"><p class="caption">
Figura 9.3: Dendrograma mostrando uma análise de agrupamento de anuros com uma linha de corte criada por bootstrap e usando distância de Chord.
</p>
</div>
<p>É possível notar que existe um único grupo com BS &gt; 95%. Agora vamos tentar usar a distância de <em>Hellinger</em>, que é recomendada (junto com a distância de <em>Chord</em>) para transformar dados de composição de espécies <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2001" role="doc-biblioref">Legendre and Gallagher 2001</a>)</span> (Figura <a href="cap9.html#fig:fig-dend-boot-hell">9.4</a>).</p>
<div class="sourceCode" id="cb355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Passo 1: transformar dados com Hellinger</span>
<span class="va">bocaina_transf2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiodiversityR/man/disttransform.html">disttransform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="va">bocaina</span><span class="op">)</span>, <span class="st">"hellinger"</span><span class="op">)</span>

<span class="co">## Passo 2: realizar pvclust com método average e distância euclidiana</span>
<span class="va">analise2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pvclust/man/pvclust.html">pvclust</a></span><span class="op">(</span><span class="va">bocaina_transf2</span>, method.hclust<span class="op">=</span><span class="st">"average"</span>, method.dist<span class="op">=</span><span class="st">"euclidean"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 

<span class="co">## Passo 3: dendrograma</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">analise2</span>, hang<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, main <span class="op">=</span> <span class="st">"Dendrograma com valores de P"</span>, 
     ylab <span class="op">=</span> <span class="st">"Distância Euclideana"</span>,
     xlab<span class="op">=</span><span class="st">""</span>, sub<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">4</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html">ncol</a></span><span class="op">(</span><span class="va">sp_compos</span><span class="op">)</span>
<span class="va">MidPoint</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">dendro</span><span class="op">$</span><span class="va">height</span><span class="op">[</span><span class="va">n</span><span class="op">-</span><span class="va">k</span><span class="op">]</span> <span class="op">+</span> <span class="va">dendro</span><span class="op">$</span><span class="va">height</span><span class="op">[</span><span class="va">n</span><span class="op">-</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">MidPoint</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/pvclust/man/pvpick.html">pvrect</a></span><span class="op">(</span><span class="va">analise2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-dend-boot-hell"></span>
<img src="livro_files/figure-html/fig-dend-boot-hell-1.png" alt="Dendrograma mostrando uma análise de agrupamento de anuros com uma linha de corte criada por bootstrap e usando distância de Hellinger." width="100%" height="100%"><p class="caption">
Figura 9.4: Dendrograma mostrando uma análise de agrupamento de anuros com uma linha de corte criada por bootstrap e usando distância de Hellinger.
</p>
</div>
<p><strong>Interpretação dos resultados</strong></p>
<p>Notem que se mudarmos o coeficiente de associação, o resultado também muda. Agora temos um grupo a mais, composto por <em>Dendropsophus minutus</em> e <em>Scinax duartei</em> que não apareciam antes. Isso se deve ao fato de que a distância de <em>Hellinger</em> dá menos peso para espécies raras do que a <em>Chord</em>.</p>
<p>Neste sentido, os dados não suportam a nossa hipótese inicial da formação de dois grupos, independentemente do coeficiente de associação utilizado e do cálculo automático do nível de corte baseado na reamostragem.</p>
</div>
<div id="agrupamento-não-hierárquico-k-means" class="section level3" number="9.2.2">
<h3>
<span class="header-section-number">9.2.2</span> Agrupamento não-hierárquico (<em>K-means</em>)<a class="anchor" aria-label="anchor" href="#agrupamento-n%C3%A3o-hier%C3%A1rquico-k-means"><i class="fas fa-link"></i></a>
</h3>
<p>Ao contrário do dendrograma, o <em>K-means</em> é um agrupamento não-hierárquico e, desse modo, não é otimizado para buscar grupos menores aninhados em grupos maiores. Resumidamente, podemos calcular o <em>K-means</em> a partir de uma matriz quadrada ou de distância. Essa técnica procura particionar os objetos em <em>k</em> grupos de maneira a minimizar a soma de quadrados entre grupos e maximizá-la dentro dos grupos. Um critério similar ao de uma ANOVA (Capítulo <a href="cap7.html#cap7">7</a>). Um diferencial do <em>K-means</em> em relação aos agrupamentos hierárquicos é que o usuário pode escolher antecipadamente o número de grupos que deseja formar.</p>
<p><strong>Exemplo 1</strong></p>
<p>Para este exemplo, iremos utilizar um conjunto de dados disponível no pacote <code>ade4</code> que contém dados de 27 espécies de peixes coletados em 30 pontos ao longo do Rio Doubs, na fronteira entre a França e Suíça.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Qual é o número de grupos que melhor sumariza o padrão de ocorrência de espécies de peixes ao longo de um riacho?</li>
</ul>
<div class="alert alert-info">
<p><strong> 📝 Importante </strong><br>
Neste caso, estamos realizando uma análise exploratória e não temos uma predição.</p>
</div>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variáveis resposta: composição de espécies de peixes</li>
</ul>
<p><strong>Checklist</strong></p>
<ul>
<li>Vamos normalizar os dados de abundância antes de entrar na análise propriamente, já que existem muitos zeros na matriz</li>
</ul>
<p><strong>Análises</strong></p>
<p>Vamos iniciar selecionando e padronizando os dados.</p>
<div class="sourceCode" id="cb356"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Mostrar somente seis primeiras espécies de seis localidades</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>
<span class="co">#&gt;   Cogo Satr Phph Neba Thth Teso</span>
<span class="co">#&gt; 1    0    3    0    0    0    0</span>
<span class="co">#&gt; 2    0    5    4    3    0    0</span>
<span class="co">#&gt; 3    0    5    5    5    0    0</span>
<span class="co">#&gt; 4    0    4    5    5    0    0</span>
<span class="co">#&gt; 5    0    2    3    2    0    0</span>
<span class="co">#&gt; 6    0    3    4    5    0    0</span>

<span class="co">## Verificar se existem localidades sem nenhuma ocorrência</span>
<span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">)</span>
<span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 </span>
<span class="co">#&gt;  3 12 16 21 34 21 16  0 14 14 11 18 19 28 33 40 44 42 46 56 62 72  4 15 11 43 63 70 87 89</span>

<span class="co">## Retirar a linha 8 (rio sem nenhuma ocorrência de peixe)</span>
<span class="va">spe</span> <span class="op">&lt;-</span> <span class="va">doubs</span><span class="op">$</span><span class="va">fish</span><span class="op">[</span><span class="op">-</span><span class="fl">8</span>,<span class="op">]</span>

<span class="co">## Função do pacote vegan para normalizar os dados</span>
<span class="va">spe.norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">spe</span>, method <span class="op">=</span> <span class="st">"normalize"</span><span class="op">)</span> </code></pre></div>
<p>O argumento <code>centers</code> na função <code><a href="https://rdrr.io/r/stats/kmeans.html">kmeans()</a></code> indica o número de grupos que se quer formar. Neste exemplo, estamos utilizando <code>centers = 4</code>.</p>
<div class="sourceCode" id="cb357"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## K-Means</span>
<span class="va">spe.kmeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">spe.norm</span>, centers <span class="op">=</span> <span class="fl">4</span>, nstart <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">spe.kmeans</span>
<span class="co">#&gt; K-means clustering with 4 clusters of sizes 8, 12, 6, 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cluster means:</span>
<span class="co">#&gt;         Cogo        Satr       Phph       Neba        Thth        Teso       Chna       Chto       Lele      Lece       Baba</span>
<span class="co">#&gt; 1 0.00000000 0.006691097 0.02506109 0.06987391 0.006691097 0.006691097 0.10687104 0.09377516 0.14194394 0.2011411 0.24327992</span>
<span class="co">#&gt; 2 0.10380209 0.542300691 0.50086515 0.43325916 0.114024105 0.075651573 0.00000000 0.00000000 0.06983991 0.1237394 0.02385019</span>
<span class="co">#&gt; 3 0.06167791 0.122088022 0.26993915 0.35942538 0.032664966 0.135403325 0.06212775 0.21568957 0.25887226 0.2722562 0.15647062</span>
<span class="co">#&gt; 4 0.00000000 0.000000000 0.00000000 0.00000000 0.000000000 0.000000000 0.05205792 0.00000000 0.07647191 0.3166705 0.00000000</span>
<span class="co">#&gt;        Spbi       Gogo       Eslu       Pefl      Rham       Legi       Scer       Cyca       Titi       Abbr      Icme       Acce</span>
<span class="co">#&gt; 1 0.1326062 0.28386032 0.20630360 0.16920496 0.2214275 0.19066542 0.13171275 0.16019126 0.26230024 0.19561641 0.1331835 0.26713081</span>
<span class="co">#&gt; 2 0.0000000 0.05670453 0.04722294 0.02949244 0.0000000 0.00000000 0.00000000 0.00000000 0.03833408 0.00000000 0.0000000 0.00000000</span>
<span class="co">#&gt; 3 0.1574388 0.16822286 0.12276089 0.17261621 0.0793181 0.06190283 0.04516042 0.06190283 0.14539027 0.01473139 0.0000000 0.03192175</span>
<span class="co">#&gt; 4 0.0000000 0.20500174 0.07647191 0.00000000 0.0000000 0.05205792 0.07647191 0.00000000 0.00000000 0.00000000 0.0000000 0.18058775</span>
<span class="co">#&gt;         Ruru       Blbj      Alal       Anan</span>
<span class="co">#&gt; 1 0.32103755 0.22883055 0.3326939 0.18873077</span>
<span class="co">#&gt; 2 0.01049901 0.00000000 0.0000000 0.00000000</span>
<span class="co">#&gt; 3 0.32201597 0.01473139 0.1095241 0.04739636</span>
<span class="co">#&gt; 4 0.31667052 0.05205792 0.7618709 0.00000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Clustering vector:</span>
<span class="co">#&gt;  1  2  3  4  5  6  7  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 </span>
<span class="co">#&gt;  2  2  2  2  3  2  2  3  2  2  2  2  2  2  3  3  3  3  1  1  1  4  4  4  1  1  1  1  1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Within cluster sum of squares by cluster:</span>
<span class="co">#&gt; [1] 0.4696535 2.5101386 1.7361453 0.3560423</span>
<span class="co">#&gt;  (between_SS / total_SS =  66.7 %)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Available components:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss" "betweenss"    "size"         "iter"        </span>
<span class="co">#&gt; [9] "ifault"</span></code></pre></div>
<p>O objeto que fornece o resultado contém: i) o tamanho (número de objetos) em cada um dos 4 grupos, ii) o centroide de cada grupo e o pertencimento de cada espécie a cada grupo, e iii) o quanto da Soma de Quadrados dos dados é explicada por esta conformação de grupos.</p>
<p>No entanto, não é possível saber <em>a priori</em> qual o número “ideal” de grupos. Para descobrir isso, repetimos o <em>k-means</em> com uma série de valores de <strong>K</strong>. Isso pode ser feito na função <code><a href="https://rdrr.io/pkg/vegan/man/cascadeKM.html">cascadeKM()</a></code>.</p>
<div class="sourceCode" id="cb358"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Repetindo o K-Means</span>
<span class="va">spe.KM.cascade</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/cascadeKM.html">cascadeKM</a></span><span class="op">(</span><span class="va">spe.norm</span>, inf.gr <span class="op">=</span> <span class="fl">2</span>, sup.gr <span class="op">=</span> <span class="fl">10</span>, iter <span class="op">=</span> <span class="fl">100</span>, criterion <span class="op">=</span> <span class="st">"ssi"</span><span class="op">)</span> </code></pre></div>
<p>Tanto <strong>calinski</strong> quando <strong>ssi</strong> são bons critérios para encontrar o número ideal de grupos. Quanto maior o valor de <strong>ssi</strong>, melhor (veja <code>?cascadeKM()</code> mais detalhes). Os valores de ssi é o critério utilizado pelo algoritimo para achar o agrupamento ótimo dos objetos (Figura <a href="cap9.html#fig:fig-kmeans">9.5</a>).</p>
<div class="sourceCode" id="cb359"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Resumo dos resultados</span>
<span class="va">spe.KM.cascade</span><span class="op">$</span><span class="va">results</span>
<span class="co">#&gt;      2 groups  3 groups  4 groups  5 groups   6 groups  7 groups  8 groups  9 groups 10 groups</span>
<span class="co">#&gt; SSE 8.2149405 6.4768108 5.0719796 4.3015573 3.58561200 2.9523667 2.4840549 2.0521888 1.7599292</span>
<span class="co">#&gt; ssi 0.1312111 0.1685126 0.1409061 0.1299662 0.08693436 0.1481826 0.1267918 0.1134307 0.1226392</span>

<span class="co">## Gráfico</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">spe.KM.cascade</span>, sortg <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-kmeans"></span>
<img src="livro_files/figure-html/fig-kmeans-1.png" alt="Gráficos mostrando os resultados da análise de K-Means." width="100%" height="100%"><p class="caption">
Figura 9.5: Gráficos mostrando os resultados da análise de K-Means.
</p>
</div>
<p><strong>Interpretação dos resultados</strong></p>
<p>Diferentemente da nossa predição inicial, o resultado da análise mostra que o número ideal de grupos para explicar a variância no padrão de ocorrência de espécies é 3. Notem que o SSI máximo é alcançado neste número de grupos 0.1685126 (também indicado pela bola vermelha no plot).</p>
</div>
<div id="espécies-indicadoras" class="section level3" number="9.2.3">
<h3>
<span class="header-section-number">9.2.3</span> Espécies indicadoras<a class="anchor" aria-label="anchor" href="#esp%C3%A9cies-indicadoras"><i class="fas fa-link"></i></a>
</h3>
<p>Uma pergunta normalmente feita por ecólogos é: qual espécie pode ser indicadora de uma determinada condição ambiental (e.g., poluição)?</p>
<p>O índice IndVal mede dois aspectos das espécies: fidelidade e especificidade. Uma alta fidelidade significa que espécies ocorrem em todos os locais do grupo, e uma alta especificidade significa que as espécies ocorrem somente naquele grupo. Uma boa espécie indicadora é aquela na qual todos os indivíduos ocorrem em todas as amostras referentes a um grupo específico. A especificidade é dada pela divisão da abundância média da espécie no grupo pela somatória das abundâncias médias dos grupos. Fidelidade é igual ao número de lugares no grupo onde a espécie está presente dividido pelo número total de lugares do grupo <span class="citation">(<a href="refer%C3%AAncias.html#ref-dufrene_species_1997" role="doc-biblioref">Dufrêne and Legendre 1997</a>)</span>.</p>
<p>Espécies raras podem receber o mesmo valor de IndVal das espécies indicadoras, porém são chamadas de indicadoras assimétricas, uma vez que contribuem com a especificidade do habitat, mas não servem para predizer grupos. Ao contrário, as espécies indicadoras são verdadeiros indicadores simétricos e podem ser usadas para predizer grupos.</p>
<p>A análise procede da seguinte forma:</p>
<ol style="list-style-type: decimal">
<li><p>Uma matriz de distância é construída e as unidades amostrais são classificadas com alguma análise de agrupamento, hierárquico ou não</p></li>
<li><p>A variável ambiental para a qual se deseja classificar os grupos é inserida</p></li>
<li><p>As espécies indicadoras de cada grupo são formadas através do cálculo da especificidade e fidelidade, obtendo-se o valor de IndVal para cada espécie</p></li>
<li><p>Por fim, o conjunto de dados originais é comparado para ver se a análise faz sentido</p></li>
</ol>
<p>O cálculo da significância do índice de IndVal é feito por aleatorização de Monte Carlo. Os métodos de Monte Carlo utilizam números aleatórios de dados reais para simular certos padrões esperados na ausência de um processo ecológico específico <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. Assim, o valor do índice é aleatorizado 999 vezes (ou o número de vezes que você optar) dentro dos tratamentos e o valor de <em>P</em> é dado pelo número de vezes em que o índice observado foi igual ou maior que os valores aleatorizados. Portanto, o IndVal fornece um conjunto de espécies que são indicadoras de um grupo de locais (e.g., muito poluídos), que por sua vez precisam ser definidos utilizando alguma técnica de agrupamento, como as que vimos anteriormente.</p>
<p><strong>Exemplo 1</strong></p>
<p>Para este exemplo, vamos usar o mesmo conjunto de dados utilizado acima com abundância de 16 espécies de girinos coletados em 14 poças com diferentes graus de cobertura de dossel na Serra da Bocaina <span class="citation">(<a href="refer%C3%AAncias.html#ref-provete_broad-scale_2014" role="doc-biblioref">Provete et al. 2014</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Podemos utilizar as espécies de girinos como indicadoras da fitofisionomia?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Espécies terrestres serão indicadoras de área aberta, enquanto espécies arborícolas serão indicadoras de áreas florestais</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variáveis resposta: mesma matriz já utilizada contendo a abundância de girinos ao longo de poças na Serra da Bocaina</li>
</ul>
<p><strong>Análises</strong></p>
<p>O IndVal está disponível tanto no pacote <code>indicspecies</code>, quando no <code>labdsv</code>. Para este exemplo, iremos usar o <code>labdsv</code>. Primeiro, vamos agrupar as unidades amostrais (poças) que informa os grupos de fitofisionomias onde as poças se localizam e para os quais deseja-se encontrar espécies indicadoras.</p>
<div class="sourceCode" id="cb360"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bocaina</span><span class="op">)</span>
<span class="co">#&gt;         BP4  PP4 PP3  AP1 AP2 PP1 PP2 BP9  PT1 PT2 PT3 BP2 PT5</span>
<span class="co">#&gt; Aper      0    3   0    0   2   0   0   0    0   0   0 181   0</span>
<span class="co">#&gt; Bahe    859   14  14    0  87 312 624 641    0   0   0  14   0</span>
<span class="co">#&gt; Rict   1772 1517 207  573 796   0   0   0    0   0   0   0   0</span>
<span class="co">#&gt; Cleuco    0    0   0    0   0   0   0   0    0  29 369   0  84</span>
<span class="co">#&gt; Dmic      0    0   6   60   4   0   0   0 2758 319  25   0 329</span>
<span class="co">#&gt; Dmin      0   84 344 1045  90   0   0   0    8   0   0   0   0</span>
<span class="va">fitofis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Análise de espécies indicadoras</span>
<span class="va">res_indval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/labdsv/man/indval.html">indval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="va">sp_compos</span><span class="op">)</span>, <span class="va">fitofis</span><span class="op">)</span>

<span class="co"># A função summary só exibe o resultado para as espécies indicadoras</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res_indval</span><span class="op">)</span>
<span class="co">#&gt;       cluster indicator_value probability</span>
<span class="co">#&gt; Rict        1          0.8364       0.011</span>
<span class="co">#&gt; Sduar       1          0.7475       0.034</span>
<span class="co">#&gt; Bahe        2          0.6487       0.048</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sum of probabilities                 =  7.984 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sum of Indicator Values              =  7.3 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sum of Significant Indicator Values  =  2.23 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of Significant Indicators     =  3 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Significant Indicator Distribution</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; 1 2 </span>
<span class="co">#&gt; 2 1</span></code></pre></div>
<p>Para apresentar uma tabela dos resultados para todas as espécies temos de processar os dados.</p>
<div class="sourceCode" id="cb361"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Resultados</span>
<span class="va">tab_indval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span><span class="op">(</span>maxcls <span class="op">=</span> <span class="va">res_indval</span><span class="op">$</span><span class="va">maxcls</span>,
                               ind.value <span class="op">=</span> <span class="va">res_indval</span><span class="op">$</span><span class="va">indcls</span>,
                               P <span class="op">=</span> <span class="va">res_indval</span><span class="op">$</span><span class="va">pval</span><span class="op">)</span>
<span class="va">tab_indval</span>
<span class="co">#&gt;         maxcls ind.value     P</span>
<span class="co">#&gt; Aper         3 0.2432796 1.000</span>
<span class="co">#&gt; Bahe         2 0.6487329 0.048</span>
<span class="co">#&gt; Rict         1 0.8363823 0.011</span>
<span class="co">#&gt; Cleuco       3 0.4128631 0.385</span>
<span class="co">#&gt; Dmic         3 0.6645244 0.195</span>
<span class="co">#&gt; Dmin         1 0.7032145 0.101</span>
<span class="co">#&gt; Hpoly        2 0.6208711 0.259</span>
<span class="co">#&gt; Lfur         3 0.2279412 1.000</span>
<span class="co">#&gt; Pbar         1 0.2813725 0.624</span>
<span class="co">#&gt; Polf         3 0.2437500 1.000</span>
<span class="co">#&gt; Pmelano      2 0.2500000 1.000</span>
<span class="co">#&gt; Sduar        1 0.7474527 0.034</span>
<span class="co">#&gt; Shay         3 0.4930269 0.416</span>
<span class="co">#&gt; Sobt         2 0.2222222 0.683</span>
<span class="co">#&gt; Ssqual       3 0.2500000 1.000</span>
<span class="co">#&gt; Bokerm       2 0.4583333 0.228</span>

<span class="co">## Espécies</span>
<span class="va">tab_indval</span><span class="op">[</span><span class="va">tab_indval</span><span class="op">$</span><span class="va">P</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="op">]</span>
<span class="co">#&gt;       maxcls ind.value     P</span>
<span class="co">#&gt; Bahe       2 0.6487329 0.048</span>
<span class="co">#&gt; Rict       1 0.8363823 0.011</span>
<span class="co">#&gt; Sduar      1 0.7474527 0.034</span></code></pre></div>
<p><strong>Interpretação dos resultados</strong></p>
<p>No resultado apresentado, podemos ver que temos duas espécies indicadoras da fitofisionimia 1: <em>Rhinella icterica</em> (Rict) e <em>Scinax duartei</em> (Sduar). Nenhuma espécie foi indicadora dos outros grupos neste exemplo.</p>
</div>
</div>
<div id="análises-de-ordenação" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Análises de Ordenação<a class="anchor" aria-label="anchor" href="#an%C3%A1lises-de-ordena%C3%A7%C3%A3o"><i class="fas fa-link"></i></a>
</h2>
<p>As análises de ordenação representam um conjunto de métodos e técnicas multivariadas que organizam objetos (e.g., localidades, indivíduos) em alguma ordem considerando o conjunto de descritores que podem estar mais ou menos relacionados entre si. Se os descritores estiverem bem relacionados, eles são redundantes e organizam os objetos de forma similar. Esse fenômeno é observado, por exemplo, quando queremos organizar um conjunto de unidades amostrais baseado em variáveis que indicam um mesmo processo: ver o padrão de similaridade geral de lagos usando várias variáveis relacionadas com a produtividade do sistema: clorofila-a, concentração de fósforo, nitrogênio, entre outros. Por exemplo, tais métodos permitem identificar se existem grupo de espécies que ocorrem exclusivamente em um determinado hábitat. Ao buscar esta <em>ordem</em>, as técnicas de ordenação possuem três principais utilidades: i) reduzir a dimensionalidade e revelar padrões, ii) separar as variáveis mais e menos importantes em combinações complexas e iii) separar relações mais e menos fortes ao comparar variáveis preditoras e dependentes.</p>
<p>Em geral, os métodos são divididos em ordenações irrestritas (ou análise de gradiente indireto) e restritas (ou análise de gradiente direto). <strong>As ordenações irrestritas</strong> organizam os objetos (e.g., espécies) de acordo com sua estrutura de covariância (ou correlação), o que demonstra que a proximidade (ou distância) dentro do espaço multidimensional representa semelhança (ou diferença) dos objetos. Por outro lado, <strong>as ordenações restritras</strong> posicionam os objetos (e.g., espécies) de acordo com sua relação linear com outras variáveis coletadas nas mesmas unidades amostrais (e.g., temperatura e precipitação). Ao passo que as ordenações irrestritas dependem somente de uma matriz (e.g., espécies por localidades), as ordenações restritas utilizam no mínimo duas matrizes (e.g., espécies por localidades e variáveis climáticas por localidade). Desse modo, fica claro esta diferença entre os dados utilizados que as análises irrestritas são mais exploratórias, enquanto análises restritas são ideais para testar hipóteses com dados multidimensionais. A tabela a seguir apresenta as principais análises utilizadas em ecologia.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="16%">
<col width="71%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th>Método</th>
<th>Tipo de variável</th>
<th>Função R</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Ordenação irrestrita</strong></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>PCA</td>
<td>Variáveis contínuas (distância euclidiana)</td>
<td>
<code><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA()</a></code>, <code><a href="https://rdrr.io/pkg/vegan/man/cca.html">rda()</a></code>, <code><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca()</a></code>
</td>
</tr>
<tr class="odd">
<td>PCoA</td>
<td>Aceita qualquer tipo de variável, mas depende da escolha apropriada de uma medida de distância</td>
<td>
<code><a href="https://rdrr.io/pkg/ape/man/pcoa.html">pcoa()</a></code>, <code><a href="https://rdrr.io/pkg/ade4/man/dudi.pco.html">dudi.pco()</a></code>
</td>
</tr>
<tr class="even">
<td>nMDS</td>
<td>Aceita qualquer tipo de variável, mas depende da escolha apropriada de uma medida de distância</td>
<td>
<code><a href="https://rdrr.io/pkg/vegan/man/metaMDS.html">metaMDS()</a></code>, <code><a href="https://rdrr.io/pkg/labdsv/man/nmds.html">nmds()</a></code>
</td>
</tr>
<tr class="odd">
<td>CA</td>
<td></td>
<td><code><a href="https://rdrr.io/pkg/ade4/man/dudi.coa.html">dudi.coa()</a></code></td>
</tr>
<tr class="even">
<td>Hill-Smith</td>
<td>Aceita qualquer tipo de variável</td>
<td><code><a href="https://rdrr.io/pkg/ade4/man/dudi.hillsmith.html">dudi.hillsmith()</a></code></td>
</tr>
<tr class="odd">
<td><strong>Ordenação restrita</strong></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>RDA</td>
<td>Variáveis preditoras de qualquer tipo e variáveis dependentes contínuas (ou presença e ausência)</td>
<td><code><a href="https://rdrr.io/pkg/vegan/man/cca.html">rda()</a></code></td>
</tr>
<tr class="odd">
<td>RDA parcial</td>
<td>Variáveis preditoras de qualquer tipo e variáveis dependentes contínuas (ou presença e ausência)</td>
<td><code><a href="https://rdrr.io/pkg/vegan/man/cca.html">rda()</a></code></td>
</tr>
<tr class="even">
<td>dbRDA</td>
<td>Variáveis preditoras de qualquer tipo e matriz de distância obtida a partir das variáveis dependentes</td>
<td>
<code><a href="https://rdrr.io/pkg/vegan/man/capscale.html">capscale()</a></code>, <code><a href="https://rdrr.io/pkg/vegan/man/capscale.html">dbrda()</a></code>
</td>
</tr>
<tr class="odd">
<td>CCA</td>
<td>Variáveis preditoras de qualquer tipo e variáveis dependentes contínuas (ou presença e ausência)</td>
<td><code><a href="https://rdrr.io/pkg/vegan/man/cca.html">rda()</a></code></td>
</tr>
<tr class="even">
<td>PERMANOVA</td>
<td>Variáveis preditoras de qualquer tipo e matriz de distância obtida a partir das variáveis dependentes</td>
<td>
<code><a href="https://rdrr.io/pkg/vegan/man/vegan-deprecated.html">adonis()</a></code>, <code><a href="https://rdrr.io/pkg/vegan/man/adonis.html">adonis2()</a></code>
</td>
</tr>
<tr class="odd">
<td>PCR</td>
<td>Variável dependente necessariamente representada por escores da PCA ou PCoA e variáveis preditoras de qualquer tipo</td>
<td>
<code><a href="https://rdrr.io/pkg/labdsv/man/pca.html">pca()</a></code>, <code><a href="https://rdrr.io/pkg/ape/man/pcoa.html">pcoa()</a></code>, <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>, <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code>
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="ordenação-irrestrita" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Ordenação irrestrita<a class="anchor" aria-label="anchor" href="#ordena%C3%A7%C3%A3o-irrestrita"><i class="fas fa-link"></i></a>
</h2>
<p>Ordenações irrestritas, ou análise de gradiente indireto ou ainda análises de fator, são um conjunto de métodos multivariados que lidam com uma única matriz quadrada. Esta matriz pode ou não ter pesos nas linhas ou colunas. Geralmente, o objetivo deste tipo de análise é resumir a informação contida na matriz de maneira gráfica, por meio de um diagrama de ordenação. Quanto maior e mais complexa for a matriz, mais eficiente é este tipo de análise. Os tipos de análise irão diferir de acordo com o tipo de dado contido nesta matriz, se contínuo ou contagem, etc. De maneira geral, essas ordenações irrestritas calculam combinações lineares, cuja formulação irá diferir ligeiramente entre os métodos. Da mesma forma, essas combinações lineares irão preservar um tipo de distância. Por exemplo, a Análise de Componentes Principais preserva a distância Euclidiana, enquanto a Análise de Correspondência preserva a distância de chi-quadrado.</p>
<div id="análise-de-componentes-principais-pca" class="section level3" number="9.4.1">
<h3>
<span class="header-section-number">9.4.1</span> Análise de Componentes Principais (PCA)<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-de-componentes-principais-pca"><i class="fas fa-link"></i></a>
</h3>
<p>A Análise de Componentes Principais (<em>Principal Component Analysis</em> - PCA) é uma das ordenações mais utilizadas em diversas áreas do conhecimento. Em Ecologia, ela se popularizou por facilitar a visualização de dados complexos como de distribuição de espécies em diferentes localidades e de potenciais variáveis explicativas. Ao mesmo tempo que ganhou tamanha popularidade, a PCA tem sido empregada de maneira incorreta, uma vez que muitos estudos utilizam a visualização gráfica da ordenação (o <em>biplot</em>) para interpretar “relações” entre variáveis preditoras (ambientais) e dependentes (espécies). Porém, como informado anteriormente, as ordenações irrestritas utilizam a estrutura de covariância dos objetos para organizar suas relações de similaridade.</p>
<p>Antes de explicar a análise, imagine que vamos usar uma matriz com cinco espécies de aranhas que foram encontradas em oito cidades diferentes. A quantidade de indivíduos de cada espécie coletada em cada cidade será o valor de preenchimento desta matriz. Sendo assim, a matriz possui oito objetos (cidades, representando unidades amostrais) e cinco descritores (espécies).</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:tab-pca-dados">Tabela 9.1: </span>Matriz com cinco espécies de aranhas que foram encontradas em oito cidades diferentes.
</caption>
<thead><tr>
<th style="text-align:center;">
Cidade
</th>
<th style="text-align:center;">
Espécie.1
</th>
<th style="text-align:center;">
Espécie.2
</th>
<th style="text-align:center;">
Espécie.3
</th>
<th style="text-align:center;">
Espécie.4
</th>
<th style="text-align:center;">
Espécie.5
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
Cidade 1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 2
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 3
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 4
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 5
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 6
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
6
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 7
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
9
</td>
</tr>
<tr>
<td style="text-align:center;">
Cidade 8
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
12
</td>
</tr>
</tbody>
</table></div>
<p>O primeiro passo da PCA é obter uma matriz centralizada, onde cada valor é subtraído da média da coluna que aquele valor pertence. Esta centralização pode ser calculada com a função <code><a href="https://rdrr.io/pkg/raster/man/scale.html">scale()</a></code>.</p>
<div class="sourceCode" id="cb362"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="va">aranhas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    sp1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
    sp2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
    sp3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">9</span>, <span class="fl">12</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,
    sp4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">10</span>, <span class="fl">8</span>, <span class="fl">0</span><span class="op">)</span>,
    sp5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">12</span><span class="op">)</span>,
    row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"cidade"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Centralização</span>
<span class="va">aranha.cent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">aranhas</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>O segundo passo é calcular uma matriz de covariância (ou matriz de dispersão) e, a partir desta matriz, obter os autovalores e autovetores. <strong>Os autovalores</strong> representam a porcentagem de explicação de cada eixo e podem ser calculados dividindo a soma do autovalor de cada eixo pela soma de todos os autovalores. No exemplo que apresentamos, os dois primeiros eixos representam 47,20% e 35,01% de toda variação, respectivamente. <strong>Os autovetores</strong>, por sua vez, representam os valores que multiplicam as variáveis originais e, desse modo, indicam a direção desses valores. Por fim, os componentes principais (Matriz F) são obtidos multiplicando os autovetores com os valores da matriz centralizada.</p>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Matriz de covaiância</span>
<span class="va">matriz_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">aranha.cent</span><span class="op">)</span>

<span class="co">## Autovalores e autovetores</span>
<span class="va">eigen_aranhas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">matriz_cov</span><span class="op">)</span>
<span class="va">autovalores</span> <span class="op">&lt;-</span> <span class="va">eigen_aranhas</span><span class="op">$</span><span class="va">values</span>
<span class="va">autovetores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">eigen_aranhas</span><span class="op">$</span><span class="va">vectors</span><span class="op">)</span>
<span class="va">autovalores</span> <span class="co"># eigenvalue</span>
<span class="co">#&gt; [1] 36.733031 27.243824  9.443805  2.962749  1.438020</span>

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">autovetores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"PC"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">autovetores</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">aranhas</span><span class="op">)</span>
<span class="va">autovetores</span>
<span class="co">#&gt;            PC1         PC2         PC3         PC4        PC5</span>
<span class="co">#&gt; sp1 -0.2144766 -0.38855265 -0.29239380 -0.02330706  0.8467522</span>
<span class="co">#&gt; sp2 -0.2442026 -0.17463316 -0.01756743  0.94587037 -0.1220204</span>
<span class="co">#&gt; sp3 -0.3558368  0.80222917  0.27591770  0.10991178  0.3762942</span>
<span class="co">#&gt; sp4  0.4159852  0.41786654 -0.78820962  0.17374202  0.0297183</span>
<span class="co">#&gt; sp5  0.7711688 -0.01860152  0.46560957  0.25003826  0.3544591</span>

<span class="co">## Componentes principais</span>
<span class="va">matriz_F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">aranha.cent</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">autovetores</span><span class="op">)</span><span class="op">)</span>
<span class="va">matriz_F</span>
<span class="co">#&gt;               PC1        PC2        PC3        PC4        PC5</span>
<span class="co">#&gt; cidade1 -2.979363 -4.4720575 -1.1533417 -3.2641923  0.5433206</span>
<span class="co">#&gt; cidade2 -4.873532 -6.2969618 -1.8435339  2.3644158  1.5047024</span>
<span class="co">#&gt; cidade3 -3.068541 -3.8302991 -0.3288626 -0.3566600 -2.3629973</span>
<span class="co">#&gt; cidade4 -6.086322  3.9922356  2.7216169  1.6250305 -0.7918743</span>
<span class="co">#&gt; cidade5 -4.513082  8.7689219  0.4668012 -1.1337476  0.9439633</span>
<span class="co">#&gt; cidade6  5.812374  3.9444494 -3.9520584  0.4197281 -0.1376205</span>
<span class="co">#&gt; cidade7  8.361421  0.6462243 -1.8065636  0.4926235 -0.2625625</span>
<span class="co">#&gt; cidade8  7.347046 -2.7525126  5.8959421 -0.1471979  0.5630683</span>

<span class="co">## Porcentagem de explicação de cada eixo</span>
<span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">autovalores</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">autovalores</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 47.201691 35.008126 12.135225  3.807112  1.847846</span></code></pre></div>
<p>Agora, é possível visualizar a relação entre as cidades e similaridade nas espécies de aranhas que vivem em cada uma delas (Figura <a href="cap9.html#fig:fig-pca">9.6</a>).</p>
<div class="sourceCode" id="cb364"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gráfico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">matriz_F</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PC1</span>, y <span class="op">=</span> <span class="va">PC2</span>, label <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">matriz_F</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pca"></span>
<img src="livro_files/figure-html/fig-pca-1.png" alt="Biplot da PCA ordenando as cidades pela composição das espécies de aranhas." width="100%" height="100%"><p class="caption">
Figura 9.6: Biplot da PCA ordenando as cidades pela composição das espécies de aranhas.
</p>
</div>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Verifique se todas as variáveis utilizadas são contínuas. Caso contrário, considere utilizar PCoA (veja mais no próximo tópico)</p></li>
<li><p>Apesar do exemplo acima ter apresentado a ocorrência de espécies de aranhas em diferentes cidades, é fundamental saber que utilizar a PCA com esses dados pode ser problemático. Assim, tenha cuidado em usar dados de composição de espécies, especialmente abundância, com PCA, uma vez que ‘duplos zeros’ podem gerar distorções na ordenação <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. Como alternativa, é possível utilizar PCA com dados padronizados com o método de Hellinger <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2001" role="doc-biblioref">Legendre and Gallagher 2001</a>)</span>.</p></li>
</ul>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo vamos utilizar um conjunto de dados morfológicos de pinguins do arquipélago Palmer (Península Antártica) disponíveis no pacote <code>palmerpenguins</code>. Os dados representam medidas do comprimento e largura do bico (mm), comprimento da nadadeira (mm) e massa corporal (gramas) de três espécies: Adélie, Chinstrap e Gentoo. Como descrito acima, a PCA deve ser utilizada para exploração de dados ou para testes <em>a posteriori</em> (e.g., Regressão de Componentes Principais - PCR, tópico explorado mais a frente nesse capítulo). Neste exemplo, iremos usar a estrutura de perguntas e predições para manter a proposta do livro.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Existe diferenças nas características morfológicas das espécies de pinguins do arquipélago Palmer?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Pinguins com dieta diferente possuem diferentes características morfológicas</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Preditora: espécie (categórica com três níveis)</li>
<li>Dependentes: variáveis morfológicas (contínua)</li>
</ul>
<p><strong>Análises</strong></p>
<p>Antes de começar, é necessário remover dados ausentes (se houver) e editar nomes das variáveis (ponto importante para determinar como devem aparecer no gráfico).</p>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Verificar se existem NAs nos dados</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 19</span>

<span class="co">## Remover dados ausentes (NA), quando houver</span>
<span class="va">penguins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span>

<span class="co">## Manter somentes dados contínuos que pretende aplicar a PCA</span>
<span class="va">penguins_trait</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></code></pre></div>
<p>Agora sim, os dados estão prontos para fazer a PCA. Um argumento é essencial na análise, o <code>scale.unit</code>. Se você utilizar dentro deste argumento a seleção <code>TRUE</code>, a função padroniza automaticamente as variáveis para terem a média 0 e variância 1. Esta padronização é essencial quando as variáveis estão em escalas muito diferentes. No exemplo selecionado, temos variáveis como comprimento do bico (em milímetros) e massa corporal (em gramas).</p>
<div class="sourceCode" id="cb366"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Compare com este código a variância das variáveis</span>
<span class="va">penguins_trait</span> <span class="op"><a href="https://ggobi.github.io/ggally/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, 
                            <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 × 4</span>
<span class="co">#&gt;   comprimento_bico profundidade_bico comprimento_nadadeira massa_corporal</span>
<span class="co">#&gt;              &lt;dbl&gt;             &lt;dbl&gt;                 &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt; 1             29.9              3.88                  196.        648372.</span>

<span class="co">## Agora, veja o mesmo cálculo se fizer a padronização (scale.unit da função PCA)</span>
<span class="va">penguins_pad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">penguins_trait</span>, method <span class="op">=</span> <span class="st">"standardize"</span><span class="op">)</span>
<span class="va">penguins_pad</span> <span class="op"><a href="https://ggobi.github.io/ggally/reference/pipe.html">%&gt;%</a></span> 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, 
                            <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   comprimento_bico profundidade_bico comprimento_nadadeira massa_corporal</span>
<span class="co">#&gt; 1                1                 1                     1              1</span>

<span class="co">## PCA</span>
<span class="va">pca.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">penguins_trait</span>, scale.unit <span class="op">=</span> <span class="cn">TRUE</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Apesar da simplicidade do código para executar a PCA, o objeto resultante da análise possui diversas informações que são essenciais para sua plena interpretação. Dentre elas, se destacam os autovalores, escores e cargas (<em>loadings</em>). Os autovalores representam a porcentagem de explicação de cada eixo. Os escores representam as coordenadas (posições no espaço multidimensional) representando os objetos (geralmente localidades ou indivíduos) e descritores (geralmente espécies ou variáveis ambientais e espaciais). Os <em>loadings</em>, por sua vez, representam a combinação linear entre os escores (nova posição do valor do descritor no espaço ordenado) e os valores originais dos descritores (Figura <a href="cap9.html#fig:fig-pca-scree">9.7</a>).</p>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Autovalores: porcentagem de explicação para usar no gráfico</span>
<span class="va">pca.p</span><span class="op">$</span><span class="va">eig</span> 
<span class="co">#&gt;        eigenvalue percentage of variance cumulative percentage of variance</span>
<span class="co">#&gt; comp 1  2.7453557              68.633893                          68.63389</span>
<span class="co">#&gt; comp 2  0.7781172              19.452929                          88.08682</span>
<span class="co">#&gt; comp 3  0.3686425               9.216063                          97.30289</span>
<span class="co">#&gt; comp 4  0.1078846               2.697115                         100.00000</span>

<span class="co">## Visualização da porcentagem de explicação de cada eixo</span>
<span class="co"># nota: é necessário ficar atento ao valor máximo do eixo 1 da análise para determinar o valor do ylim (neste caso, colocamos que o eixo varia de 0 a 70).</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eigenvalue.html">fviz_screeplot</a></span><span class="op">(</span><span class="va">pca.p</span>, addlabels <span class="op">=</span> <span class="cn">TRUE</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">70</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, 
               xlab <span class="op">=</span> <span class="st">"Dimensões"</span>,
               ylab <span class="op">=</span> <span class="st">"Porcentagem de variância explicada"</span><span class="op">)</span> 
<span class="co">## Outros valores importantes</span>
<span class="va">var_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_var</a></span><span class="op">(</span><span class="va">pca.p</span><span class="op">)</span>

<span class="co">## Escores (posição) das variáveis em cada eixo</span>
<span class="va">var_env</span><span class="op">$</span><span class="va">coord</span> 
<span class="co">#&gt;                            Dim.1      Dim.2      Dim.3       Dim.4</span>
<span class="co">#&gt; comprimento_bico       0.7518288 0.52943763 -0.3900969 -0.04768208</span>
<span class="co">#&gt; profundidade_bico     -0.6611860 0.70230869  0.2585287  0.05252186</span>
<span class="co">#&gt; comprimento_nadadeira  0.9557480 0.00510580  0.1433474  0.25684871</span>
<span class="co">#&gt; massa_corporal         0.9107624 0.06744932  0.3592789 -0.19204478</span>

<span class="co">## Contribuição (%) das variáveis para cada eixo</span>
<span class="va">var_env</span><span class="op">$</span><span class="va">contrib</span> 
<span class="co">#&gt;                          Dim.1        Dim.2     Dim.3     Dim.4</span>
<span class="co">#&gt; comprimento_bico      20.58919 36.023392267 41.279994  2.107420</span>
<span class="co">#&gt; profundidade_bico     15.92387 63.388588337 18.130600  2.556942</span>
<span class="co">#&gt; comprimento_nadadeira 33.27271  0.003350291  5.574092 61.149849</span>
<span class="co">#&gt; massa_corporal        30.21423  0.584669105 35.015313 34.185789</span>

<span class="co">## Loadings - correlação das variáveis com os eixos</span>
<span class="va">var_env</span><span class="op">$</span><span class="va">cor</span> 
<span class="co">#&gt;                            Dim.1      Dim.2      Dim.3       Dim.4</span>
<span class="co">#&gt; comprimento_bico       0.7518288 0.52943763 -0.3900969 -0.04768208</span>
<span class="co">#&gt; profundidade_bico     -0.6611860 0.70230869  0.2585287  0.05252186</span>
<span class="co">#&gt; comprimento_nadadeira  0.9557480 0.00510580  0.1433474  0.25684871</span>
<span class="co">#&gt; massa_corporal         0.9107624 0.06744932  0.3592789 -0.19204478</span>

<span class="co">## Qualidade da representação da variável. Esse valor é obtido multiplicado var_env$coord por var_env$coord</span>
<span class="va">var_env</span><span class="op">$</span><span class="va">cos2</span>
<span class="co">#&gt;                           Dim.1        Dim.2      Dim.3       Dim.4</span>
<span class="co">#&gt; comprimento_bico      0.5652466 2.803042e-01 0.15217561 0.002273581</span>
<span class="co">#&gt; profundidade_bico     0.4371669 4.932375e-01 0.06683710 0.002758546</span>
<span class="co">#&gt; comprimento_nadadeira 0.9134542 2.606919e-05 0.02054847 0.065971260</span>
<span class="co">#&gt; massa_corporal        0.8294881 4.549411e-03 0.12908133 0.036881196</span>

<span class="co">## Escores (posição) das localidades ("site scores") em cada eixo </span>
<span class="va">ind_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_ind</a></span><span class="op">(</span><span class="va">pca.p</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pca-scree"></span>
<img src="livro_files/figure-html/fig-pca-scree-1.png" alt="Scree plot mostrando a porcentagem de contribuição de cada eixo para a ordenação dos dados de penguins." width="100%" height="100%"><p class="caption">
Figura 9.7: Scree plot mostrando a porcentagem de contribuição de cada eixo para a ordenação dos dados de penguins.
</p>
</div>
<p>O pacote <code>FactoMineR</code> criou uma função (<code><a href="https://rdrr.io/pkg/FactoMineR/man/dimdesc.html">dimdesc()</a></code>) que seleciona as melhores variáveis (aquelas mais explicativas) para cada eixo através de uma análise fatorial. No exemplo com pinguins, o primeiro eixo (objeto <code>pca.p$eig</code>) explica ~69% da variação morfológica. A função <code><a href="https://rdrr.io/pkg/FactoMineR/man/dimdesc.html">dimdesc()</a></code> mostra que as quatro variáveis morfológicas estão fortemente associadas com o eixo 1. Porém, enquanto comprimento da nadadeira, massa corporal e comprimento do bico estão positivamente associados com o eixo 1 (correlação positiva), a largura do bico tem relação negativa. O eixo 2, por sua vez, explica ~20% da variação, sendo relacionado somente com largura e comprimento do bico.</p>
<div class="sourceCode" id="cb368"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Variáveis mais importantes para o Eixo 1</span>
<span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/dimdesc.html">dimdesc</a></span><span class="op">(</span><span class="va">pca.p</span><span class="op">)</span><span class="op">$</span><span class="va">Dim.1</span> 
<span class="co">#&gt; $quanti</span>
<span class="co">#&gt;                       correlation       p.value</span>
<span class="co">#&gt; comprimento_nadadeira   0.9557480 5.962756e-178</span>
<span class="co">#&gt; massa_corporal          0.9107624 3.447018e-129</span>
<span class="co">#&gt; comprimento_bico        0.7518288  7.830597e-62</span>
<span class="co">#&gt; profundidade_bico      -0.6611860  3.217695e-43</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "condes" "list"</span>

<span class="co">## Variáveis mais importantes para o Eixo 2</span>
<span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/dimdesc.html">dimdesc</a></span><span class="op">(</span><span class="va">pca.p</span><span class="op">)</span><span class="op">$</span><span class="va">Dim.2</span> 
<span class="co">#&gt; $quanti</span>
<span class="co">#&gt;                   correlation      p.value</span>
<span class="co">#&gt; profundidade_bico   0.7023087 8.689230e-51</span>
<span class="co">#&gt; comprimento_bico    0.5294376 1.873918e-25</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "condes" "list"</span></code></pre></div>
<p>Agora podemos utilizar o famoso <strong>biplot</strong> para representar a comparação morfológica dos pinguins dentro e entre espécies (Figura <a href="cap9.html#fig:fig-pca-biplot">9.8</a>).</p>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_biplot</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">pca.p</span>, 
                geom.ind <span class="op">=</span> <span class="st">"point"</span>, 
                fill.ind <span class="op">=</span> <span class="va">penguins</span><span class="op">$</span><span class="va">especies</span>, 
                col.ind <span class="op">=</span> <span class="st">"black"</span>,
                alpha.ind <span class="op">=</span> <span class="fl">0.7</span>,
                pointshape <span class="op">=</span> <span class="fl">21</span>, 
                pointsize <span class="op">=</span> <span class="fl">4</span>,
                palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"darkorchid"</span>, <span class="st">"cyan4"</span><span class="op">)</span>,
                col.var <span class="op">=</span> <span class="st">"black"</span>,
                invisible <span class="op">=</span> <span class="st">"quali"</span>,
                title <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"PC1 (68.63%)"</span>, y <span class="op">=</span> <span class="st">"PC2 (19.45%)"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pca-biplot"></span>
<img src="livro_files/figure-html/fig-pca-biplot-1.png" alt="Biplot da PCA ordenando os dados morfológicos de penguins." width="100%" height="100%"><p class="caption">
Figura 9.8: Biplot da PCA ordenando os dados morfológicos de penguins.
</p>
</div>
</div>
<div id="análises-de-coordenadas-principais-pcoa" class="section level3" number="9.4.2">
<h3>
<span class="header-section-number">9.4.2</span> Análises de Coordenadas Principais (PCoA)<a class="anchor" aria-label="anchor" href="#an%C3%A1lises-de-coordenadas-principais-pcoa"><i class="fas fa-link"></i></a>
</h3>
<p>Diferentemente da PCA, a Análises de Coordenadas Principais (<em>Principal Coordinate Analysis</em> - PCoA) é uma análise de ordenação irrestrita que aceita dados de diferentes tipos, como contínuos, categóricos, ordinais, binários, entre outros. Assim, a PCoA é aplicada para casos em que a distância euclidiana não é aplicada (como na PCA). Desse modo, o primeiro passo da análise é calcular uma matriz de similaridade ou de distância (discutido acima). Depois, os passos para obter autovalores e autovetores são bastante parecidos com a PCA. Da mesma forma, os eixos da PCoA e os valores ou posições dos objetos nesses eixos representam a relação de semelhança (ou diferença) baseada nos descritores desses objetos. A diferença, neste caso, é que a PCoA representa um espaço não-euclidiano, que irá ser afetado pela escolha do método de similaridade.</p>
<p>As utilizações mais comuns da PCoA são a ordenação: i) da matriz de composição de espécies usando a distância apropriada (<em>Jaccard</em>, <em>Sorensen</em>, <em>Bray-Curtis</em>), ii) da matriz de variáveis ambientais com mistos (contínuos, categóricos, circulares, etc.), e iii) da matriz filogenética, método PVR <span class="citation">(<a href="refer%C3%AAncias.html#ref-diniz-filho_eigenvector_1998" role="doc-biblioref">Diniz-Filho, de Sant’Ana, and Bini 1998</a>)</span>. Abaixo, exemplificamos a ordenação da matriz de composição de espécies.</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Compare as dimensões das matrizes utilizadas para a PCoA. Com bastante frequência, a tentativa de combinar dados categóricos (algum descritor dos objetos) com os valores obtidos com a PCoA gera erros para plotar a figura ou para executar a análise. Verifique, então, se as linhas são as mesmas (nome das localidades ou indivíduos e quantidade)</p></li>
<li><p>É fundamental conhecer o tipo de dados que está usando para selecionar a medida de distância apropriada. Essa escolha vai afetar a qualidade da ordenação e sua habilidade para interpretar a relação de semelhança entre os objetos comparados</p></li>
<li><p>Diferente da PCA, a PCoA aceita dados ausentes se a medida de distância escolhida também não tiver esta limitação. Por exemplo, a distância de Gower produz matrizes de similaridade mesmo com dados ausentes em determinados objetos</p></li>
<li><p>Em alguns casos, autovalores negativos são produzidos na ordenação com PCoA. Veja as principais causas desses valores em Legendre &amp; Legendre <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">2012</a>)</span>. Apesar deste problema, os autovalores mais importantes (eixos iniciais) não são afetados e, deste modo, a qualidade da representação dos objetos no espaço multidimensional não é afetada. Alguns autores sugerem utilizar correções métodos de correção, como Lingoes ou Cailliez <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>.</p></li>
</ul>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo, vamos utilizar a composição de ácaros Oribatidae em 70 manchas de musgo coletados por Borcard et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-borcard_partialling_1992" role="doc-biblioref">1992</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>A composição de espécies de ácaros muda entre diferentes topografias?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Iremos encontrar ao menos dois grupos de espécies: aquelas que ocorrem em poças dentro de floresta <em>versus</em> aquelas que ocorrem em poças de áreas abertas</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Preditora: topografia (categórica com dois níveis)</li>
<li>Dependentes: composição de espécies de ácaro</li>
</ul>
<p><strong>Análises</strong></p>
<p>Vamos primeiramente padronizar dos dados, calcular uma matriz de distância com método <em>Bray-Curtis</em> e depois calcular a PCoA.</p>
<div class="sourceCode" id="cb370"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Padronização dos dados com Hellinger</span>
<span class="va">mite.hel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mite</span>, method <span class="op">=</span> <span class="st">"hellinger"</span><span class="op">)</span> 

<span class="co">## Cálculo da matriz de distância com método Bray-Curtis</span>
<span class="va">sps.dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mite.hel</span>, method <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span> 

<span class="co">## PCoA</span>
<span class="va">pcoa.sps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/pcoa.html">pcoa</a></span><span class="op">(</span>D <span class="op">=</span> <span class="va">sps.dis</span>, correction <span class="op">=</span> <span class="st">"cailliez"</span><span class="op">)</span></code></pre></div>
<p>Assim como na PCA, a porcentagem de explicação dos eixos é uma das informações mais importantes pois descrevem a efetividade da redução da dimensionalidade dos dados.</p>
<div class="sourceCode" id="cb371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Porcentagem de explicação do Eixo 1</span>
<span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">pcoa.sps</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">pcoa.sps</span><span class="op">$</span><span class="va">trace</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [1] 49.10564</span>

<span class="co">## Porcentagem de explicação dos Eixo 2</span>
<span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">pcoa.sps</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">pcoa.sps</span><span class="op">$</span><span class="va">trace</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
<span class="co">#&gt; [1] 14.30308</span>

<span class="co">## Porcentagem de explicação acumulada dos dois primeiros eixos </span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">pcoa.sps</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">pcoa.sps</span><span class="op">$</span><span class="va">trace</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] 63.40872</span>

<span class="co">## Selecionar os dois primeiros eixos</span>
<span class="va">eixos</span> <span class="op">&lt;-</span> <span class="va">pcoa.sps</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>

<span class="co">## Juntar com algum dado categórico de interesse para fazer a figura</span>
<span class="va">pcoa.dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>topografia <span class="op">=</span> <span class="va">mite.env</span><span class="op">$</span><span class="va">Topo</span>, <span class="va">eixos</span><span class="op">)</span></code></pre></div>
<p>Para visualizar os resultados da PCoA, vamos exportar os escores dos eixos para usar no pacote <code>ggplot2</code> (Figura <a href="cap9.html#fig:fig-pcoa-biplot">9.9</a>).</p>
<div class="sourceCode" id="cb372"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Escores dos dois primeiros eixos</span>
<span class="va">eixos</span> <span class="op">&lt;-</span> <span class="va">pcoa.sps</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> 

<span class="co">## Combinar dados dos escores com um dado categórico de interesse para nossa pergunta</span>
<span class="va">pcoa.dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>topografia <span class="op">=</span> <span class="va">mite.env</span><span class="op">$</span><span class="va">Topo</span>, <span class="va">eixos</span><span class="op">)</span>

<span class="co">### Gráfico biplot da PCoA</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pcoa.dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Axis.1</span>, y <span class="op">=</span> <span class="va">Axis.2</span>, fill <span class="op">=</span> <span class="va">topografia</span>, 
                     color <span class="op">=</span> <span class="va">topografia</span>, shape <span class="op">=</span> <span class="va">topografia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">22</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"cyan4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"PCO 1 (49.11%)"</span>, y <span class="op">=</span> <span class="st">"PCO 2 (14.30%)"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pcoa-biplot"></span>
<img src="livro_files/figure-html/fig-pcoa-biplot-1.png" alt="Biplot da PCoA ordenando as espécies de ácaros entre diferentes topografias." width="100%" height="100%"><p class="caption">
Figura 9.9: Biplot da PCoA ordenando as espécies de ácaros entre diferentes topografias.
</p>
</div>
<p><strong>Limitações importantes das ordenações irrestritas</strong></p>
<p>Com frequência, pesquisadores utilizam análises como PCA e PCoA para “testar” diferenças na composição de espécies entre determinados fatores relevantes (altitude, clima, etc.). Porém, como falado acima, as análises de ordenação irrestritas não são utilizadas para testar qualquer hipótese. Ao invés disso, essas análises representam uma poderosa ferramente para explorar padrões em variáveis dependentes ou independentes para ajudar na interpretação ou mesmo para testar hipóteses em análises combinadas com as ordenações restritas.</p>
</div>
<div id="regressão-de-componentes-principais-pcr" class="section level3" number="9.4.3">
<h3>
<span class="header-section-number">9.4.3</span> Regressão de Componentes Principais (PCR)<a class="anchor" aria-label="anchor" href="#regress%C3%A3o-de-componentes-principais-pcr"><i class="fas fa-link"></i></a>
</h3>
<p>Uma maneira de testar hipóteses utilizando ordenações irrestritas é utilizando os resultados da ordenação (escores) como variáveis preditoras ou dependentes como, por exemplo, em modelos lineares (e.g., regressão múltipla Capítulo <a href="cap7.html#cap7">7</a>). O primeiro passo é utilizar uma ordenação, como a PCA, para gerar os “novos” dados que serão usados na análise. A utilização desses novos dados (que representam as coordenadas principais ou escores da PCA) vai depender da pergunta em questão. Por exemplo, pode ser que esses valores representem gradientes climáticos e, por este motivo, serão utilizados como variáveis preditoras em um modelo linear (e.g., regressão múltipla). Por outro lado, esses valores podem representar o espaço morfológicos de espécies de peixes e, como consequência, serão utilizados como variáveis dependentes para entender o efeito da presença de predador sobre a morfologia. É importante ressaltar que existem algumas limitações importantes na PCR como, por exemplo, as coordenadas principais (escores da PCA) utilizadas como variáveis preditoras podem não representar, biologicamente, as mais importantes para explicar a variação na variável resposta <span class="citation">(<a href="refer%C3%AAncias.html#ref-hadi_cautionary_1998" role="doc-biblioref">Hadi and Ling 1998</a>)</span>.</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Compare as dimensões das matrizes utilizadas para a PCR. Com bastante frequência, a tentativa de combinar dados categóricos (algum descritor dos objetos) com os valores obtidos com a PCoA gera erros para plotar a figura ou para executar a análise. Verifique, então, se as linhas são as mesmas (nome das localidades ou indivíduos e quantidade)</p></li>
<li><p>Estudos recentes têm criticado a utilização de PCR para testar hipóteses ecológicas pelo fato dos escores não representarem, necessariamente, a variação total das variáveis originais, bem como a relação entre a variável preditora e a dependente</p></li>
</ul>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo, vamos utilizar a composição de espécies de aves em 23 regiões dos alpes franceses. Os dados ambientais (env) representam variáveis climáticas (temperatura e chuva) e altitude.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Gradientes climáticos afetam a riqueza de aves?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>O aumento da umidade e redução da temperatura aumentam o número de espécies de aves</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Preditora: temperatura e chuva (contínuas) e altitude (categórica com três níveis)</li>
<li>Dependentes: riqueza de espécies de aves</li>
</ul>
<div class="sourceCode" id="cb373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="va">env_cont</span> <span class="op">&lt;-</span> <span class="va">env</span><span class="op">[</span>,<span class="op">-</span><span class="fl">8</span><span class="op">]</span>
<span class="va">env.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span><span class="va">env_cont</span>, scale.unit <span class="op">=</span> <span class="cn">TRUE</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">var_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_var</a></span><span class="op">(</span><span class="va">env.pca</span><span class="op">)</span> 

<span class="co">## Contribuição (%) das variáveis para cada eixo</span>
<span class="va">var_env</span><span class="op">$</span><span class="va">contrib</span> 
<span class="co">#&gt;             Dim.1      Dim.2      Dim.3      Dim.4       Dim.5</span>
<span class="co">#&gt; mini.jan 10.93489 22.2975487 16.1607726  7.6025527  0.01782438</span>
<span class="co">#&gt; maxi.jan 20.18065  3.2890767  2.1814486  4.2756350 41.05646526</span>
<span class="co">#&gt; mini.jul 11.87396 21.1379132  0.3428843  0.7750666 44.70209396</span>
<span class="co">#&gt; maxi.jul 18.47244  0.9159957 56.5369988  9.4368661  2.59283074</span>
<span class="co">#&gt; rain.jan  9.95206 21.5387403  6.5737927 53.7375738  4.44283706</span>
<span class="co">#&gt; rain.jul 16.14997 11.2368132  7.2608047 19.6972097  0.71454880</span>
<span class="co">#&gt; rain.tot 12.43603 19.5839121 10.9432983  4.4750959  6.47339980</span>

<span class="co">## Loadings - correlação das variáveis com os eixos</span>
<span class="va">var_env</span><span class="op">$</span><span class="va">cor</span> 
<span class="co">#&gt;               Dim.1     Dim.2       Dim.3       Dim.4        Dim.5</span>
<span class="co">#&gt; mini.jan  0.6830371 0.6766524 -0.21924927  0.12298817 -0.004517369</span>
<span class="co">#&gt; maxi.jan  0.9279073 0.2598807 -0.08055260  0.09223249  0.216804944</span>
<span class="co">#&gt; mini.jul  0.7117620 0.6588220  0.03193603 -0.03926930 -0.226225907</span>
<span class="co">#&gt; maxi.jul  0.8877675 0.1371462  0.41008461 -0.13702428  0.054483561</span>
<span class="co">#&gt; rain.jan -0.6516187 0.6650391 -0.13983474 -0.32698110  0.071319550</span>
<span class="co">#&gt; rain.jul -0.8300858 0.4803509  0.14696011  0.19796389 -0.028601865</span>
<span class="co">#&gt; rain.tot -0.7284135 0.6341424  0.18041856  0.09435932  0.086088397</span>
<span class="va">ind_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_ind</a></span><span class="op">(</span><span class="va">env.pca</span><span class="op">)</span>
<span class="va">env.pca</span><span class="op">$</span><span class="va">eig</span> 
<span class="co">#&gt;        eigenvalue percentage of variance cumulative percentage of variance</span>
<span class="co">#&gt; comp 1 4.26652359             60.9503370                          60.95034</span>
<span class="co">#&gt; comp 2 2.05340251             29.3343216                          90.28466</span>
<span class="co">#&gt; comp 3 0.29745014              4.2492878                          94.53395</span>
<span class="co">#&gt; comp 4 0.19896067              2.8422953                          97.37624</span>
<span class="co">#&gt; comp 5 0.11448717              1.6355310                          99.01177</span>
<span class="co">#&gt; comp 6 0.04312874              0.6161248                          99.62790</span>
<span class="co">#&gt; comp 7 0.02604718              0.3721025                         100.00000</span></code></pre></div>
<p>O objeto <code>env.pca$eig</code> demonstra que os três primeiros eixos explicam 94.54% da variação total dos dados climáticos. O intuito da PCR é reduzir a dimensionalidade, ou seja, o número de variáveis preditoras ou dependentes para facilitar a interpretação e garantir que as variáveis não sejam correlacionadas. O próximo passo então é obter os valores dos escores que representam os valores convertidos para serem usados em uma determinada análise, como a regressão múltipla.</p>
<div class="sourceCode" id="cb374"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Passo 1: obter os primeiros eixos </span>
<span class="va">pred.env</span> <span class="op">&lt;-</span> <span class="va">ind_env</span><span class="op">$</span><span class="va">coord</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> 

<span class="co">## Passo 2: calcular a riqueza de espécies</span>
<span class="va">riqueza</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/diversity.html">specnumber</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span>

<span class="co">## Passo 3: combinar os dois valores em um único data.frame</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">pred.env</span>, <span class="va">riqueza</span><span class="op">)</span> </code></pre></div>
<p>Agora que os dados foram combinados em uma única data frame, podemos utilizar os códigos apresentados no Capítulo <a href="cap7.html#cap7">7</a> para testar nossa hipótese (Figura <a href="cap9.html#fig:fig-pcr-aves-diag">9.10</a>).</p>
<div class="sourceCode" id="cb375"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Regressão múltipla</span>
<span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">riqueza</span> <span class="op">~</span> <span class="va">Dim.1</span> <span class="op">+</span> <span class="va">Dim.2</span> <span class="op">+</span> <span class="va">Dim.3</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> <span class="co"># verificar pressupostos dos modelos lineares</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> <span class="co"># resultados do  teste</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = riqueza ~ Dim.1 + Dim.2 + Dim.3, data = dat)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -3.4008 -1.1729  0.4356  1.2072  2.4571 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept) 13.30435    0.37639  35.347  &lt; 2e-16 ***</span>
<span class="co">#&gt; Dim.1        0.68591    0.18222   3.764  0.00131 ** </span>
<span class="co">#&gt; Dim.2       -0.09961    0.26267  -0.379  0.70874    </span>
<span class="co">#&gt; Dim.3       -0.21708    0.69014  -0.315  0.75654    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 1.805 on 19 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.4313, Adjusted R-squared:  0.3415 </span>
<span class="co">#&gt; F-statistic: 4.804 on 3 and 19 DF,  p-value: 0.01179</span>

<span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/dimdesc.html">dimdesc</a></span><span class="op">(</span><span class="va">env.pca</span><span class="op">)</span><span class="op">$</span><span class="va">Dim.1</span> 
<span class="co">#&gt; $quanti</span>
<span class="co">#&gt;          correlation      p.value</span>
<span class="co">#&gt; maxi.jan   0.9279073 1.846790e-10</span>
<span class="co">#&gt; maxi.jul   0.8877675 1.607390e-08</span>
<span class="co">#&gt; mini.jul   0.7117620 1.396338e-04</span>
<span class="co">#&gt; mini.jan   0.6830371 3.282701e-04</span>
<span class="co">#&gt; rain.jan  -0.6516187 7.559358e-04</span>
<span class="co">#&gt; rain.tot  -0.7284135 8.112903e-05</span>
<span class="co">#&gt; rain.jul  -0.8300858 9.588034e-07</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "condes" "list"</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pcr-aves-diag"></span>
<img src="livro_files/figure-html/fig-pcr-aves-diag-1.png" alt="Diagnósticos dos modelo PCR para aves." width="100%" height="100%"><p class="caption">
Figura 9.10: Diagnósticos dos modelo PCR para aves.
</p>
</div>
<p>Como percebemos, a Dim.1 foi o único gradiente ambiental que afetou a riqueza de espécies. Para interpretar esta dimensão (e outras importantes), podemos usar a função <code><a href="https://rdrr.io/pkg/FactoMineR/man/dimdesc.html">dimdesc()</a></code> para verificar as variáveis mais importantes. Neste caso, os valores mais extremos de correlação (maior que 0.8) indicam que a temperatura do mês de janeiro e julho bem como a chuva do mês de julho foram as variáveis mais importantes para determinar o gradiente ambiental expresso na dimensão 1. Assim, podemos fazer um gráfico para representar a relação entre Eixo 1 (gradiente chuva-temperatura) e a riqueza de espécies de aves. Valores negativos do eixo 1 (Gradiente ambiental - PC1) representam localidades com mais chuva, ao passo que valores positivos indicam localidades com temperaturas maiores (Figura <a href="cap9.html#fig:fig-pcr-aves-model">9.11</a>).</p>
<div class="sourceCode" id="cb376"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Dim.1</span>, y <span class="op">=</span> <span class="va">riqueza</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, fill <span class="op">=</span> <span class="st">"#525252"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, color <span class="op">=</span> <span class="st">"#1a1a1a"</span>, fill <span class="op">=</span> <span class="st">"cyan4"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Gradiente ambiental (PC1)"</span>, y <span class="op">=</span> <span class="st">"Riqueza de aves"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pcr-aves-model"></span>
<img src="livro_files/figure-html/fig-pcr-aves-model-1.png" alt="Modelo linear representando a relação entre Eixo 1 (gradiente chuva-temperatura) e a riqueza de espécies de aves." width="100%" height="100%"><p class="caption">
Figura 9.11: Modelo linear representando a relação entre Eixo 1 (gradiente chuva-temperatura) e a riqueza de espécies de aves.
</p>
</div>
<p><strong>Exemplo 2</strong></p>
<p>É possível que os dados utilizados em seu estudo sejam mistos, ou seja, incluem tanto variáveis categóricas quanto contínuas. Como falado acima, nesses casos a análise indicada é a PCoA. Assim como na PCA, podemos extrair os escores da PCoA para utilizar em análises univariadas e multivariadas.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Variáveis climáticas, vegetacionais e topográficas afetam a riqueza de ácaros?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>A densidade da vegetação e disponibilidade de água aumentam a riqueza de espécies de ácaros</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Preditoras: densidade de substrato e disponibilidade de água (contínuas), tipo de substrato (categórica com 7 níveis), densidade arbusto (ordinal com 3 níveis), e topografia (categórica com 2 níveis)</li>
<li>Dependentes: riqueza de espécies de ácaros</li>
</ul>
<p>O primeiro passo então é utilizar um método de distância apropriado para o seu conjunto de dados. Em nosso exemplo, utilizaremos a distância de Gower, que é usada para dados mistos (veja Capítulo <a href="cap14.html#cap14">14</a>).</p>
<div class="sourceCode" id="cb377"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Matriz de distância</span>
<span class="va">env.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FD/man/gowdis.html">gowdis</a></span><span class="op">(</span><span class="va">mite.env</span><span class="op">)</span>

<span class="co">## PCoA</span>
<span class="va">env.mite.pco</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/pcoa.html">pcoa</a></span><span class="op">(</span><span class="va">env.dist</span>, correction <span class="op">=</span> <span class="st">"cailliez"</span><span class="op">)</span>

<span class="co">## Porcentagem de explicação do Eixo 1</span>
<span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">env.mite.pco</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">env.mite.pco</span><span class="op">$</span><span class="va">trace</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co">#&gt; [1] 61.49635</span>

<span class="co">## Porcentagem de explicação dos Eixo 2</span>
<span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">env.mite.pco</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">env.mite.pco</span><span class="op">$</span><span class="va">trace</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
<span class="co">#&gt; [1] 32.15486</span></code></pre></div>
<p>O próximo passo é exportar os escores para as análises <em>a posteriori</em> (Figura <a href="cap9.html#fig:fig-pcr-acaros-diag">9.12</a>).</p>
<div class="sourceCode" id="cb378"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Selecionar os dois primeiros eixos</span>
<span class="va">pred.scores.mite</span> <span class="op">&lt;-</span> <span class="va">env.mite.pco</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> 

<span class="co">## Juntar com os dados da área para fazer a figura </span>
<span class="va">mite.riqueza</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/diversity.html">specnumber</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span>
<span class="va">pred.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>riqueza <span class="op">=</span> <span class="va">mite.riqueza</span>, <span class="va">pred.scores.mite</span><span class="op">)</span>

<span class="co">### Regressão múltipla </span>
<span class="va">mod.mite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">riqueza</span> <span class="op">~</span> <span class="va">Axis.1</span> <span class="op">+</span> <span class="va">Axis.2</span>, data <span class="op">=</span> <span class="va">pred.vars</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">mod.mite</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod.mite</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = riqueza ~ Axis.1 + Axis.2, data = pred.vars)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;      Min       1Q   Median       3Q      Max </span>
<span class="co">#&gt; -10.6874  -2.3960  -0.1378   2.5032   8.6873 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)  15.1143     0.4523  33.415  &lt; 2e-16 ***</span>
<span class="co">#&gt; Axis.1      -11.4303     2.0013  -5.711  2.8e-07 ***</span>
<span class="co">#&gt; Axis.2        5.6832     2.7677   2.053   0.0439 *  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 3.784 on 67 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.3548, Adjusted R-squared:  0.3355 </span>
<span class="co">#&gt; F-statistic: 18.42 on 2 and 67 DF,  p-value: 4.225e-07</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pcr-acaros-diag"></span>
<img src="livro_files/figure-html/fig-pcr-acaros-diag-1.png" alt="Diagnósticos dos modelo PCR para ácaros." width="100%" height="100%"><p class="caption">
Figura 9.12: Diagnósticos dos modelo PCR para ácaros.
</p>
</div>
<p>Finalmente, após interpretar os resultados do modelo, podemos fazer a figura com as variáveis (eixos) importantes (Figura <a href="cap9.html#fig:fig-pcr-acaros-model">9.13</a>).</p>
<div class="sourceCode" id="cb379"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g_acari_axi1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pred.vars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Axis.1</span>, y <span class="op">=</span> <span class="va">riqueza</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, fill <span class="op">=</span> <span class="st">"#525252"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, color <span class="op">=</span> <span class="st">"#1a1a1a"</span>, fill<span class="op">=</span><span class="st">"cyan4"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Gradiente ambiental (PC1)"</span>, y <span class="op">=</span> <span class="st">"Riqueza de ácaros"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="va">g_acari_axi2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pred.vars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Axis.2</span>, y <span class="op">=</span> <span class="va">riqueza</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, fill <span class="op">=</span> <span class="st">"#525252"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, color <span class="op">=</span> <span class="st">"#1a1a1a"</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Gradiente ambiental (PC2)"</span>, y <span class="op">=</span> <span class="st">"Riqueza de ácaros"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="co">## Função para combinar os dois plots em uma única janela</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">g_acari_axi1</span>, <span class="va">g_acari_axi2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-pcr-acaros-model"></span>
<img src="livro_files/figure-html/fig-pcr-acaros-model-1.png" alt="Modelo linear representando a relação entre Eixo 1 e Eixo 2 e a riqueza de espécies de ácaros." width="100%" height="100%"><p class="caption">
Figura 9.13: Modelo linear representando a relação entre Eixo 1 e Eixo 2 e a riqueza de espécies de ácaros.
</p>
</div>
</div>
</div>
<div id="ordenação-restrita" class="section level2" number="9.5">
<h2>
<span class="header-section-number">9.5</span> Ordenação restrita<a class="anchor" aria-label="anchor" href="#ordena%C3%A7%C3%A3o-restrita"><i class="fas fa-link"></i></a>
</h2>
<p>A ordenação restrita ou análise de gradiente direto, organiza os objetos de acordo com suas relações com outras variáveis (preditoras) coletadas nas mesmas unidades amostrais. O exemplo mais comum na ecologia é de investigar a relação entre diversas variáveis ambientais (matriz <strong>X</strong>) coletadas em <em>n</em> localidades e a abundância (ou presença ausência) de <em>y</em> espécies coletadas nas mesmas localidades (matrix <strong>Y</strong>). Com frequência, outros dados são utilizados como as coordenadas geográficas das unidades amostrais (matriz <strong>W</strong>), os atributos funcionais das espécies coletadas (matriz <strong>T</strong>) e a relação filogenética dessas espécies (matriz <strong>P</strong>). Diversos métodos são utilizados para combinar duas ou mais matrizes, mas neste capítulo iremos apresentar a Análise de Redundância (RDA), Análise de Redundância parcial (RDAp) e métodos espaciais para incluir a matriz <strong>W</strong> nas análises de gradiente direto.</p>
<div id="análise-de-redundância-rda" class="section level3" number="9.5.1">
<h3>
<span class="header-section-number">9.5.1</span> Análise de Redundância (RDA)<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-de-redund%C3%A2ncia-rda"><i class="fas fa-link"></i></a>
</h3>
<p>A RDA é uma análise semelhante à regressão múltipla (Capítulo <a href="cap7.html#cap7">7</a>), mas que usa dados multivariados como variável dependente. As duas matrizes comuns, matriz X (<em>n</em> unidades amostrais e <em>m</em> variáveis) e matriz Y (<em>n</em> unidades amostrais e <em>p</em> descritores - geralmente, espécies). O primeiro passo da RDA é centralizar (assim como na PCA, exemplo acima) as matrizes X e Y. Após a centralização, realiza-se regressões lineares entre X e Y para obter os valores preditos de Y (ou seja, os valores de Y que representação uma combinação linear com X). O passo seguinte é realizar uma PCA dos valores preditos de Y. Este último procedimento gera os autovalores, autovetores e os eixos canônicos que correspondem às coordenadas dos objetos (unidades amostrais), variáveis preditoras e das variáveis resposta. A diferença da ordenação do valor de Y predito e da ordenação somente de Y (como na PCA implementada acima) é que a segunda mostra a posição prevista pela relação linear entre X e Y. Logo, essa é exatamente o motivo da ordenação ser conhecida como restrita, pois a variação em Y é restrita (linearmente) pela variação de X. Assim como na regressão múltipla, a estatística da RDA é representada pelo valor de <em>R<sup>2</sup></em> e <em>F</em>. O valor de <em>R<sup>2</sup></em> indica a força da relação linear entre X e Y e o valor do <em>F</em> representa o teste global de significância. Além disso, é possível testar a significância de cada um dos eixos da ordenação (e a presença de pelo menos um eixo significativo é pré-requisito para que exista a relação linear entre X e Y) e de cada uma das variáveis preditoras da matriz X.</p>
<p><strong>Checklist</strong></p>
<ul>
<li><p>Variáveis preditoras: importante verificar se: i) a estrutura de correlação das variáveis ambientais, e a ii) presença de autocorrelação espacial</p></li>
<li><p>Composição de espécies como matriz Y: fundamental observar se os valores utilizados representam abundância ou presença-ausência e qual a necessidade de padronização (e.g., <em>Hellinger</em>)</p></li>
<li><p>Assim como em modelos de regressão linear simples e múltipla, os valores de <em>R<sup>2</sup></em> ajustado devem ser selecionados ao invés do valor de <em>R<sup>2</sup></em></p></li>
</ul>
<p><strong>Exemplo 1</strong></p>
<p>Espécies de aves que ocorrem em localidades com diferentes altitudes.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>O clima e a altitude modificam a composição de espécies de aves?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Diferenças climáticas (temperatura e chuva) e altitudinais alteram a composição de espécies de aves</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Preditoras: Temperatura e precipitação (contínuas) e altitude (categórica com três níveis)</li>
<li>Dependente: composição de espécies de aves</li>
</ul>
<p><strong>Análises</strong></p>
<div class="sourceCode" id="cb380"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Passo 1: transformação de hellinger da matriz de espécies</span>
<span class="co"># caso tenha dados de abundância.</span>
<span class="va">species.hel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, method <span class="op">=</span> <span class="st">"hellinger"</span><span class="op">)</span>

<span class="co">## Passo 2: selecionar variáveis importantes</span>
<span class="co"># Para isso, é necessário remover a variável categórica.</span>
<span class="va">env.contin</span> <span class="op">&lt;-</span> <span class="va">env</span><span class="op">[</span>, <span class="op">-</span><span class="fl">8</span><span class="op">]</span>

<span class="co">## Evite usar variáveis muito correlacionadas</span>
<span class="va">sel.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adespatial/man/forward.sel.html">forward.sel</a></span><span class="op">(</span><span class="va">species.hel</span>, <span class="va">env.contin</span><span class="op">)</span>
<span class="co">#&gt; Testing variable 1</span>
<span class="co">#&gt; Testing variable 2</span>
<span class="co">#&gt; Testing variable 3</span>
<span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 3 is 0.212000 (&gt; 0.050000)</span>
<span class="va">sel.vars</span><span class="op">$</span><span class="va">variables</span>
<span class="co">#&gt; [1] "rain.jul" "maxi.jul"</span>
<span class="va">env.sel</span> <span class="op">&lt;-</span> <span class="va">env</span><span class="op">[</span>,<span class="va">sel.vars</span><span class="op">$</span><span class="va">variables</span><span class="op">]</span>

<span class="co">## Passo 3: padronizar matriz ambiental (somente variáveis contínuas)</span>
<span class="va">env.pad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">env.sel</span>, method <span class="op">=</span> <span class="st">"standardize"</span><span class="op">)</span>

<span class="co">## Matriz final com variáveis preditoras</span>
<span class="va">env.pad.cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">env.pad</span>, altitude <span class="op">=</span> <span class="va">env</span><span class="op">$</span><span class="va">altitude</span><span class="op">)</span></code></pre></div>
<p>Depois de selecionar um subconjunto dos dados com o método <em>Forward Selection</em> e padronizá-los (média 0 e desvio padrão 1), o modelo da RDA é construído como modelos lineares (Figura <a href="cap9.html#fig:fig-rda">9.14</a>). A Ordenação Multi-Escala (MSO) também é ajustada para analisar a autocorrelação espacial.</p>
<div class="sourceCode" id="cb381"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## RDA com dados selecionados e padronizados</span>
<span class="va">rda.bird</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/cca.html">rda</a></span><span class="op">(</span><span class="va">species.hel</span> <span class="op">~</span> <span class="va">rain.jul</span> <span class="op">+</span> <span class="va">maxi.jul</span> <span class="op">+</span> <span class="va">altitude</span>, data <span class="op">=</span> <span class="va">env.pad.cat</span><span class="op">)</span>

<span class="co">## Para interpretar, é necessário saber a significância dos eixos para representar a relação entre as variáveis preditoras e a composição de espécies</span>
<span class="va">res.axis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">anova.cca</a></span><span class="op">(</span><span class="va">rda.bird</span>, by <span class="op">=</span> <span class="st">"axis"</span><span class="op">)</span> 
<span class="va">res.axis</span>
<span class="co">#&gt; Permutation test for rda under reduced model</span>
<span class="co">#&gt; Forward tests for axes</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)</span>
<span class="co">#&gt;          Df Variance       F Pr(&gt;F)    </span>
<span class="co">#&gt; RDA1      1 0.045759 12.0225  0.001 ***</span>
<span class="co">#&gt; RDA2      1 0.009992  2.6252  0.061 .  </span>
<span class="co">#&gt; RDA3      1 0.007518  1.9752  0.136    </span>
<span class="co">#&gt; RDA4      1 0.003582  0.9410  0.470    </span>
<span class="co">#&gt; Residual 18 0.068510                   </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co">## Em seguida, é possível identificar quais são as variáveis que contribuem ou que mais contribuem para a variação na composição de espécies </span>
<span class="va">res.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">anova.cca</a></span><span class="op">(</span><span class="va">rda.bird</span>, by <span class="op">=</span> <span class="st">"term"</span><span class="op">)</span> <span class="co">## Qual variável?</span>
<span class="va">res.var</span>
<span class="co">#&gt; Permutation test for rda under reduced model</span>
<span class="co">#&gt; Terms added sequentially (first to last)</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)</span>
<span class="co">#&gt;          Df Variance      F Pr(&gt;F)    </span>
<span class="co">#&gt; rain.jul  1 0.036514 9.5936  0.001 ***</span>
<span class="co">#&gt; maxi.jul  1 0.011264 2.9596  0.016 *  </span>
<span class="co">#&gt; altitude  2 0.019071 2.5053  0.011 *  </span>
<span class="co">#&gt; Residual 18 0.068510                  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co">## Além disso, é possível obter o valor do R2 do modelo</span>
<span class="va">r_quadr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/RsquareAdj.html">RsquareAdj</a></span><span class="op">(</span><span class="va">rda.bird</span><span class="op">)</span>
<span class="va">r_quadr</span>
<span class="co">#&gt; $r.squared</span>
<span class="co">#&gt; [1] 0.4938685</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $adj.r.squared</span>
<span class="co">#&gt; [1] 0.3813949</span>

<span class="co">## Ordenação multi-escala (MSO) para entender os resultados da ordenação em relação à distância geográfica</span>
<span class="va">bird.rda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/mso.html">mso</a></span><span class="op">(</span><span class="va">rda.bird</span>, <span class="va">xy</span>, grain <span class="op">=</span> <span class="fl">1</span>, permutations <span class="op">=</span> <span class="fl">99</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/mso.html">msoplot</a></span><span class="op">(</span><span class="va">bird.rda</span><span class="op">)</span>
<span class="co">#&gt; Error variance of regression model underestimated by -2.7 percent</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-rda"></span>
<img src="livro_files/figure-html/fig-rda-1.png" alt="Ordenação multi-escala (MSO) para entender os resultados da ordenação em relação à distância geográfica." width="100%" height="100%"><p class="caption">
Figura 9.14: Ordenação multi-escala (MSO) para entender os resultados da ordenação em relação à distância geográfica.
</p>
</div>
<p>Da mesma forma que nas ordenações irrestritas, podemos fazer um gráfico para visualizar as ordenações, mas agora esse gráfico é denominado “triplot”, pois possui os dados das duas ordenações (Figura <a href="cap9.html#fig:fig-rda-triplot">9.15</a>).</p>
<div class="sourceCode" id="cb382"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Triplot da RDA</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggord/man/ggord.html">ggord</a></span><span class="op">(</span><span class="va">rda.bird</span>, ptslab <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="fl">1</span>, addsize <span class="op">=</span> <span class="fl">3</span>, repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-rda-triplot"></span>
<img src="livro_files/figure-html/fig-rda-triplot-1.png" alt="Triplot da RDA." width="100%" height="100%"><p class="caption">
Figura 9.15: Triplot da RDA.
</p>
</div>
<p><strong>Interpretação dos resultados</strong></p>
<p>Os objetos <code>res.axis</code>, <code>res.var</code> e <code>r_quadr</code> mostram, respectivamente, i) as dimensões (RDA1, RDA2, etc.) que possuem variação na composição de espécies, ii) as variáveis preditoras que explicam esta variação, e iii) o valor do <em>R<sup>2</sup></em> ajustado. Neste exemplo, podemos observar que somente a dimensão 1 (RDA1) representa uma variação significativa da composição de espécies (<strong>P</strong> = 0,001). As variáveis <em>rain.jul</em>, <em>maxi.jul</em> e <em>altitude</em> foram todas preditoras importantes da composição de espécies, mas <em>rain.jul</em> se destacada com maior valor de <strong>F</strong>. Além disso, o valor do <em>R<sup>2</sup></em> ajustado de 0.381 indica forte contribuição dessas variáveis preditoras. Porém, uma das limitações desta análise é não considerar que tanto espécies quanto variáveis preditoras podem estar estruturadas espacialmente. Como resultado, os resíduos das análises podem apresentar autocorrelação espacial que, por sua vez, aumenta o Erro do Tipo I <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. A figura obtida com o código <code>msoplot(bird.rda)</code> demonstra que existe autocorrelação espacial em algumas distâncias da análise. Veja abaixo algumas alternativas para resíduos com autocorrelação espacial.</p>
</div>
<div id="análise-de-redundância-parcial-rdap" class="section level3" number="9.5.2">
<h3>
<span class="header-section-number">9.5.2</span> Análise de Redundância parcial (RDAp)<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-de-redund%C3%A2ncia-parcial-rdap"><i class="fas fa-link"></i></a>
</h3>
<p>Um dos problemas da abordagem anterior é que tanto a composição de espécies como as variáveis ambientais estão estruturadas espacialmente. Talvez mais importantes, para que os valores de probabilidade da RDA sejam interpretados corretamente (e para evitar Erro do Tipo I), os resíduos do modelo não devem estar correlacionados espacialmente, como demonstrado com a análise MSO. Uma alternativa é incluir a matriz de dados espaciais (matrix W) como valor condicional dentro da RDA. Esta análise é conhecida como RDA parcial.</p>
<p>Porém, a obtenção dos dados espaciais da matriz W é mais complexo do que simplesmente incluir dados de localização geográfica (latitude e longitude), como feito em alguns modelos lineares (e.g., <em>Generalized Least Squares</em> - GLS Capítulos <a href="cap7.html#cap7">7</a> e <a href="cap10.html#cap10">10</a>). Existem diversas ferramentas que descrevem e incorporam o componente espacial em métodos multidimensionais, mas os Mapas de Autovetores de Moran (MEM) são certamente os mais utilizados <span class="citation">(<a href="refer%C3%AAncias.html#ref-dray_community_2012" role="doc-biblioref">Dray et al. 2012</a>)</span>. A análise MEM consiste na ordenação (PCoA) de uma matriz truncada obtida através da localização geográfica das localidades utilizando distância euclidiana, matriz de conectividade e matriz espacial ponderada. Os autovalores obtidos no MEM são idênticos aos coeficientes de correlação espacial de Moran <em>I</em>. Um procedimento chave desta análise é a definição de um limiar de trucamento (do inglês <em>truncate threshold</em>). Este limiar é calculado a partir de uma “árvore de espaço mínimo” (<em>Minimum Spanning Tree</em> - MST) que conecta todos os pontos de coleta. Na prática, pontos com valores menores do que o limiar definido pela MST indicam que eles estão conectados e, assim possuem correlação positiva. Outro ponto importante desta análise é a obtenção da matriz espacial ponderada (<em>Spatial Weighting Matrix</em> - SWM). A seleção da matriz SWM é parte essencial do cálculo dos MEM e não deve ser feita arbitrariamente <span class="citation">(<a href="refer%C3%AAncias.html#ref-bauman_optimizing_2018" role="doc-biblioref">Bauman, Drouet, Fortin, et al. 2018</a>)</span>. Por este motivo, a análise recebe este nome <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">Legendre and Legendre 2012</a>)</span>. Finalmente, o método produz autovetores que representam preditores espaciais que podem ser utilizados na RDA parcial (e em outras análises). É importante ressaltar que o critério de seleção do número de autovetores é bastante debatido na literatura e, para isso, sugerimos a leitura dos seguintes artigos: <span class="citation">(<a href="refer%C3%AAncias.html#ref-diniz-filho_spatial_2012" role="doc-biblioref">Diniz-Filho et al. 2012</a>; <a href="refer%C3%AAncias.html#ref-bauman_optimizing_2018" role="doc-biblioref">Bauman, Drouet, Fortin, et al. 2018</a>; <a href="refer%C3%AAncias.html#ref-bauman_disentangling_2018" role="doc-biblioref">Bauman, Drouet, Dray, et al. 2018</a>)</span>.</p>
<p>Então, o primeiro passo para realizar uma RDA parcial é de gerar os autovetores espaciais (MEMs).</p>
<div class="sourceCode" id="cb383"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="co"># Matriz padronizada de composição de espécies. </span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">species.hel</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span> 
<span class="co">#&gt;     Fauvette_orphee Fauvette_des_jardins Fauvette_a_tete_noire Fauvette_babillarde Fauvette_grisette Fauvette_pitchou</span>
<span class="co">#&gt; S01               0            0.3651484             0.3651484           0.2581989         0.2581989                0</span>
<span class="co">#&gt; S02               0            0.3333333             0.3333333           0.2357023         0.2357023                0</span>
<span class="co">#&gt; S03               0            0.3162278             0.3162278           0.3162278         0.2236068                0</span>
<span class="co">#&gt; S04               0            0.4200840             0.3429972           0.2425356         0.0000000                0</span>
<span class="co">#&gt; S05               0            0.3872983             0.3162278           0.2236068         0.3162278                0</span>
<span class="co">#&gt; S06               0            0.3779645             0.3779645           0.2672612         0.0000000                0</span>

<span class="co">## Latitude e longitude</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>
<span class="co">#&gt;       x   y</span>
<span class="co">#&gt; S01 156 252</span>
<span class="co">#&gt; S02 141 217</span>
<span class="co">#&gt; S03 171 233</span>
<span class="co">#&gt; S04 178 215</span>
<span class="co">#&gt; S05 123 189</span>
<span class="co">#&gt; S06 154 195</span>

<span class="co">## dados ambientais padronizados e altitude</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">env.pad.cat</span><span class="op">)</span>
<span class="co">#&gt;     rain.jul   maxi.jul      altitude</span>
<span class="co">#&gt; S01 1.333646  0.1462557    Montanhoso</span>
<span class="co">#&gt; S02 1.468827 -0.6848206 Intermediário</span>
<span class="co">#&gt; S03 1.505694 -0.2099199    Montanhoso</span>
<span class="co">#&gt; S04 1.296778 -2.0699476    Montanhoso</span>
<span class="co">#&gt; S05 1.075572 -0.3682201         Plano</span>
<span class="co">#&gt; S06 1.100151 -0.6056705 Intermediário</span>

<span class="co">## Passo 1: Gerar um arquivo LIST W: list binária de vizinhança</span>
<span class="va">mat_knn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knearneigh.html">knearneigh</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">2</span>, longlat <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">mat_nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knn2nb.html">knn2nb</a></span><span class="op">(</span><span class="va">mat_knn</span>, sym <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">mat_listw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">mat_nb</span>, style <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span>
<span class="va">mat_listw</span>
<span class="co">#&gt; Characteristics of weights list object:</span>
<span class="co">#&gt; Neighbour list object:</span>
<span class="co">#&gt; Number of regions: 23 </span>
<span class="co">#&gt; Number of nonzero links: 58 </span>
<span class="co">#&gt; Percentage nonzero weights: 10.96408 </span>
<span class="co">#&gt; Average number of links: 2.521739 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Weights style: W </span>
<span class="co">#&gt; Weights constants summary:</span>
<span class="co">#&gt;    n  nn S0       S1       S2</span>
<span class="co">#&gt; W 23 529 23 18.84444 96.01111</span>

<span class="co">## Passo 2: Listar os métodos "candidatos" para obter a matriz SWM</span>
<span class="va">MEM_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adespatial/man/mem.html">scores.listw</a></span><span class="op">(</span><span class="va">mat_listw</span>, MEM.autocor <span class="op">=</span> <span class="st">"positive"</span><span class="op">)</span>
<span class="va">candidates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adespatial/man/listw.candidates.html">listw.candidates</a></span><span class="op">(</span><span class="va">xy</span>, nb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gab"</span>, <span class="st">"mst"</span>, <span class="st">"dnear"</span><span class="op">)</span>, 
                               weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"binary"</span>, <span class="st">"flin"</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Passo 3: Selecionar a melhor matriz SWM e executar o MEM</span>
<span class="va">W_sel_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adespatial/man/listw.select.html">listw.select</a></span><span class="op">(</span><span class="va">species.hel</span>, <span class="va">candidates</span>, MEM.autocor <span class="op">=</span> <span class="st">"positive"</span>,
                          p.adjust <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"FWD"</span><span class="op">)</span>
<span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 5 is 0.112000 (&gt; 0.050000)</span>
<span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 3 is 0.059000 (&gt; 0.050000)</span>
<span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 3 is 0.060000 (&gt; 0.050000)</span>
<span class="co">#&gt; Procedure stopped (alpha criteria): pvalue for variable 4 is 0.157000 (&gt; 0.050000)</span>

<span class="co">## Passo 4: Matriz dos preditores espaciais escolhidos (MEMs)</span>
<span class="va">spatial.pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">W_sel_mat</span><span class="op">$</span><span class="va">best</span><span class="op">$</span><span class="va">MEM.select</span><span class="op">)</span>

<span class="co">## É necessário atribuir os nomes das linhas</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">spatial.pred</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span> </code></pre></div>
<p>Depois de gerar os valores dos autovetores espaciais (MEM), é possível executar a RDA parcial utilizando esses valores no argumento <code>Conditional</code>.</p>
<div class="sourceCode" id="cb384"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Combinar variáveis ambientais e espaciais em um único data.frame</span>
<span class="va">pred.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">env.pad.cat</span>, <span class="va">spatial.pred</span><span class="op">)</span>

<span class="co">## RDA parcial</span>
<span class="va">rda.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/cca.html">rda</a></span><span class="op">(</span><span class="va">species.hel</span> <span class="op">~</span>
                 <span class="va">rain.jul</span> <span class="op">+</span> <span class="va">maxi.jul</span> <span class="op">+</span> <span class="va">altitude</span> <span class="op">+</span> <span class="co"># Preditores ambientais</span>
                 <span class="fu">Condition</span><span class="op">(</span><span class="va">MEM1</span> <span class="op">+</span> <span class="va">MEM2</span> <span class="op">+</span> <span class="va">MEM4</span> <span class="op">+</span> <span class="va">MEM5</span><span class="op">)</span>, <span class="co"># Preditores espaciais</span>
             data <span class="op">=</span> <span class="va">pred.vars</span><span class="op">)</span>

<span class="co">## Interpretação</span>
<span class="co"># Para interpretar, é necessário saber a significância dos eixos para representar a relação entre as variáveis preditoras e a composição de espécies.</span>
<span class="va">res.p.axis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">anova.cca</a></span><span class="op">(</span><span class="va">rda.p</span>, by <span class="op">=</span> <span class="st">"axis"</span><span class="op">)</span> 
<span class="va">res.p.axis</span>
<span class="co">#&gt; Permutation test for rda under reduced model</span>
<span class="co">#&gt; Forward tests for axes</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude + Condition(MEM1 + MEM2 + MEM4 + MEM5), data = pred.vars)</span>
<span class="co">#&gt;          Df Variance      F Pr(&gt;F)</span>
<span class="co">#&gt; RDA1      1 0.008471 2.1376  0.316</span>
<span class="co">#&gt; RDA2      1 0.004830 1.2189  0.779</span>
<span class="co">#&gt; RDA3      1 0.003240 0.8176  0.890</span>
<span class="co">#&gt; RDA4      1 0.001891 0.4773  0.895</span>
<span class="co">#&gt; Residual 14 0.055477</span>

<span class="co">## Contribuição</span>
<span class="co"># Em seguida, é possível identificar quais são as variáveis que contribuem ou que mais contribuem para a variação na composição de espécies.</span>
<span class="va">res.p.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">anova.cca</a></span><span class="op">(</span><span class="va">rda.p</span>, by <span class="op">=</span> <span class="st">"term"</span><span class="op">)</span> <span class="co">## Qual variável?</span>
<span class="va">res.p.var</span>
<span class="co">#&gt; Permutation test for rda under reduced model</span>
<span class="co">#&gt; Terms added sequentially (first to last)</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: rda(formula = species.hel ~ rain.jul + maxi.jul + altitude + Condition(MEM1 + MEM2 + MEM4 + MEM5), data = pred.vars)</span>
<span class="co">#&gt;          Df Variance      F Pr(&gt;F)</span>
<span class="co">#&gt; rain.jul  1 0.004406 1.1119  0.349</span>
<span class="co">#&gt; maxi.jul  1 0.004446 1.1220  0.338</span>
<span class="co">#&gt; altitude  2 0.009579 1.2087  0.241</span>
<span class="co">#&gt; Residual 14 0.055477</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/RsquareAdj.html">RsquareAdj</a></span><span class="op">(</span><span class="va">rda.p</span><span class="op">)</span>
<span class="co">#&gt; $r.squared</span>
<span class="co">#&gt; [1] 0.1361661</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $adj.r.squared</span>
<span class="co">#&gt; [1] 0.02330319</span></code></pre></div>
<p>Se você comparar os resultados do objeto res.p.var (RDA parcial) com res.var (RDA simples) é possível perceber como a estrutura espacial nos resíduos aumenta a probabilidade de cometer Erro do Tipo I. O modelo da RDA parcial mostra que não existem qualquer efeito direto das variáveis ambientais sobre a composição de espécies (conclusão com a RDA simples). Na verdade, tanto a composição de espécies quanto as variáveis climáticas estão fortemente estruturadas no espaço, como demonstramos a seguir.</p>
<div class="sourceCode" id="cb385"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Padrão espacial na composição de espécies</span>
<span class="va">pca.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">species.hel</span>, scale <span class="op">=</span> <span class="cn">FALSE</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">moran.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.mc.html">moran.mc</a></span><span class="op">(</span><span class="va">pca.comp</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">mat_listw</span>, <span class="fl">999</span><span class="op">)</span>

<span class="co">## Padrão espacial das variáveis ambientais</span>
<span class="va">env</span><span class="op">$</span><span class="va">altitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/factor.html">as.factor</a></span><span class="op">(</span><span class="va">env</span><span class="op">$</span><span class="va">altitude</span><span class="op">)</span>
<span class="va">ca.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.hillsmith.html">dudi.hillsmith</a></span><span class="op">(</span><span class="va">env</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">moran.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.mc.html">moran.mc</a></span><span class="op">(</span><span class="va">ca.env</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">mat_listw</span>, <span class="fl">999</span><span class="op">)</span>

<span class="co">## Estrutura espacial na composição de espécies?</span>
<span class="va">moran.comp</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Monte-Carlo simulation of Moran I</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  pca.comp$li[, 1] </span>
<span class="co">#&gt; weights: mat_listw  </span>
<span class="co">#&gt; number of simulations + 1: 1000 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; statistic = 0.62815, observed rank = 1000, p-value = 0.001</span>
<span class="co">#&gt; alternative hypothesis: greater</span>

<span class="co">## Estrutura espacial na variação ambiental?</span>
<span class="va">moran.env</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Monte-Carlo simulation of Moran I</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ca.env$li[, 1] </span>
<span class="co">#&gt; weights: mat_listw  </span>
<span class="co">#&gt; number of simulations + 1: 1000 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; statistic = 0.72714, observed rank = 1000, p-value = 0.001</span>
<span class="co">#&gt; alternative hypothesis: greater</span></code></pre></div>
<p>Como resultado, é possível que a variação ambiental espacialmente estruturada seja o principal efeito sobre a composição de espécies. Uma maneira de visualizar a contribuição relativa de diferentes matrizes (ambiental e espacial, por exemplo) é utilizar o método de partição de variância. O resultado deste modelo indica que, de fato, não existe efeito direto das variáveis ambientais e sim do componente representado pela autocorrelação espacial dessas variáveis (Figura <a href="cap9.html#fig:fig-rda-parcial">9.16</a>).</p>
<div class="sourceCode" id="cb386"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Triplot da RDA</span>
<span class="co"># Partição de variância.</span>
<span class="va">pv.birds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/varpart.html">varpart</a></span><span class="op">(</span><span class="va">species.hel</span>, <span class="va">env.pad.cat</span>, <span class="va">spatial.pred</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">pv.birds</span>, cutoff <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span><span class="st">"Diagrama de Venn: partição de variância"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-rda-parcial"></span>
<img src="livro_files/figure-html/fig-rda-parcial-1.png" alt="Diagrama de Venn mostrando a partição de variância da RDA." width="100%" height="100%"><p class="caption">
Figura 9.16: Diagrama de Venn mostrando a partição de variância da RDA.
</p>
</div>
</div>
<div id="análise-de-redundância-baseada-em-distância-db-rda" class="section level3" number="9.5.3">
<h3>
<span class="header-section-number">9.5.3</span> Análise de Redundância baseada em distância (db-RDA)<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-de-redund%C3%A2ncia-baseada-em-dist%C3%A2ncia-db-rda"><i class="fas fa-link"></i></a>
</h3>
<p>Acima, apresentamos a análise RDA que permite comparar, por exemplo, se variáveis ambientais determinam a variação na composição de espécies. A RDA utiliza os dados brutos de composição de espécies e é baseada em uma PCA (i.e., requer distância euclidiana). Porém, em algumas situações é necessário utilizar outras medidas de distância tais como <em>Bray-Curtis</em> ou Gower. Esta análise é bastante útil também quando a matriz resposta já é uma matriz de distância, tais como as que são geradas por decomposição da diversidade beta. Neste caso, Legendre &amp; Anderson <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_distance-based_1999" role="doc-biblioref">1999</a>)</span> propuseram a análise db-RDA (RDA baseada em distância). O primeiro passo da análise é gerar uma matriz de distância a partir da matriz bruta (e.g., composição de espécies). Depois, a técnica executa uma PCoA (corrigindo potenciais autovetores com autovalores negativos; ver discussão acima) para comparar com os termos do modelo (matriz <strong>X</strong>, como na RDA).
Para exemplificar como esta análise pode ser implementada no R, vamos usar o mesmo exemplo demonstrado na análise RDA (ver acima). Porém, vamos fazer um ajuste sutil na pergunta “o clima e a altitude modificam a dissimilaridade (diversidade beta) de espécies de aves?”. Veja que neste caso, estamos perguntando diretamente sobre uma medida de diversidade beta, que será calculada com o método <em>Bray-Curtis</em>. As variáveis preditoras serão as mesmas obtidas no exemplo da RDA: <code>env.pad.cat</code>.</p>
<p><strong>Análise</strong></p>
<div class="sourceCode" id="cb387"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Passo 1: transformação de hellinger da matriz de espécies</span>
<span class="co"># caso tenha dados de abundância.</span>
<span class="va">species.hel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span><span class="va">species</span>, <span class="st">"hellinger"</span><span class="op">)</span>

<span class="co">## Passo 2: gerar matriz de distância (Diversidade beta: Bray-Curtis)</span>
<span class="va">dbeta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">species.hel</span>, <span class="st">"bray"</span><span class="op">)</span>

<span class="co">## Passo 2: dbRDA </span>
<span class="va">dbrda.bird</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/capscale.html">capscale</a></span> <span class="op">(</span><span class="va">dbeta</span><span class="op">~</span><span class="va">rain.jul</span><span class="op">+</span><span class="va">maxi.jul</span><span class="op">+</span><span class="va">altitude</span>, data<span class="op">=</span><span class="va">env.pad.cat</span><span class="op">)</span>

<span class="co"># Para interpretar, é necessário saber a significância dos eixos para representar a relação entre as variáveis preditoras e a composição de espécies</span>
<span class="va">db.res.axis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">anova.cca</a></span><span class="op">(</span><span class="va">dbrda.bird</span>, by <span class="op">=</span> <span class="st">"axis"</span><span class="op">)</span> 
<span class="va">db.res.axis</span>
<span class="co">#&gt; Permutation test for capscale under reduced model</span>
<span class="co">#&gt; Forward tests for axes</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: capscale(formula = dbeta ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)</span>
<span class="co">#&gt;          Df SumOfSqs       F Pr(&gt;F)    </span>
<span class="co">#&gt; CAP1      1 0.274186 16.9355  0.001 ***</span>
<span class="co">#&gt; CAP2      1 0.044965  2.7773  0.110    </span>
<span class="co">#&gt; CAP3      1 0.018141  1.1205  0.656    </span>
<span class="co">#&gt; CAP4      1 0.009500  0.5868  0.788    </span>
<span class="co">#&gt; Residual 18 0.291420                   </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Em seguida, é possível identificar quais são as variáveis que contribuem ou que mais contribuem para a variação na composição de espécies </span>
<span class="va">db.res.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">anova.cca</a></span><span class="op">(</span><span class="va">dbrda.bird</span>, by <span class="op">=</span> <span class="st">"term"</span><span class="op">)</span> <span class="co">## Qual variável?</span>
<span class="va">db.res.var</span>
<span class="co">#&gt; Permutation test for capscale under reduced model</span>
<span class="co">#&gt; Terms added sequentially (first to last)</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: capscale(formula = dbeta ~ rain.jul + maxi.jul + altitude, data = env.pad.cat)</span>
<span class="co">#&gt;          Df SumOfSqs       F Pr(&gt;F)    </span>
<span class="co">#&gt; rain.jul  1 0.209981 12.9697  0.001 ***</span>
<span class="co">#&gt; maxi.jul  1 0.041846  2.5847  0.070 .  </span>
<span class="co">#&gt; altitude  2 0.094966  2.9328  0.012 *  </span>
<span class="co">#&gt; Residual 18 0.291420                   </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Além disso, é possível obter o valor do R2 do modelo</span>
<span class="va">db_r_quadr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/RsquareAdj.html">RsquareAdj</a></span><span class="op">(</span><span class="va">dbrda.bird</span><span class="op">)</span>
<span class="va">db_r_quadr</span>
<span class="co">#&gt; $r.squared</span>
<span class="co">#&gt; [1] 0.6116758</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $adj.r.squared</span>
<span class="co">#&gt; [1] 0.5253816</span></code></pre></div>
<p><strong>Interpretação dos resultados</strong></p>
<p>Assim como apresentado na RDA, os resultados obtidos em <code>db.res.var</code> sugerem que as variáveis <code>rain.jul</code>, <code>maxi.jul</code> e <code>altitude</code> afetam a diversidade beta de aves. O valor do <em>R<sup>2</sup></em> ajustado (0.495) sugere forte relação entre o gradiente ambiental e a diversidade beta. A comparação entre o valor do <code>db_r_quadr</code> e <code>r_quadr</code> indica que a db-RDA teve melhor ajuste para comparar o mesmo conjunto de dados.</p>
</div>
</div>
<div id="permanova" class="section level2" number="9.6">
<h2>
<span class="header-section-number">9.6</span> PERMANOVA<a class="anchor" aria-label="anchor" href="#permanova"><i class="fas fa-link"></i></a>
</h2>
<p>A PERMANOVA é uma sigla, em inglês, de <em>Permutational Multivariate Analysis of Variance</em>, análise proposta por Marti Anderson <span class="citation">(<a href="refer%C3%AAncias.html#ref-anderson_new_2001" role="doc-biblioref">M. J. Anderson 2001</a>)</span>. A PERMANOVA é usada para testar hipóteses multivariadas que comparam a abundância de diferentes espécies em resposta a diferentes tratamentos ou gradientes ambientais. Essa análise foi desenvolvida como forma de solucionar algumas limitações da tradicional ANOVA multivariada (MANOVA). Em especial, o pressuposto da MANOVA de distribuição normal multivariada é raramente encontrado em dados ecológicos.</p>
<p>O primeiro passo da PERMANOVA é selecionar uma medida de distância apropriada aos dados e, além disso, verificar a necessidade de padronização ou transformação dos dados. Em seguida, as distâncias são comparadas entre os grupos de interesse (por exemplo, tratamento versus controle) usando a estatística <em>F</em> de maneira muito parecida com uma ANOVA (Capítulo <a href="cap7.html#cap7">7</a>), chamada de <em>pseudo-F</em>:</p>
<p><span class="math display">\[F_pseudo = (SSa / SSr)*[(N-g) / (g-1)]\]</span></p>
<p>Nessa equação</p>
<ul>
<li>
<em>SSa</em> representa a soma dos quadrados entre grupos</li>
<li>
<em>SSr</em> a soma de quadrados dentro do grupo (residual)</li>
<li>
<em>N</em> o número de unidades amostrais</li>
<li>
<em>g</em> os grupos (ou níveis da variável categórica)</li>
</ul>
<p>Esta fórmula do <em>pseudo-F</em> é específica para desenho experimental com um fator. Outros desenhos mais complexos são apresentados em Anderson <span class="citation">(<a href="refer%C3%AAncias.html#ref-anderson_new_2001" role="doc-biblioref">2001</a>, <a href="refer%C3%AAncias.html#ref-anderson_permutational_2017" role="doc-biblioref">2017</a>)</span>. O cálculo do valor de probabilidade é realizado por métodos de permutação que são discutidos em Anderson &amp; Ter Braak <span class="citation">(<a href="refer%C3%AAncias.html#ref-anderson_permutation_2003" role="doc-biblioref">2003</a>)</span>.</p>
<p><strong>Exemplo 1</strong></p>
<p>Espécies de aves que ocorrem em localidades com diferentes altitudes.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>O clima e a altitude modificam a composição de espécies de aves?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Diferenças climáticas (temperatura e chuva) e altitudinais alteram a composição de espécies de aves</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Preditoras: Temperatura e chuva (contínuas) e altitude (categórica com três níveis)</li>
<li>Dependente: composição de espécies de aves</li>
</ul>
<div class="sourceCode" id="cb388"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Composição de espécies padronizar com método de Hellinger</span>
<span class="va">species.hel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, method <span class="op">=</span> <span class="st">"hellinger"</span><span class="op">)</span>

<span class="co">## Matriz de distância com método Bray-Curtis</span>
<span class="va">sps.dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species.hel</span>, method <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span></code></pre></div>
<p>Para reduzir o número de variáveis no modelo, você pode considerar duas abordagens. A primeira, e mais importante delas, é manter somente variáveis preditoras que você tenha razão biológica para mantê-la e, além disso, que esteja relacionada com suas hipóteses. Assim, uma vez que você já removeu variáveis que não possuem relevância biológica, você deve usar diferentes métodos para remover as variáveis muito correlacionadas (<em>forward selection</em>, <em>Variance Inflation Factor (VIF)</em>, entre outros). Neste exemplo, vamos simplesmente fazer uma correlação múltipla e remover as variáveis com correlação maior do que 0.9 ou -0.9. A função <code><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs()</a></code> mostra um gráfico bem didático para representar a relação entre todas as variáveis e o valor (r) desta correlação (mais em Capítulo <a href="cap7.html#cap7">7</a>) (Figura <a href="cap9.html#fig:fig-permanova-prev">9.17</a>).</p>
<div class="sourceCode" id="cb389"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Verifica correlação entre as variáveis</span>
<span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>

<span class="co">## Após verificar a estrutura de correlação, vamos manter somente três variáveis</span>
<span class="va">env2</span> <span class="op">&lt;-</span> <span class="va">env</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mini.jan"</span>, <span class="st">"rain.tot"</span>, <span class="st">"altitude"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-permanova-prev"></span>
<img src="livro_files/figure-html/fig-permanova-prev-1.png" alt="Correlograma mostrando a correlação entre as variáveis." width="100%" height="100%"><p class="caption">
Figura 9.17: Correlograma mostrando a correlação entre as variáveis.
</p>
</div>
<p>Após selecionar as variáveis do modelo, vamos executar a PERMANOVA e entender as principais etapas para interpretar corretamente o teste. A função <code><a href="https://rdrr.io/pkg/vegan/man/vegan-deprecated.html">adonis()</a></code> do pacote <code>vegan</code> é uma boa opção. Porém, é importante referir o programa PRIMER e PERMANOVA+ como ótima opção para implementar a PERMANOVA e ter maior controle em desenhos complexos <span class="citation">(<a href="refer%C3%AAncias.html#ref-anderson_permanova+_2008" role="doc-biblioref">M. J. Anderson, Gorley, and Clarke 2008</a>)</span>. Assim como nos modelos lineares apresentados no Capítulo <a href="cap7.html#cap7">7</a>, os argumentos seguem o mesmo formato, com variável dependente separada por um “~” das variáveis preditoras. Porém, alguns autores demonstraram que a PERMANOVA (assim como Mantel e ANOSIM) não pode identificar se diferenças significativas do teste (usando a estatística <em>pseudo-F</em>) devem-se à diferenças no posição, na dispersão ou ambos. Ou seja, ao comparar grupos não é possível identificar se existe mudanças de composição (posição) ou se a variação da composição de espécies dentro de um grupo (dispersão) é maior do que a variação dentro do outro grupo <span class="citation">(<a href="refer%C3%AAncias.html#ref-anderson_permanova_2013" role="doc-biblioref">M. J. Anderson and Walsh 2013</a>)</span>. Para solucionar este problema, é possível combinar a PERMANOVA com a análise PERMDISP (ou BETADISPER, como chamado no pacote <code>vegan</code> implementado através da função <code><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper()</a></code>). Esta análise permite comparar se existe heterogeneidade nas variâncias entre grupos. Deste modo, com a presença de heterogeneidade de variâncias (valor do BETADISPER significativo), é possível saber que as diferenças entre os grupos ocorrem principalmente por diferenças na dispersão e não, necessariamente, de posição. Mais detalhes sobre a relevância de combinar essas duas análises estão disponíveis em Anderson &amp; Walsh <span class="citation">(<a href="refer%C3%AAncias.html#ref-anderson_permanova_2013" role="doc-biblioref">2013</a>)</span>.</p>
<div class="sourceCode" id="cb390"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## PERMANOVA</span>
<span class="va">perm.aves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/adonis.html">adonis2</a></span><span class="op">(</span><span class="va">sps.dis</span> <span class="op">~</span> <span class="va">mini.jan</span> <span class="op">+</span> <span class="va">rain.tot</span> <span class="op">+</span> <span class="va">altitude</span>, data <span class="op">=</span> <span class="va">env2</span><span class="op">)</span>
<span class="va">perm.aves</span> <span class="co">### Diferenças entre os tratamentos?</span>
<span class="co">#&gt; Permutation test for adonis under reduced model</span>
<span class="co">#&gt; Terms added sequentially (first to last)</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; adonis2(formula = sps.dis ~ mini.jan + rain.tot + altitude, data = env2)</span>
<span class="co">#&gt;          Df SumOfSqs      R2      F Pr(&gt;F)    </span>
<span class="co">#&gt; mini.jan  1  0.09069 0.15997 6.3307  0.001 ***</span>
<span class="co">#&gt; rain.tot  1  0.12910 0.22771 9.0118  0.001 ***</span>
<span class="co">#&gt; altitude  2  0.08929 0.15749 3.1163  0.011 *  </span>
<span class="co">#&gt; Residual 18  0.25787 0.45483                  </span>
<span class="co">#&gt; Total    22  0.56695 1.00000                  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co">## BETADISPER</span>
<span class="va">betad.aves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/betadisper.html">betadisper</a></span><span class="op">(</span><span class="va">sps.dis</span>, <span class="va">env2</span><span class="op">$</span><span class="va">altitude</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/anova.cca.html">permutest</a></span><span class="op">(</span><span class="va">betad.aves</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Permutation test for homogeneity of multivariate dispersions</span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: Distances</span>
<span class="co">#&gt;           Df    Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)</span>
<span class="co">#&gt; Groups     2 0.0042643 0.0021322 1.4672    999  0.265</span>
<span class="co">#&gt; Residuals 20 0.0290636 0.0014532</span></code></pre></div>
<p>Em nosso exemplo, a temperatura, precipitação e altitude afetaram a variação na composição de espécies. Porém, para identificar se as diferenças de composição entre os níveis da variável altitude, é necessário interpretar os resultados da análise BETADISPER. O código <code>permutest(betad.aves)</code> mostra que o valor de probabilidade da análise foi de 0.253, ou seja, a hipótese nula de que a variância entre grupos é homogênea é aceita. Assim, não existe diferenças na dispersão entre grupos, sugerindo que a diferença encontrada na PERMANOVA (objeto <code>perm.aves</code>) se deve, em parte, à mudança na composição de espécies de aves entre diferentes altitudes (R<sup>2</sup> = 0.135). Além disso, a precipitação (R<sup>2</sup> = 0.183) e temperatura (R<sup>2</sup> = 0.127) foram fatores importantes na variação da composição de espécies.</p>
<p>Como falado anteriormente, as análises de ordenação irrestritas (PCA, PCoA, nMDS) são utilizadas para explorar dados. Uma maneira poderosa de usá-las é combinando com análises que testam hipóteses, como PERMANOVA e RDA. A literatura ecológica tem usado a Análise de Escalonamento não-Métrico (<em>non-Metric Multidimensional Scaling</em> - nMDS) combinado com análises multidimensionais de variância (como a PERMANOVA) para visualização da similaridade na composição de espécies dentro e entre grupos. A seguir, implementamos o nMDS na matriz de composição de espécies de ácaros (Figura <a href="cap9.html#fig:fig-nmds">9.18</a>).</p>
<div class="sourceCode" id="cb391"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Matriz de distância representando a variação na composição de espécies (método Bray-Curtis)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">sps.dis</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>
<span class="co">#&gt;           S01        S02        S03       S04       S05       S06</span>
<span class="co">#&gt; S01 0.0000000 0.15133734 0.16720405 0.2559122 0.2559882 0.2588892</span>
<span class="co">#&gt; S02 0.1513373 0.00000000 0.04114702 0.1190172 0.1289682 0.1391056</span>
<span class="co">#&gt; S03 0.1672040 0.04114702 0.00000000 0.1420233 0.1358127 0.1410867</span>
<span class="co">#&gt; S04 0.2559122 0.11901720 0.14202325 0.0000000 0.1140283 0.1199803</span>
<span class="co">#&gt; S05 0.2559882 0.12896823 0.13581271 0.1140283 0.0000000 0.2129054</span>
<span class="co">#&gt; S06 0.2588892 0.13910558 0.14108668 0.1199803 0.2129054 0.0000000</span>

<span class="co">## É preciso calcular uma primeira "melhor" solução do nMDS</span>
<span class="va">sol1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/metaMDS.html">metaMDS</a></span><span class="op">(</span><span class="va">sps.dis</span><span class="op">)</span>
<span class="co">#&gt; Run 0 stress 0.1344042 </span>
<span class="co">#&gt; Run 1 stress 0.3825954 </span>
<span class="co">#&gt; Run 2 stress 0.1272417 </span>
<span class="co">#&gt; ... New best solution</span>
<span class="co">#&gt; ... Procrustes: rmse 0.07890815  max resid 0.3526073 </span>
<span class="co">#&gt; Run 3 stress 0.1344042 </span>
<span class="co">#&gt; Run 4 stress 0.1338432 </span>
<span class="co">#&gt; Run 5 stress 0.1626783 </span>
<span class="co">#&gt; Run 6 stress 0.1336481 </span>
<span class="co">#&gt; Run 7 stress 0.1272417 </span>
<span class="co">#&gt; ... Procrustes: rmse 6.723274e-06  max resid 1.889203e-05 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 8 stress 0.1338432 </span>
<span class="co">#&gt; Run 9 stress 0.1378506 </span>
<span class="co">#&gt; Run 10 stress 0.1272418 </span>
<span class="co">#&gt; ... Procrustes: rmse 0.0001085155  max resid 0.0004162969 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 11 stress 0.1272418 </span>
<span class="co">#&gt; ... Procrustes: rmse 4.197901e-05  max resid 0.000160606 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 12 stress 0.1378506 </span>
<span class="co">#&gt; Run 13 stress 0.1272418 </span>
<span class="co">#&gt; ... Procrustes: rmse 5.310796e-05  max resid 0.0001988503 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 14 stress 0.1580523 </span>
<span class="co">#&gt; Run 15 stress 0.1344042 </span>
<span class="co">#&gt; Run 16 stress 0.1272418 </span>
<span class="co">#&gt; ... Procrustes: rmse 2.586759e-05  max resid 9.827497e-05 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 17 stress 0.1584787 </span>
<span class="co">#&gt; Run 18 stress 0.1344042 </span>
<span class="co">#&gt; Run 19 stress 0.1344042 </span>
<span class="co">#&gt; Run 20 stress 0.1344042 </span>
<span class="co">#&gt; *** Solution reached</span>

<span class="co">## Melhor solução</span>
<span class="co"># Depois, executar a mesma função, mas utilizando uma "melhor solução inicial" para evitar resultdos subótimos no nMDS .</span>
<span class="va">nmds.beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/metaMDS.html">metaMDS</a></span><span class="op">(</span><span class="va">sps.dis</span>, previous.best <span class="op">=</span> <span class="va">sol1</span><span class="op">)</span>
<span class="co">#&gt; Starting from 2-dimensional configuration</span>
<span class="co">#&gt; Run 0 stress 0.1272417 </span>
<span class="co">#&gt; Run 1 stress 0.1272418 </span>
<span class="co">#&gt; ... Procrustes: rmse 2.188819e-05  max resid 7.340362e-05 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 2 stress 0.1338432 </span>
<span class="co">#&gt; Run 3 stress 0.1584788 </span>
<span class="co">#&gt; Run 4 stress 0.1344043 </span>
<span class="co">#&gt; Run 5 stress 0.1338433 </span>
<span class="co">#&gt; Run 6 stress 0.1336481 </span>
<span class="co">#&gt; Run 7 stress 0.1344042 </span>
<span class="co">#&gt; Run 8 stress 0.1338432 </span>
<span class="co">#&gt; Run 9 stress 0.1272418 </span>
<span class="co">#&gt; ... Procrustes: rmse 2.708248e-05  max resid 0.0001008894 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 10 stress 0.1336481 </span>
<span class="co">#&gt; Run 11 stress 0.1344042 </span>
<span class="co">#&gt; Run 12 stress 0.3798204 </span>
<span class="co">#&gt; Run 13 stress 0.1336481 </span>
<span class="co">#&gt; Run 14 stress 0.1336481 </span>
<span class="co">#&gt; Run 15 stress 0.1344042 </span>
<span class="co">#&gt; Run 16 stress 0.1336481 </span>
<span class="co">#&gt; Run 17 stress 0.1338432 </span>
<span class="co">#&gt; Run 18 stress 0.1272418 </span>
<span class="co">#&gt; ... Procrustes: rmse 2.303898e-05  max resid 8.758403e-05 </span>
<span class="co">#&gt; ... Similar to previous best</span>
<span class="co">#&gt; Run 19 stress 0.1344042 </span>
<span class="co">#&gt; Run 20 stress 0.1378506 </span>
<span class="co">#&gt; *** Solution reached</span>

<span class="co">## Stress</span>
<span class="co"># O stress é o valor mais importante para interpretar a qualidade da ordenação.</span>
<span class="va">nmds.beta</span><span class="op">$</span><span class="va">stress</span> <span class="co"># valor ideal entre 0 e 0.2</span>
<span class="co">#&gt; [1] 0.1272417</span>

<span class="co">## Exportar os valores para fazer gráfico </span>
<span class="va">dat.graf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">nmds.beta</span><span class="op">$</span><span class="va">points</span>, altitude <span class="op">=</span> <span class="va">env2</span><span class="op">$</span><span class="va">altitude</span><span class="op">)</span>

<span class="co">## Definir os grupos ("HULL") para serem categorizados no gráfico </span>
<span class="va">grp.mon</span> <span class="op">&lt;-</span> <span class="va">dat.graf</span><span class="op">[</span><span class="va">dat.graf</span><span class="op">$</span><span class="va">altitude</span> <span class="op">==</span> <span class="st">"Montanhoso"</span>, <span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/grDevices/chull.html">chull</a></span><span class="op">(</span><span class="va">dat.graf</span><span class="op">[</span><span class="va">dat.graf</span><span class="op">$</span><span class="va">altitude</span> <span class="op">==</span> <span class="st">"Montanhoso"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MDS1"</span>, <span class="st">"MDS2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span>

<span class="va">grp.int</span> <span class="op">&lt;-</span> <span class="va">dat.graf</span><span class="op">[</span><span class="va">dat.graf</span><span class="op">$</span><span class="va">altitude</span> <span class="op">==</span> <span class="st">"Intermediário"</span>, <span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/grDevices/chull.html">chull</a></span><span class="op">(</span><span class="va">dat.graf</span><span class="op">[</span><span class="va">dat.graf</span><span class="op">$</span><span class="va">altitude</span> <span class="op">==</span> <span class="st">"Intermediário"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MDS1"</span>, <span class="st">"MDS2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span>

<span class="va">grp.pla</span> <span class="op">&lt;-</span> <span class="va">dat.graf</span><span class="op">[</span><span class="va">dat.graf</span><span class="op">$</span><span class="va">altitude</span> <span class="op">==</span> <span class="st">"Plano"</span>, <span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/grDevices/chull.html">chull</a></span><span class="op">(</span><span class="va">dat.graf</span><span class="op">[</span><span class="va">dat.graf</span><span class="op">$</span><span class="va">altitude</span> <span class="op">==</span> <span class="st">"Plano"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MDS1"</span>, <span class="st">"MDS2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span>

<span class="co">## Combinar dados dos grupos para cada Convex Hull</span>
<span class="va">hull.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/cbind.html">rbind</a></span><span class="op">(</span><span class="va">grp.mon</span>, <span class="va">grp.int</span>, <span class="va">grp.pla</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">hull.data</span><span class="op">)</span>
<span class="co">#&gt;            MDS1        MDS2      altitude</span>
<span class="co">#&gt; S04 -0.10578586 -0.10682766    Montanhoso</span>
<span class="co">#&gt; S01 -0.25332406  0.04199004    Montanhoso</span>
<span class="co">#&gt; S11 -0.12504415  0.14477005    Montanhoso</span>
<span class="co">#&gt; S15  0.09166059  0.09857114    Montanhoso</span>
<span class="co">#&gt; S18  0.01968127 -0.12417579 Intermediário</span>
<span class="co">#&gt; S06 -0.16053825 -0.08924030 Intermediário</span>

<span class="co">## Gráfico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat.graf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">MDS1</span>, y <span class="op">=</span> <span class="va">MDS2</span>, color <span class="op">=</span> <span class="va">altitude</span>, shape <span class="op">=</span> <span class="va">altitude</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hull.data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">altitude</span>, group <span class="op">=</span> <span class="va">altitude</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"darkorchid"</span>, <span class="st">"cyan4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkorange"</span>, <span class="st">"darkorchid"</span>, <span class="st">"cyan4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"NMDS1"</span>, y <span class="op">=</span> <span class="st">"NMDS2"</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-nmds"></span>
<img src="livro_files/figure-html/fig-nmds-1.png" alt="Biplot mostrando o resultado do nMDS." width="100%" height="100%"><p class="caption">
Figura 9.18: Biplot mostrando o resultado do nMDS.
</p>
</div>
</div>
<div id="mantel-e-mantel-parcial" class="section level2" number="9.7">
<h2>
<span class="header-section-number">9.7</span> Mantel e Mantel parcial<a class="anchor" aria-label="anchor" href="#mantel-e-mantel-parcial"><i class="fas fa-link"></i></a>
</h2>
<p>O teste de Mantel se aplica quando temos duas ou mais matrizes de distância (triangulares). Em estudos ecológicos, essas matrizes normalmente descrevem dados de distância ou (dis)similaridade na composição de espécies, distância geográfica, e similaridade ambiental. Mas este teste também é amplamente aplicado na área de genética de paisagem para testar hipóteses sobre como a composição genética de uma população varia em função do ambiente e/ou espaço geográfico <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2010" role="doc-biblioref">Legendre and Fortin 2010</a>)</span>. O teste nada mais é do que uma generalização do coeficiente de correlação de Pearson (Capítulo <a href="cap7.html#cap7">7</a>) para lidar com matrizes de distância. Como essas matrizes descrevem a relação entre vários pares de locais, temos a repetição do mesmo local em outros pares. Neste caso é preciso um procedimento semelhante ao de correção para múltiplos testes.</p>
<p>Já o Mantel parcial pretende testar a correlação entre duas matrizes controlando para o efeito de uma terceira. Por exemplo, testar a associação entre a dissimilaridade na composição de espécies e dissimilaridade ambiental, controlando para a distância geográfica entre os locais. Isso nos permite levar em conta a possível autocorrelação espacial nas variáveis ambientais, ou seja, estaríamos testando de fato o efeito da dissimilaridade ambiental “pura” na dissimilaridade na composição de espécies, evitando o efeito do espaço em si. Portanto, note que sempre estamos raciocinando em termos de (dis)similaridade e não dos dados brutos em si, seja composição de espécies ou variáveis ambientais. É importante ter isto em mente na hora de interpretar os resultados.</p>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo, vamos utilizar um conjunto de dados que contém girinos de espécies de anfíbios anuros coletados em 14 poças d’água e os respectivos dados de variáveis ambientais destas mesmas poças <span class="citation">(<a href="refer%C3%AAncias.html#ref-provete_broad-scale_2014" role="doc-biblioref">Provete et al. 2014</a>)</span>.</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Existe correlação entre a dissimilaridade na composição de espécies de girinos e a dissimilaridade ambiental?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Assumindo que processos baseados no nicho sejam predominantes, quanto mais diferentes as poças forem maior será a diferença na composição de espécies</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variáveis: a matriz de distância (Bray-Curtis) da composição das espécies e outra matriz de distância (Euclideana) das variáveis ambientais</li>
</ul>
<p><strong>Análises</strong></p>
<p>Aqui vamos utilizar além do conjunto de dados <code>bocaina</code> já conhecido, outras duas matrizes disponíveis no pacote <code>ecodados</code>: <code>bocaina.xy</code> e <code>bocaina.env</code>, que contêm as coordenadas geográficas e variáveis ambientais das poças, respectivamente.</p>
<div class="sourceCode" id="cb392"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bocaina.env</span><span class="op">)</span>
<span class="co">#&gt;       pH  tur   DO  temp veg  dep canopy conduc hydro area</span>
<span class="co">#&gt; PP3 7.07 0.66 2.26 18.93  30 0.35   30.3 0.0100   per  139</span>
<span class="co">#&gt; PP4 6.85 0.33 2.78 20.53   0 0.33   32.1 0.0100   per  223</span>
<span class="co">#&gt; AP1 6.64 0.40 4.09 15.26   5 3.50   42.0 0.0105   per  681</span>
<span class="co">#&gt; AP2 6.13 0.80 3.47 15.40  70 2.50   82.0 0.0300   per  187</span>
<span class="co">#&gt; PP1 5.80 0.75 3.22 16.75  70 0.70   91.4 0.0100   per   83</span>
<span class="co">#&gt; PP2 5.32 4.00 2.10 15.90  95 0.27   75.3 0.0100   per  108</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bocaina.xy</span><span class="op">)</span>
<span class="co">#&gt;         Long      Lat</span>
<span class="co">#&gt; PT5 -44.6239 -22.7243</span>
<span class="co">#&gt; PP3 -44.6340 -22.7228</span>
<span class="co">#&gt; PP4 -44.6334 -22.7228</span>
<span class="co">#&gt; BP4 -44.6212 -22.7262</span>
<span class="co">#&gt; BP2 -44.6155 -22.7289</span>
<span class="co">#&gt; PT1 -44.6170 -22.7350</span>

<span class="co">## Matriz de distância geográfica</span>
<span class="va">Dist.km</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/fields/man/rdist.earth.html">rdist.earth</a></span><span class="op">(</span><span class="va">bocaina.xy</span>, miles<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span> <span class="co"># matriz de distância geográfica (geodésica) considerando a curvatura da Terra</span>

<span class="co">## Padronizações</span>
<span class="va">comp.bo.pad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/transpose.html">t</a></span><span class="op">(</span><span class="va">bocaina</span><span class="op">)</span>, <span class="st">"hellinger"</span><span class="op">)</span>
<span class="va">env.bocaina</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html">decostand</a></span><span class="op">(</span><span class="va">bocaina.env</span><span class="op">[</span>,<span class="op">-</span><span class="fl">9</span><span class="op">]</span>, <span class="st">"standardize"</span><span class="op">)</span>

<span class="co">## Dissimilaridades</span>
<span class="va">dissimil.bocaina</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">comp.bo.pad</span>, <span class="st">"bray"</span><span class="op">)</span>
<span class="va">dissimil.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">env.bocaina</span>, <span class="st">"euclidian"</span><span class="op">)</span></code></pre></div>
<p>Vamos verificar a correlação entre a distância geográfica em linha reta e a dissimilaridade ambiental (Figura <a href="cap9.html#fig:fig-mantel">9.19</a>)</p>
<div class="sourceCode" id="cb393"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Mantel</span>
<span class="co"># Espaço vs. ambiente</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/mantel.html">mantel</a></span><span class="op">(</span><span class="va">Dist.km</span>, <span class="va">dissimil.env</span><span class="op">)</span> 
<span class="co">#&gt; </span>
<span class="co">#&gt; Mantel statistic based on Pearson's product-moment correlation </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mantel(xdis = Dist.km, ydis = dissimil.env) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mantel statistic r: 0.4848 </span>
<span class="co">#&gt;       Significance: 0.005 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Upper quantiles of permutations (null model):</span>
<span class="co">#&gt;   90%   95% 97.5%   99% </span>
<span class="co">#&gt; 0.250 0.330 0.393 0.447 </span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>

<span class="co">## Preparar os dados para o gráfico</span>
<span class="va">matrix.dist.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Dist.km</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">value</span>, 
                              y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">dissimil.env</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">value</span><span class="op">)</span>

<span class="co">## Gráfico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">matrix.dist.env</span> , <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">21</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Distância geográfica (km)"</span>, 
         y <span class="op">=</span> <span class="st">"Dissimilaridade Ambiental"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span>                              </code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-mantel"></span>
<img src="livro_files/figure-html/fig-mantel-1.png" alt="Relação das matrizes de (dis)similaridade dos dados." width="100%" height="100%"><p class="caption">
Figura 9.19: Relação das matrizes de (dis)similaridade dos dados.
</p>
</div>
<p>Vamos verificar a correlação entre a distância geográfica em linha reta e a dissimilaridade na composição de espécies (Figura <a href="cap9.html#fig:fig-mantel1">9.20</a>)</p>
<div class="sourceCode" id="cb394"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Mantel</span>
<span class="co"># Espaço vs. composição</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/mantel.html">mantel</a></span><span class="op">(</span><span class="va">Dist.km</span>, <span class="va">dissimil.bocaina</span><span class="op">)</span> 
<span class="co">#&gt; </span>
<span class="co">#&gt; Mantel statistic based on Pearson's product-moment correlation </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mantel(xdis = Dist.km, ydis = dissimil.bocaina) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mantel statistic r: 0.3745 </span>
<span class="co">#&gt;       Significance: 0.007 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Upper quantiles of permutations (null model):</span>
<span class="co">#&gt;   90%   95% 97.5%   99% </span>
<span class="co">#&gt; 0.149 0.215 0.279 0.335 </span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>

<span class="co">## Preparar os dados para o gráfico</span>
<span class="va">matrix.dist.bocaina</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">Dist.km</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">value</span>, 
                              y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">dissimil.bocaina</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">value</span><span class="op">)</span>

<span class="co">## Gráfico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">matrix.dist.bocaina</span> , <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">21</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Distância geográfica (km)"</span>, 
         y <span class="op">=</span> <span class="st">"Dissimilaridade (Bray-Curtis)"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-mantel1"></span>
<img src="livro_files/figure-html/fig-mantel1-1.png" alt="Relação das matrizes de (dis)similaridade dos dados." width="100%" height="100%"><p class="caption">
Figura 9.20: Relação das matrizes de (dis)similaridade dos dados.
</p>
</div>
<p>Vamos verificar a correlação entre a dissimilaridade ambiental e a dissimilaridade na composição de espécies (Figura <a href="cap9.html#fig:fig-mantel2">9.21</a>)</p>
<div class="sourceCode" id="cb395"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Mantel</span>
<span class="co"># Ambiente vs. composição</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/mantel.html">mantel</a></span><span class="op">(</span><span class="va">dissimil.env</span>, <span class="va">dissimil.bocaina</span><span class="op">)</span> 
<span class="co">#&gt; </span>
<span class="co">#&gt; Mantel statistic based on Pearson's product-moment correlation </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mantel(xdis = dissimil.env, ydis = dissimil.bocaina) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mantel statistic r: 0.2898 </span>
<span class="co">#&gt;       Significance: 0.02 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Upper quantiles of permutations (null model):</span>
<span class="co">#&gt;   90%   95% 97.5%   99% </span>
<span class="co">#&gt; 0.171 0.227 0.266 0.322 </span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>

<span class="co">## Preparar os dados para o gráfico</span>
<span class="va">matrix.bocaina.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">dissimil.bocaina</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">value</span>, 
                                 y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape/man/melt-24.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">dissimil.env</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">value</span><span class="op">)</span>

<span class="co">## Gráfico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">matrix.bocaina.env</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">21</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Similaridade Bocaina"</span>, 
         y <span class="op">=</span> <span class="st">"Similaridade Ambiental"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">tema_livro</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-mantel2"></span>
<img src="livro_files/figure-html/fig-mantel2-1.png" alt="Relação das matrizes de (dis)similaridade dos dados." width="100%" height="100%"><p class="caption">
Figura 9.21: Relação das matrizes de (dis)similaridade dos dados.
</p>
</div>
<p><strong>Interpretação dos resultados</strong></p>
<p>Os resultados mostraram que existe uma relação positiva, embora fraca, entre a dissimilaridade ambiental e a dissimilaridade na composição de espécies. Este resultado está de acordo com a nossa hipótese inicial. No entanto, vimos também que existe uma relação positiva e significativa entre a distância em linha reta entre as poças e a dissimilaridade ambiental. Logo, para de fato testar a relação entre o ambiente e a composição de espécies temos de levar em conta o espaço.</p>
<p>Para isto temos de realizar um teste de Mantel Parcial.</p>
<div class="sourceCode" id="cb396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Mantel Parcial</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/mantel.html">mantel.partial</a></span><span class="op">(</span><span class="va">dissimil.bocaina</span>, <span class="va">dissimil.env</span>, <span class="va">Dist.km</span><span class="op">)</span> <span class="co">#comp. vs. ambiente controlando o espaço</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Partial Mantel statistic based on Pearson's product-moment correlation </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; mantel.partial(xdis = dissimil.bocaina, ydis = dissimil.env,      zdis = Dist.km) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mantel statistic r: 0.1334 </span>
<span class="co">#&gt;       Significance: 0.123 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Upper quantiles of permutations (null model):</span>
<span class="co">#&gt;   90%   95% 97.5%   99% </span>
<span class="co">#&gt; 0.148 0.200 0.229 0.278 </span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span></code></pre></div>
<p>Agora sim, vimos que a relação entre ambiente e espécies se mantém, mas que a força dessa relação diminuiu bastante (veja o valor de r) quando controlamos o espaço.</p>
</div>
<div id="mantel-espacial-com-modelo-nulo-restrito-considerando-autocorrelação-espacial" class="section level2" number="9.8">
<h2>
<span class="header-section-number">9.8</span> Mantel espacial com modelo nulo restrito considerando autocorrelação espacial<a class="anchor" aria-label="anchor" href="#mantel-espacial-com-modelo-nulo-restrito-considerando-autocorrela%C3%A7%C3%A3o-espacial"><i class="fas fa-link"></i></a>
</h2>
<p>Embora seja um tipo de análise bastante popular, o Mantel e a sua versão parcial parecem não ser muito adequadas para lidar com autocorrelação espacial. Os autores dos artigos abaixo sugerem inclusive que esse tipo de análise não é adequado para testar a maioria das hipóteses em Ecologia, incluindo diversidade beta. Esse é um tema bastante discutido na literatura e não vamos nos alongar muito sobre isso, mas referimos o(a) leitor(a) para os seguintes artigos chave: Legendre et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2015" role="doc-biblioref">2015</a>)</span>, Legendre &amp; Fortin <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2010" role="doc-biblioref">2010</a>)</span>, e Legendre <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre2000" role="doc-biblioref">2000</a>)</span>.</p>
<p>No entanto, Crabot et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-crabot2019" role="doc-biblioref">2019</a>)</span> propuseram uma modificação no teste que leva em conta autocorrelação espacial ao gerar o modelo nulo usado para o teste de hipótese. É utilizado um procedimento chamado <em>Moran Spectral Randomization</em> porque preserva a autocorrelação global medida por meio do I de Moran global. A grande vantagem é que este teste utiliza toda a flexibilidade dos <em>Moran Eigenvector Maps</em> (MEMs), que é apresentado na parte de RDA, permitindo analisar relações entre as matrizes em múltiplas escalas espaciais. Vejamos como o teste funciona.</p>
<p>Primeiro precisamos construir um objeto com as duas matrizes que desejamos testar, no nosso caso composição de espécies e espaço. Depois precisamos construir explicitamente a nossa hipótese de relação espacial entre os locais por meio de uma rede de vizinhança. Esta rede é uma estrutura que nos dirá como (e eventualmente com qual intensidade) se há relação entre os locais. Aqui, entende-se que nos referimos à probabilidade de fluxo de indivíduos entre os locais.</p>
<div class="sourceCode" id="cb397"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Mantel</span>
<span class="va">compos_espac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/mantel.randtest.html">mantel.randtest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">dissimil.bocaina</span><span class="op">)</span>, <span class="va">Dist.km</span><span class="op">)</span>
<span class="va">compos_espac</span>
<span class="co">#&gt; Monte-Carlo test</span>
<span class="co">#&gt; Call: mantel.randtest(m1 = sqrt(dissimil.bocaina), m2 = Dist.km)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Observation: 0.3738076 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Based on 999 replicates</span>
<span class="co">#&gt; Simulated p-value: 0.005 </span>
<span class="co">#&gt; Alternative hypothesis: greater </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Std.Obs Expectation    Variance </span>
<span class="co">#&gt; 3.265589171 0.002421976 0.012933827</span></code></pre></div>
<p>Note que até aqui não há nada de novo, apenas utilizamos uma função diferente para realizar o teste de Mantel, agora no pacote <code>ade4</code> ao invés do <code>vegan</code>. Agora temos de construir a nossa rede de vizinhança. Optamos neste exemplo por uma rede bastante simples, que é a <em>Minimum Spanning Tree</em>. Essa é a rede espacial mínima que mantém todos os pontos ligados entre si (Figura <a href="cap9.html#fig:fig-mantel-espacial">9.22</a>).</p>
<div class="sourceCode" id="cb398"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Minimum Spanning Tree</span>
<span class="va">nb.boc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adespatial/man/mst.nb.html">mst.nb</a></span><span class="op">(</span><span class="va">Dist.km</span><span class="op">)</span> <span class="co"># calcula uma Minimum Spanning Tree</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">nb.boc</span>, <span class="va">bocaina.xy</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-mantel-espacial"></span>
<img src="livro_files/figure-html/fig-mantel-espacial-1.png" alt="Rede de vizinhança com a *Minimum Spanning Tree*" width="100%" height="100%"><p class="caption">
Figura 9.22: Rede de vizinhança com a <em>Minimum Spanning Tree</em>
</p>
</div>
<p>No gráfico, podemos ver a “cara” da rede. Cada ponto representa um local (poça) e as linhas representam a ligação hipotética entre eles, plotamos no espaço geográfico, ou seja, o Norte aponta pra cima. Agora temos apenas que converter o formato <code>nb</code> para <code>listw</code> e finalmente entrar com esses objetos na função que realizará a análise.</p>
<div class="sourceCode" id="cb399"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Conversão</span>
<span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">nb.boc</span><span class="op">)</span>

<span class="co">## Mantel espacial</span>
<span class="fu"><a href="https://rdrr.io/pkg/adespatial/man/msr.html">msr</a></span><span class="op">(</span><span class="va">compos_espac</span>, <span class="va">lw</span>, method <span class="op">=</span> <span class="st">"pair"</span><span class="op">)</span>
<span class="co">#&gt; Monte-Carlo test</span>
<span class="co">#&gt; Call: msr.mantelrtest(x = compos_espac, listwORorthobasis = lw, method = "pair")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Observation: 0.3738076 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Based on 999 replicates</span>
<span class="co">#&gt; Simulated p-value: 0.127 </span>
<span class="co">#&gt; Alternative hypothesis: greater </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Std.Obs Expectation    Variance </span>
<span class="co">#&gt;  1.21335033  0.17433665  0.02702631</span></code></pre></div>
<p><strong>Interpretação dos resultados</strong></p>
<p>Vamos comparar com o Mantel comum.</p>
<div class="sourceCode" id="cb400"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Mantel comum</span>
<span class="va">compos_espac</span>
<span class="co">#&gt; Monte-Carlo test</span>
<span class="co">#&gt; Call: mantel.randtest(m1 = sqrt(dissimil.bocaina), m2 = Dist.km)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Observation: 0.3738076 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Based on 999 replicates</span>
<span class="co">#&gt; Simulated p-value: 0.005 </span>
<span class="co">#&gt; Alternative hypothesis: greater </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Std.Obs Expectation    Variance </span>
<span class="co">#&gt; 3.265589171 0.002421976 0.012933827</span></code></pre></div>
<p>Note que o valor da estatística do teste, ou seja, o r de Mantel é exatamente o mesmo. No entanto, o valor de <em>P</em> que indicava que o teste havia sido significativo anteriormente mudou e passou a ser não significativo. Isso ocorreu porque, embora a maneira de calcular a estatística do teste seja a mesma, a forma de construir a distribuição nula, a partir da qual será calculado o valor de <em>P</em> mudou drasticamente, resultando num teste não significativo.</p>
</div>
<div id="procrustes-e-protest" class="section level2" number="9.9">
<h2>
<span class="header-section-number">9.9</span> PROCRUSTES e PROTEST<a class="anchor" aria-label="anchor" href="#procrustes-e-protest"><i class="fas fa-link"></i></a>
</h2>
<p>Uma alternativa ao Mantel para comparar o grau de associação entre conjuntos multidimensionais de dados (e.g., matriz de espécies e matriz ambiental) é a análise conhecida como Procrustes <span class="citation">(<a href="refer%C3%AAncias.html#ref-gower_statistical_1971" role="doc-biblioref">Gower 1971</a>; <a href="refer%C3%AAncias.html#ref-jackson_protest_1995" role="doc-biblioref">Jackson 1995</a>)</span>. Esta análise compara duas matrizes (objetos nas linhas e variáveis nas colunas) minimizando a soma dos desvios quadrados entre os valores através das seguintes técnicas: translação, escalonamento e rotação. É importante notar que os objetos devem ser os mesmos e, desse modo, o número de linhas é obrigatoriamente igual, ao passo que o número de colunas pode variar. A posição do objeto X<sub>i</sub> (i = 1, …n) é comparada com o objeto Y<sub>i</sub> da matriz correspondente, movimentando os pontos via translação, reflexão, rotação e dilatação. Assim, os objetos da matriz X resultam na matriz X’ que é representada pelo melhor ajuste (menor valor residual da soma dos quadrados: estatística m<sub>12</sub>) entre a matriz X e Y. A estatística m<sub>12</sub> mede, então, o grau de concordância entre as duas matrizes. Os valores de m<sub>12</sub> variam de 1 (sem concordância) a 0 (máxima concordância) <span class="citation">(<a href="refer%C3%AAncias.html#ref-peres-neto_how_2001" role="doc-biblioref">Peres-Neto and Jackson 2001</a>; <a href="refer%C3%AAncias.html#ref-lisboa_much_2014" role="doc-biblioref">Lisboa et al. 2014</a>)</span>. Para testar a significância do valor observado de m<sub>12</sub>, Jackson <span class="citation">(<a href="refer%C3%AAncias.html#ref-jackson_protest_1995" role="doc-biblioref">1995</a>)</span> sugeriu um teste de aleatorização chamado PROTEST.</p>
<p>As possibilidades de aplicação do Procrustes para ecologia são diversas. Dentre elas, se destacam a: i) morfometria geométrica e ii) ecologia de comunidades (concordância de comunidades). Uma característica interessante do Procrustes é a possibilidade de usar matriz bruta (e.g., variáveis ambientais) ou matriz de distância, o que amplia as possibilidades analíticas. Para comparações com matrizes brutas, análises de ordenação irrestrita (PCA, CA) devem ser realizadas antes do Procrustes. Por outro lado, para comparações com matrizes de distância (e.g., Euclidiana, Jaccard, Bray-Curtis), análises como PCoA e nMDS devem preceder à análise de Procrustes <span class="citation">(veja Figura 4 em <a href="refer%C3%AAncias.html#ref-peres-neto_how_2001" role="doc-biblioref">Peres-Neto and Jackson 2001</a>)</span>. Nos dois casos, a ordenação é importante para gerar matrizes com a mesma dimensionalidade o que, por sua vez, permite comparar matrizes com número de colunas diferentes.</p>
<p><strong>Exemplo 1</strong></p>
<p>Neste exemplo, vamos utilizar dois conjuntos de dados simulados de peixes e macroinvertebrados aquáticos coletados em riachos. Neste exemplo hipotético, existe uma rede de 12 riachos com diferentes graus de poluição. Em cada riacho, foi produzida uma lista de espécies de peixes e de macroinvertebrados (com dados de abundância).</p>
<p><strong>Pergunta</strong></p>
<ul>
<li>Existe concordância na distribuição na composição de espécies de peixes e macroinvertebrados?</li>
</ul>
<p><strong>Predições</strong></p>
<ul>
<li>Assumindo que alguns poluentes, tais como metais pesados, podem atuar como filtro ambiental e limitar a ocorrência de determinados organismos aquáticos, espera-se encontrar alta concordância entre as duas matrizes (peixes e macroinvertebrados). Ou seja, a comunidade tanto de peixes quanto de macroinvertebrados responderão de forma similar ao gradiente ambiental</li>
</ul>
<p><strong>Variáveis</strong></p>
<ul>
<li>Variáveis: composição das espécies de peixes e macroinverebrados aquáticos</li>
</ul>
<p><strong>Análises</strong></p>
<p>No exemplo escolhido, as duas matrizes representam a composição de espécies em diferentes riachos. Desse modo, o ideal é transformar esta matriz bruta em matriz de distância com o método Bray-Curtis (<code><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist()</a></code>). O próximo passo, então, é realizar uma <code>Análise de Coordenadas Principais (PCoA)</code> (veja abaixo) para gerar duas matrizes de ordenação que serão comparadas com a função <code><a href="https://rdrr.io/pkg/vegan/man/procrustes.html">procrustes()</a></code>. Por fim, utilizamos a função <code><a href="https://rdrr.io/pkg/vegan/man/procrustes.html">protest()</a></code> para testar a significância da concordância entre as matrizes (Figura <a href="cap9.html#fig:fig-procrustes">9.23</a>).</p>
<div class="sourceCode" id="cb401"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fish_comm</span><span class="op">)</span>
<span class="co">#&gt;       sp1 sp2 sp3 sp4 sp5 sp6 sp7 sp8 sp9 sp10 sp11 sp12 sp13 sp14 sp15 sp16 sp17 sp18 sp19 sp20 sp21 sp22 sp23 sp24</span>
<span class="co">#&gt; site1   0   0   0   1   1   0   4   0   0    0    1    0    1    1    0    5    0    0    0    0    0    1    0    3</span>
<span class="co">#&gt; site2   0   0   0   1   0   1   5   0   2    1    1    2    1    0    0    1    0    0    0    0    0    0    1    0</span>
<span class="co">#&gt; site3   0   1   0   4   0   0   0   1   5    0    5    0    0    5    0    1    0    1    0    0    2    0    0    0</span>
<span class="co">#&gt; site4   0   5   0   1   0   1   0   0   2    0    0    0    0    2    1    0    0    0    0    1    1    0    0    2</span>
<span class="co">#&gt; site5   0   2   0   0   0   0   0   0   0    0    4    0    0    1    0    4    0    0    0    1    5    0    5    0</span>
<span class="co">#&gt; site6   0   2   1   0   0   0   0   1   1    0    0    2    0    2    0    0    0    0    0    0    0    0    4    0</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">macroinv</span><span class="op">)</span>
<span class="co">#&gt;       sp1 sp2 sp3 sp4 sp5 sp6 sp7 sp8 sp9 sp10 sp11 sp12 sp13 sp14 sp15 sp16 sp17 sp18 sp19 sp20 sp21 sp22 sp23 sp24 sp25 sp26 sp27</span>
<span class="co">#&gt; site1   0   1   1   0   0   0   0   0   0    1    2    0    0    0    0    1    1    0    4    0    0    0    1    0    0    1    0</span>
<span class="co">#&gt; site2   0   2   1   0   0   0   0   1   1    0    0    2    0    1    1    0    0    0    0    0    0    1    2    0    1    0    1</span>
<span class="co">#&gt; site3   0   0   0   1   0   1   5   0   2    1    1    2    0    4    0    1    0    0    1    0    0    0    0    1    0    2    1</span>
<span class="co">#&gt; site4   0   1   0   4   0   0   0   1   5    0    5    0    0    5    0    1    0    1    0    0    2    0    0    0    0    2    1</span>
<span class="co">#&gt; site5   0   2   0   0   0   0   0   0   0    0    4    0    0    2    1    0    0    0    0    1    1    0    0    2    0    5    0</span>
<span class="co">#&gt; site6   1   0   0   1   0   0   0   0   0    0    1    0    0    2    0    0    0    0    0    0    0    0    4    0    0    2    0</span>
<span class="co">#&gt;       sp28 sp29 sp30 sp31 sp32 sp33 sp34 sp35 sp36</span>
<span class="co">#&gt; site1    4    0    0    0    1    5    0    5    0</span>
<span class="co">#&gt; site2    1    0    0    1    0    0    1    0    0</span>
<span class="co">#&gt; site3    0    0    0    0    1    1    0    0    2</span>
<span class="co">#&gt; site4    0    0    0    0    0    0    5    1    0</span>
<span class="co">#&gt; site5    1    0    1    0    0    2    0    0    0</span>
<span class="co">#&gt; site6    0    0    0    0    0    0    0    4    0</span>

<span class="co">## Fixar a amostragem</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1001</span><span class="op">)</span> 

<span class="co">## Matrizes de distância de PCoA </span>
<span class="va">d_macro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">macroinv</span>, <span class="st">"bray"</span><span class="op">)</span>
<span class="va">pcoa_macro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html">cmdscale</a></span><span class="op">(</span><span class="va">d_macro</span><span class="op">)</span>

<span class="va">d_fish</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">fish_comm</span>, <span class="st">"bray"</span><span class="op">)</span>
<span class="va">pcoa_fish</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html">cmdscale</a></span><span class="op">(</span><span class="va">d_fish</span><span class="op">)</span>

<span class="co">## PROCRUSTES</span>
<span class="va">concord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/procrustes.html">procrustes</a></span><span class="op">(</span><span class="va">pcoa_macro</span>, <span class="va">pcoa_fish</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/procrustes.html">protest</a></span><span class="op">(</span><span class="va">pcoa_macro</span>, <span class="va">pcoa_fish</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; protest(X = pcoa_macro, Y = pcoa_fish) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Procrustes Sum of Squares (m12 squared):        0.6185 </span>
<span class="co">#&gt; Correlation in a symmetric Procrustes rotation: 0.6176 </span>
<span class="co">#&gt; Significance:  0.019 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Permutation: free</span>
<span class="co">#&gt; Number of permutations: 999</span>

<span class="co">## Gráfico</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">concord</span>, main <span class="op">=</span> <span class="st">""</span>, 
     xlab <span class="op">=</span> <span class="st">"Dimensão 1"</span>,
     ylab <span class="op">=</span> <span class="st">"Dimensão 2"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-procrustes"></span>
<img src="livro_files/figure-html/fig-procrustes-1.png" alt="Biplot mostrando o resultado da análise de PROCRUSTES." width="100%" height="100%"><p class="caption">
Figura 9.23: Biplot mostrando o resultado da análise de PROCRUSTES.
</p>
</div>
<p><strong>Interpretação dos resultados</strong></p>
<p>A função <code><a href="https://rdrr.io/pkg/vegan/man/procrustes.html">protest()</a></code> apresenta dois resultados importantes: i) a estatística m<sub>12</sub> e ii) o valor de significância (p). No exemplo, o valor de m<sub>12</sub> é igual a <code>0.6185</code> e o valor de p é <code>0,019</code>. Desse modo, podemos concluir que existe concordância entre a composição de espécies de peixes e macroinvertebrados aquáticos, sugerindo que o nível de poluição pode gerar padrões previsíveis de distribuição de diferentes organismos aquáticos. A figura produzida pelo código <code>plot(concord)</code> mostra um gráfico típico do Procrustes, onde a base da seta representa a matriz <strong>X</strong> e a ponta da seta a matriz alvo (<strong>Y</strong>) após a rotação para comparar o grau de concordância entre <strong>X</strong> e <strong>Y</strong>. Cada ponto representa um objeto (linha) das matrizes <strong>X</strong> e <strong>Y</strong>. Quanto menor for o tamanho das setas, mais concordantes são as observações em cada objeto.</p>
</div>
<div id="métodos-multivariados-baseados-em-modelos" class="section level2" number="9.10">
<h2>
<span class="header-section-number">9.10</span> Métodos multivariados baseados em modelos<a class="anchor" aria-label="anchor" href="#m%C3%A9todos-multivariados-baseados-em-modelos"><i class="fas fa-link"></i></a>
</h2>
<p>Mais recentemente, alguns autores têm proposto métodos multivariados baseados em modelos. Estes métodos têm se diversificado hoje em dia e existem pacotes que realizam praticamente todas as análises que vimos acima, com a diferença que utilizam distribuições de probabilidade dado um modelo (e.g., Poisson) ao invés de coeficientes de dissimilaridades. Vamos exemplificar o uso de um desses métodos, mas não vamos fazer uma revisão extensiva. Caso o(a) leitor(a) deseje conhecer mais, recomendamos consultar principalmente os pacotes <code>gllvm</code>, <code>ecoCopula</code> e <code>Hmsc</code>.</p>
<p>Um dos primeiros métodos foi proposto em 2012 pelo grupo de David Warton <span class="citation">(<a href="refer%C3%AAncias.html#ref-warton2012" role="doc-biblioref">Warton, Wright, and Wang 2012</a>)</span>, implementado no pacote <code>mvabund</code>. Anteriormente neste mesmo ano foi publicado um artigo pelo mesmo grupo <span class="citation">(<a href="refer%C3%AAncias.html#ref-wang2012" role="doc-biblioref">Wang et al. 2012</a>)</span> em que os autores demonstraram que métodos baseados em dissimilaridade, especialmente PERMANOVA, não conseguem modelar adequadamente dados multivariados de contagem (e.g., abundância) por não levarem em conta a relação monotônica entre média e variância. Vejamos o que isso quer dizer utilizando os dados do artigo de da Silva et al. <span class="citation">(<a href="refer%C3%AAncias.html#ref-dasilva2017" role="doc-biblioref">2017</a>)</span> (Figura <a href="cap9.html#fig:fig-media-var">9.24</a>).</p>
<div class="sourceCode" id="cb402"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Dados com seis primeiras localidades e espécies</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">anuros_permanova</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>
<span class="co">#&gt;                   Chiasmocleis_albopunctata Dendropsophus_elianae Dendropsophus_jimi Dendropsophus_nanus Dendropsophus_minutus</span>
<span class="co">#&gt; Araras                                    6                     0                  0                   0                     1</span>
<span class="co">#&gt; Artur Nogueira                            0                     0                  0                   0                     6</span>
<span class="co">#&gt; Conchal                                   0                     0                  0                   0                     0</span>
<span class="co">#&gt; Engenheiro Coelho                         1                     0                  0                   0                     2</span>
<span class="co">#&gt; Jaguari\xfana                             8                     0                  0                   0                     0</span>
<span class="co">#&gt; Limeira                                   0                    11                 15                   0                    15</span>
<span class="co">#&gt;                   Dendropsophus_sanborni</span>
<span class="co">#&gt; Araras                                 0</span>
<span class="co">#&gt; Artur Nogueira                         0</span>
<span class="co">#&gt; Conchal                                0</span>
<span class="co">#&gt; Engenheiro Coelho                      0</span>
<span class="co">#&gt; Jaguari\xfana                          0</span>
<span class="co">#&gt; Limeira                                0</span>

<span class="co">#retirando a coluna que contém o fator e deixando apenas dados de abundância</span>
<span class="va">anuros_abund</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">anuros_permanova</span><span class="op">[</span>,<span class="op">-</span><span class="fl">28</span><span class="op">]</span><span class="op">)</span>

<span class="co">#incluindo apenas o fator a ser testado no modelo</span>
<span class="va">grupos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">anuros_permanova</span><span class="op">[</span>,<span class="fl">28</span><span class="op">]</span><span class="op">)</span>

<span class="co">## Média-variância</span>
<span class="co"># criando um objeto da classe mvabund com os dados de abundância</span>
<span class="va">abund_tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund.html">mvabund</a></span><span class="op">(</span><span class="va">anuros_abund</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/meanvar.plot.html">meanvar.plot</a></span><span class="op">(</span><span class="va">abund_tr</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-media-var"></span>
<img src="livro_files/figure-html/fig-media-var-1.png" alt="Gráfico mostrando a média-variância para dados de abundância multivariada." width="100%" height="100%"><p class="caption">
Figura 9.24: Gráfico mostrando a média-variância para dados de abundância multivariada.
</p>
</div>
<p>Este conjunto de dados contém abundâncias de anfíbios coletados num conjunto de cidades do interior de São Paulo e também sua presença em museus. Aqui, vemos que há uma clara relação monotônica entre a média e a variância da abundância das espécies na matriz. Ou seja, à medida que espécies aumentam sua média de abundância, elas também aumentam quase que proporcionalmente a sua variância. Esta é uma propriedade bastante comum de dados multivariados de contagem, mas que não é muito bem modelada por métodos baseados em dissimilaridade, já que nesse caso apenas as espécies mais abundantes têm de fato um peso na análise.</p>
<p>A proposta implementada no pacote <code>mvabund</code> é baseada em Modelos Lineares Generalizados (GLMs) que você já conhece do Capítulo <a href="cap8.html#cap8">8</a>. Ou seja, este método permite que sejam modeladas as abundâncias das espécies num contexto multivariado utilizando explicitamente distribuições de probabilidade, tais como aquelas que utilizamos (e.g., Poisson, Binomial negativa, etc.). Isso faz com que demos peso semelhante às espécies. Vejamos um exemplo de como o modelo é ajustado e como é feito teste de hipótese.</p>
<p><strong>Exemplo 1</strong></p>
<p>A principal pergunta do artigo citado acima foi testar se a composição de espécies que obtemos em campo e de coleção científicas é diferente. Isso tem implicações para levantamentos de fauna, já que podemos complementar um tipo de dado com outro ou saber se eles são redundantes. Aqui, <code>grupos</code> é apenas um fator que indica se aquela linha da matriz apresenta dados obtidos em campo ou coleção. Vamos testar a hipótese nula de que não há diferença na composição entre as duas fontes de dados ajustando um modelo com distribuição binomial negativa (Figura <a href="cap9.html#fig:fig-mvabund">9.25</a>).</p>
<div class="sourceCode" id="cb403"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Gráfico</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">abund_tr</span> <span class="op">~</span> <span class="va">grupos</span>, cex.axis <span class="op">=</span> <span class="fl">0.8</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  PIPING TO 2nd MVFACTOR</span>

<span class="co">## Modelo</span>
<span class="va">modelo1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/manyglm.html">manyglm</a></span><span class="op">(</span><span class="va">abund_tr</span> <span class="op">~</span> <span class="va">grupos</span>, family <span class="op">=</span> <span class="st">"negative.binomial"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-mvabund"></span>
<img src="livro_files/figure-html/fig-mvabund-1.png" alt="Gráfico mostrando as abundâncias para os dois grupos." width="100%" height="100%"><p class="caption">
Figura 9.25: Gráfico mostrando as abundâncias para os dois grupos.
</p>
</div>
<p>O gráfico mostrando os dados possui log da abundância das espécies e o fator (campo vs. coleção). Com essa análise exploratória de dados já podemos identificar se há diferença ou não na abundância das espécies em cada local. Vemos que algumas espécies são bem mais abundantes no campo do que em coleções, tais como <em>Leptodactylus mystacinus</em> e <em>Rhinella ornata</em>.</p>
<p>Uma grande vantagem desse tipo de método baseado em modelos é que, assim como um GLM típico, também podemos realizar diagnose dos resíduos utilizando plots de resíduos versus predito. Vejamos como isso funciona (Figura <a href="cap9.html#fig:fig-mvabund-diag">9.26</a>).</p>
<div class="sourceCode" id="cb404"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Diagnose</span>
<span class="fu"><a href="https://rdrr.io/pkg/mvabund/man/mvabund-internal.html">plot</a></span><span class="op">(</span><span class="va">modelo1</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-mvabund-diag"></span>
<img src="livro_files/figure-html/fig-mvabund-diag-1.png" alt="Diagnose dos resíduos do modelo ajustado." width="100%" height="100%"><p class="caption">
Figura 9.26: Diagnose dos resíduos do modelo ajustado.
</p>
</div>
<p>Aqui vemos que os dados se distribuem de maneira mais ou menos homogênea e sem um padrão claro ao redor do zero. Isso indica que a distribuição Binomial negativa foi adequada para modelar estes dados. E agora sim podemos interpretar os resultados com mais segurança.</p>
<p><strong>Interpretação dos resultados</strong></p>
<div class="sourceCode" id="cb405"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Resultados</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelo1</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test statistics:</span>
<span class="co">#&gt;               wald value Pr(&gt;wald)    </span>
<span class="co">#&gt; (Intercept)       18.947     0.001 ***</span>
<span class="co">#&gt; gruposCOLECAO      4.727     0.004 ** </span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test statistic:  4.727, p-value: 0.004 </span>
<span class="co">#&gt; Arguments:</span>
<span class="co">#&gt;  Test statistics calculated assuming response assumed to be uncorrelated </span>
<span class="co">#&gt;  P-value calculated using 999 resampling iterations via pit.trap resampling (to account for correlation in testing).</span></code></pre></div>
<p>Aqui vemos que há sim uma diferença significativa na abundância relativa das espécies entre o campo e coleção. Mas até então estamos levando em conta toda a matriz numa abordagem multivariada. No entanto, não sabemos qual(is) espécie(s) são responsáveis por este padrão. Para investigar isso, podemos realizar uma Análise de Deviance separada para cada espécie, isso é o que a linha abaixo faz.</p>
<div class="sourceCode" id="cb406"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## ANOVA</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">modelo1</span>, p.uni <span class="op">=</span> <span class="st">"adjusted"</span><span class="op">)</span>
<span class="co">#&gt; Time elapsed: 0 hr 0 min 6 sec</span>
<span class="co">#&gt; Analysis of Deviance Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model: abund_tr ~ grupos</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Multivariate test:</span>
<span class="co">#&gt;             Res.Df Df.diff   Dev Pr(&gt;Dev)   </span>
<span class="co">#&gt; (Intercept)      8                          </span>
<span class="co">#&gt; grupos           7       1 94.08     0.01 **</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Univariate Tests:</span>
<span class="co">#&gt;             Chiasmocleis_albopunctata          Dendropsophus_elianae          Dendropsophus_jimi          Dendropsophus_nanus</span>
<span class="co">#&gt;                                   Dev Pr(&gt;Dev)                   Dev Pr(&gt;Dev)                Dev Pr(&gt;Dev)                 Dev</span>
<span class="co">#&gt; (Intercept)                                                                                                                  </span>
<span class="co">#&gt; grupos                          3.308    0.467                 0.394    0.836               0.23    0.836               2.197</span>
<span class="co">#&gt;                      Dendropsophus_minutus          Dendropsophus_sanborni          Elachistocleis_cesari         </span>
<span class="co">#&gt;             Pr(&gt;Dev)                   Dev Pr(&gt;Dev)                    Dev Pr(&gt;Dev)                   Dev Pr(&gt;Dev)</span>
<span class="co">#&gt; (Intercept)                                                                                                       </span>
<span class="co">#&gt; grupos         0.707                 4.752    0.309                  2.197    0.707                 2.012    0.762</span>
<span class="co">#&gt;             Hypsiboas_albopunctatus          Hypsiboas_faber          Hypsiboas_lundii          Hypsiboas_prasinus         </span>
<span class="co">#&gt;                                 Dev Pr(&gt;Dev)             Dev Pr(&gt;Dev)              Dev Pr(&gt;Dev)                Dev Pr(&gt;Dev)</span>
<span class="co">#&gt; (Intercept)                                                                                                                </span>
<span class="co">#&gt; grupos                        2.069    0.762           0.913    0.822            0.915    0.822              0.913    0.822</span>
<span class="co">#&gt;             Itapotihyla_langsdorffii          Leptodactylus_fuscus          Leptodactylus_latrans          Leptodactylus_mystaceus</span>
<span class="co">#&gt;                                  Dev Pr(&gt;Dev)                  Dev Pr(&gt;Dev)                   Dev Pr(&gt;Dev)                     Dev</span>
<span class="co">#&gt; (Intercept)                                                                                                                       </span>
<span class="co">#&gt; grupos                         0.911    0.836                4.652    0.309                 0.811    0.836                   1.869</span>
<span class="co">#&gt;                      Leptodactylus_mystacinus          Physalaemus_centralis          Physalaemus_cuvieri         </span>
<span class="co">#&gt;             Pr(&gt;Dev)                      Dev Pr(&gt;Dev)                   Dev Pr(&gt;Dev)                 Dev Pr(&gt;Dev)</span>
<span class="co">#&gt; (Intercept)                                                                                                       </span>
<span class="co">#&gt; grupos         0.783                    9.772    0.045                 2.639    0.670               8.221    0.062</span>
<span class="co">#&gt;             Physalaemus_marmoratus          Physalaemus_nattereri          Pseudis_paradoxa          Rhinella_ornata         </span>
<span class="co">#&gt;                                Dev Pr(&gt;Dev)                   Dev Pr(&gt;Dev)              Dev Pr(&gt;Dev)             Dev Pr(&gt;Dev)</span>
<span class="co">#&gt; (Intercept)                                                                                                                  </span>
<span class="co">#&gt; grupos                       1.622    0.783                17.131    0.014             2.67    0.540          11.961    0.027</span>
<span class="co">#&gt;             Rhinella_schneideri          Scinax_fuscomarginatus          Scinax_fuscovarius          Scinax_similis         </span>
<span class="co">#&gt;                             Dev Pr(&gt;Dev)                    Dev Pr(&gt;Dev)                Dev Pr(&gt;Dev)            Dev Pr(&gt;Dev)</span>
<span class="co">#&gt; (Intercept)                                                                                                                 </span>
<span class="co">#&gt; grupos                    3.363    0.467                   2.64    0.622              1.655    0.783          2.646    0.622</span>
<span class="co">#&gt;             Trachycephalus_typhonius         </span>
<span class="co">#&gt;                                  Dev Pr(&gt;Dev)</span>
<span class="co">#&gt; (Intercept)                                  </span>
<span class="co">#&gt; grupos                         1.622    0.783</span>
<span class="co">#&gt; Arguments:</span>
<span class="co">#&gt;  Test statistics calculated assuming uncorrelated response (for faster computation) </span>
<span class="co">#&gt; P-value calculated using 999 iterations via PIT-trap resampling.</span></code></pre></div>
<p>Aqui vemos que algumas espécies já identificadas no plot exploratório de fato são importantes para determinar o padrão, tais como: <em>Leptodactylus mystacinus</em>, <em>Physalaemus nattereri</em> e <em>Rhinella ornata</em>. Essas foram espécies cuja Deviance foi significativa.</p>
</div>
<div id="para-se-aprofundar-5" class="section level2" number="9.11">
<h2>
<span class="header-section-number">9.11</span> Para se aprofundar<a class="anchor" aria-label="anchor" href="#para-se-aprofundar-5"><i class="fas fa-link"></i></a>
</h2>
<div id="livros-4" class="section level3" number="9.11.1">
<h3>
<span class="header-section-number">9.11.1</span> Livros<a class="anchor" aria-label="anchor" href="#livros-4"><i class="fas fa-link"></i></a>
</h3>
<p>Listamos a seguir livros e artigos com material que recomendamos para seguir com sua aprendizagem em análises multivariadas em R: i) Legendre &amp; Legendre <span class="citation">(<a href="refer%C3%AAncias.html#ref-legendre_numerical_2012" role="doc-biblioref">2012</a>)</span> Numerical Ecology, ii) Borcard e colaboradores <span class="citation">(<a href="refer%C3%AAncias.html#ref-borcard2018" role="doc-biblioref">2018</a>)</span> Numerical Ecology with R, iii) Thioulouse e colaboradores <span class="citation">(<a href="refer%C3%AAncias.html#ref-thioulouse_multivariate_2018" role="doc-biblioref">2018</a>)</span> Multivariate Analysis of Ecological Data with ade4, iv) Ovaskainen &amp; Abrego <span class="citation">(<a href="refer%C3%AAncias.html#ref-ovaskainen_joint_2020" role="doc-biblioref">2020</a>)</span> Joint Species Distribution Modelling, v) James &amp; McCulloch <span class="citation">(<a href="refer%C3%AAncias.html#ref-james_multivariate_1990" role="doc-biblioref">1990</a>)</span> Multivariate Analysis in Ecology and Systematics: Panacea or Pandora’s Box? e vi) Dunstan e colaboradores <span class="citation">(<a href="refer%C3%AAncias.html#ref-dunstan_model_2011" role="doc-biblioref">2011</a>)</span> Model based grouping of species across environmental gradients.</p>
</div>
<div id="links-4" class="section level3" number="9.11.2">
<h3>
<span class="header-section-number">9.11.2</span> Links<a class="anchor" aria-label="anchor" href="#links-4"><i class="fas fa-link"></i></a>
</h3>
<p>Existem alguns tutoriais online bem interessantes, mas todos em inglês. Veja lista abaixo:</p>
<ul>
<li><a href="https://www.davidzeleny.net/anadat-r/doku.php/en:ordination">Análises de ordenação - 1</a></li>
<li><a href="http://ordination.okstate.edu/overview.htm">Análises de ordenação - 2</a></li>
<li><a href="https://www.davidzeleny.net/anadat-r/doku.php/en:classification">Classificação numérica - agrupamento e kmeans</a></li>
</ul>
</div>
</div>
<div id="exercícios-5" class="section level2" number="9.12">
<h2>
<span class="header-section-number">9.12</span> Exercícios<a class="anchor" aria-label="anchor" href="#exerc%C3%ADcios-5"><i class="fas fa-link"></i></a>
</h2>
<p><strong>9.1</strong>
Utilize os dados “mite” do pacote vegan para testar o efeito de variáveis ambientais sobre a composição de espécies de ácaros utilizando as seguintes análises: RDA, RDAp (combinada com MEM), dbRDA e PERMANOVA. Após realizar as cinco análises, responda às seguintes perguntas?</p>
<p>A. Quais são as variáveis ambientais (mite.env) mais importantes para a composição de ácaros em cada uma das análises?
B. Os vetores espaciais obtidos com a análise MEM explicam a variação na composição de espécies? Eles são mais ou menos importantes do que as variáveis ambientais?
C. Discuta as diferenças de interpretação entre a RDA, RDAp, dbRDA e PERMANOVA.</p>
<p>Dados necessários:</p>
<div class="sourceCode" id="cb407"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mite.env</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mite.xy</span><span class="op">)</span></code></pre></div>
<p><strong>9.2</strong>
Efetue uma análise de agrupamento pela função <code><a href="https://rdrr.io/r/stats/hclust.html">hclust()</a></code>. Lembre-se de dar nome ao objeto para poder plotar o dendrograma depois. Utilize a ajuda para encontrar como entrar com os argumentos da função.</p>
<ol style="list-style-type: upper-alpha">
<li>utilizando o método UPGMA e o índice de Bray-Curtis.</li>
<li>Faça agora o dendrograma com outro índice de dissimilaridade e compare os resultados. São diferentes? No que eles influenciariam a interpretação do resultado?</li>
</ol>
<p><strong>9.3</strong>
Na perspectiva de metacomunidades (Leibold et al., 2004), a dispersão dos organismos tem um papel proeminente para entender como as espécies estão distribuídas na natureza. Com o objetivo de testar se a dispersão influencia a composição de espécies de cladóceros e copépodos, e portanto a estrutura da metacomunidade, um pesquisador selecionou dois conjuntos de lagos: em um deles todos os lagos são isolados e no outro os lagos são conectados.</p>
<ol style="list-style-type: upper-alpha">
<li><p>Importe o conjunto de dados lagos do pacote <code>ecodados</code> e responda a pergunta se o fato de os lagos estarem conectados ou não influencia a composição de espécies desses microcrustáceos. Utilize métodos baseados em modelos que você aprendeu ao longo do capítulo para modelar a abundância multivariada.</p></li>
<li><p>Faça um plot mostrando a abundância relativa das espécies com maior abundância e veja se elas são diferentes entre os tipos lagos. Combine este resultado com o do item anterior para interpretar o resultado final.</p></li>
</ol>
<p><strong>9.4</strong>
Carregue o pacote <code>MASS</code> para utilizar os dados <code>crabs</code>. Este conjunto traz medidas morfológicas de dois morfo-tipos da espécie de carangueijo <em>Leptograpsus variegatus</em> coletada em Fremantle, Austrália. Calcule uma PCA e veja se existe uma semelhança morfológica entre os dois morfo-tipos. Lembre-se de dar nome
ao objeto e use a função <code><a href="https://rdrr.io/r/stats/biplot.html">biplot()</a></code> para plotar o resultado do teste. Dica: a projeção de um objeto perpendicular à seta do descritor fornece a posição aproximada do objeto ao longo desse descritor. A distância dos objetos no espaço cartesiano reflete a distância euclidiana entre eles.</p>
<p><a href="https://exercicios-livro-aer.netlify.app/cap.-9---an%C3%A1lises-multivariadas.html">Soluções dos exercícios</a>.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="cap8.html"><span class="header-section-number">8</span> Modelos Lineares Generalizados</a></div>
<div class="next"><a href="cap10.html"><span class="header-section-number">10</span> Rarefação</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Nesta página"><h2><b>Nesta página</b></h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cap9"><span class="header-section-number">9</span> Análises Multidimensionais</a></li>
<li><a class="nav-link" href="#pr%C3%A9-requisitos-do-cap%C3%ADtulo-5">Pré-requisitos do capítulo</a></li>
<li>
<a class="nav-link" href="#aspectos-te%C3%B3ricos"><span class="header-section-number">9.1</span> Aspectos teóricos</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#coeficientes-de-associa%C3%A7%C3%A3o"><span class="header-section-number">9.1.1</span> Coeficientes de associação</a></li>
<li><a class="nav-link" href="#m%C3%A9tricas-de-dist%C3%A2ncia"><span class="header-section-number">9.1.2</span> Métricas de distância</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#an%C3%A1lises-de-agrupamento"><span class="header-section-number">9.2</span> Análises de agrupamento</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#agrupamento-hier%C3%A1rquico"><span class="header-section-number">9.2.1</span> Agrupamento hierárquico</a></li>
<li><a class="nav-link" href="#agrupamento-n%C3%A3o-hier%C3%A1rquico-k-means"><span class="header-section-number">9.2.2</span> Agrupamento não-hierárquico (K-means)</a></li>
<li><a class="nav-link" href="#esp%C3%A9cies-indicadoras"><span class="header-section-number">9.2.3</span> Espécies indicadoras</a></li>
</ul>
</li>
<li><a class="nav-link" href="#an%C3%A1lises-de-ordena%C3%A7%C3%A3o"><span class="header-section-number">9.3</span> Análises de Ordenação</a></li>
<li>
<a class="nav-link" href="#ordena%C3%A7%C3%A3o-irrestrita"><span class="header-section-number">9.4</span> Ordenação irrestrita</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#an%C3%A1lise-de-componentes-principais-pca"><span class="header-section-number">9.4.1</span> Análise de Componentes Principais (PCA)</a></li>
<li><a class="nav-link" href="#an%C3%A1lises-de-coordenadas-principais-pcoa"><span class="header-section-number">9.4.2</span> Análises de Coordenadas Principais (PCoA)</a></li>
<li><a class="nav-link" href="#regress%C3%A3o-de-componentes-principais-pcr"><span class="header-section-number">9.4.3</span> Regressão de Componentes Principais (PCR)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#ordena%C3%A7%C3%A3o-restrita"><span class="header-section-number">9.5</span> Ordenação restrita</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#an%C3%A1lise-de-redund%C3%A2ncia-rda"><span class="header-section-number">9.5.1</span> Análise de Redundância (RDA)</a></li>
<li><a class="nav-link" href="#an%C3%A1lise-de-redund%C3%A2ncia-parcial-rdap"><span class="header-section-number">9.5.2</span> Análise de Redundância parcial (RDAp)</a></li>
<li><a class="nav-link" href="#an%C3%A1lise-de-redund%C3%A2ncia-baseada-em-dist%C3%A2ncia-db-rda"><span class="header-section-number">9.5.3</span> Análise de Redundância baseada em distância (db-RDA)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#permanova"><span class="header-section-number">9.6</span> PERMANOVA</a></li>
<li><a class="nav-link" href="#mantel-e-mantel-parcial"><span class="header-section-number">9.7</span> Mantel e Mantel parcial</a></li>
<li><a class="nav-link" href="#mantel-espacial-com-modelo-nulo-restrito-considerando-autocorrela%C3%A7%C3%A3o-espacial"><span class="header-section-number">9.8</span> Mantel espacial com modelo nulo restrito considerando autocorrelação espacial</a></li>
<li><a class="nav-link" href="#procrustes-e-protest"><span class="header-section-number">9.9</span> PROCRUSTES e PROTEST</a></li>
<li><a class="nav-link" href="#m%C3%A9todos-multivariados-baseados-em-modelos"><span class="header-section-number">9.10</span> Métodos multivariados baseados em modelos</a></li>
<li>
<a class="nav-link" href="#para-se-aprofundar-5"><span class="header-section-number">9.11</span> Para se aprofundar</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#livros-4"><span class="header-section-number">9.11.1</span> Livros</a></li>
<li><a class="nav-link" href="#links-4"><span class="header-section-number">9.11.2</span> Links</a></li>
</ul>
</li>
<li><a class="nav-link" href="#exerc%C3%ADcios-5"><span class="header-section-number">9.12</span> Exercícios</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/paternogbc/livro_aer/blob/master/09_analises_multidimensionais.Rmd">Ver fonte <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/paternogbc/livro_aer/edit/master/09_analises_multidimensionais.Rmd">Editar esta página <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Análises Ecológicas no R</strong>" foi escrito por Fernando Rodrigues da Silva, Thiago Gonçalves-Souza, Gustavo Brant Paterno, <br> Diogo Borges Provete, Maurício Humberto Vancine. Última atualização 2022-05-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este livro foi compilado com o pacote R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
